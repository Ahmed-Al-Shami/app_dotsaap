import{T as w,k as I,l as q,r as z,c as m,o as u,b as e,a as o,j as h,u as s,O as S,t as l,i as $,F as P,g as H,f as _,w as g,d as V,e as J,q as K}from"./app-BPxwetsb.js";import{_ as Q}from"./FilterDropdown-vJQ_5eqF.js";import{_ as C}from"./Modal-BIKyjMag.js";import{_ as W}from"./Paginate-Da51AWMI.js";import{_ as F}from"./SpinnerBtn-CfgwDcW3.js";import{_ as v}from"./MultiSelect-i-Xpur08.js";import{_ as X}from"./NoDataFound-B_cqdyiG.js";import{s as Y,m as Z}from"./sharedComposable-TMw4c8uc.js";import{_ as ee}from"./UserLayout-CXO-83Mq.js";import{u as se}from"./modalStore-CB1x_O57.js";import{t as M}from"./toastComposable-BZSSJ7BC.js";import"./multiselect-B77LSZRy.js";import"./IntersectionObserver-D-rwMhVF.js";import"./AssetModal-Dh0jwXcc.js";import"./assetStore-W3D4A6Yl.js";const te={class:"flex justify-between items-center mb-4"},oe={class:"flex gap-2"},le=["disabled"],re=["disabled"],ae={class:"table-responsive mt-4 w-full"},ne={class:"table"},ie=["checked"],de={class:"w-[25%]"},ue={class:"!text-right"},ce={class:"!text-right"},pe={key:0,class:"tbody"},me=["value"],_e={class:"flex items-center gap-2"},be=["src"],he={class:"!text-right"},ge={class:"flex justify-end"},ve={class:"dropdown","data-placement":"bottom-start"},fe={class:"dropdown-toggle"},ke={class:"dropdown-content w-56"},we={class:"dropdown-list"},Se={class:"dropdown-list-item"},ye={class:"dropdown-list-item"},Ve=["onClick"],Ce={class:"w-full"},Fe={class:"mb-2"},xe={key:0,class:"text-red-600"},De={class:"mb-2"},Ge={key:0,class:"text-red-600"},Me={class:"mt-2"},Ae={class:"w-full"},Ie={class:"label mb-1"},$e={href:"/assets/whatsapp-customers-sample.csv",download:""},Pe={key:0,class:"text-red-600"},Be={class:"mb-2"},Ne={key:0,class:"text-red-600"},Ue={class:"mt-2"},je={class:"mb-2"},Le={key:0,class:"text-red-600"},Oe={class:"mb-2"},Te={key:0,class:"text-red-600"},Ee={class:"mt-2"},Re={class:"w-full"},qe={class:"mt-4"},as=Object.assign({layout:ee},{__name:"Index",props:["groups","platforms","customers","scraped_record"],setup(c){const f=se(),x=c,{deleteRow:B}=Y(),i=w({platform_ids:[],group_ids:[]}),d=w({scraped_record_ids:[],group_ids:[]}),p=w({csv_file:null,group_ids:[]}),n=I([]),k=I([]),A=q(()=>x.customers.data.length>0&&n.value.length===x.customers.data.length),N=()=>{A.value?n.value=[]:n.value=x.customers.data.map(a=>a.id)},D=w({customer_ids:[]}),b=w({customer_ids:[],group_ids:[]}),U=()=>{i.post(route("user.whatsapp-web.customers.import-from-device"),{onSuccess:()=>{f.close("importFromDeviceModal"),i.reset()}})},j=()=>{d.post(route("user.whatsapp-web.customers.import-from-scraping"),{onSuccess:()=>{f.close("importFromScrapeDataModal"),d.reset()}})},L=()=>{p.post(route("user.whatsapp-web.customers.bulk-import"),{onSuccess:()=>{f.close("importModal"),p.reset()}})},O=()=>{if(n.value.length===0){M.error("Please select at least one customer to delete.");return}Z.initCallback(()=>{D.customer_ids=n.value,D.post(route("user.whatsapp-web.customers.bulk-delete"),{onSuccess:()=>{n.value=[],D.reset()}})})},T=()=>{if(n.value.length===0){M.error("Please select at least one customer to assign groups.");return}if(k.value.length===0){M.error("Please select at least one group to assign.");return}b.customer_ids=n.value,b.group_ids=k.value,b.post(route("user.whatsapp-web.customers.bulk-assign-group"),{onSuccess:()=>{f.close("bulkAssignGroupModal"),n.value=[],k.value=[],b.reset()}})},E=[{label:"Name",value:"name"},{label:"Phone",value:"uuid"}];return(a,r)=>{const R=z("Link");return u(),m(P,null,[e("div",te,[o(Q,{options:E}),e("div",oe,[e("button",{onClick:O,disabled:n.value.length===0,class:"btn btn-danger"},[o(s(S),{icon:"bx:trash"}),h(" "+l(a.trans("Bulk Delete")),1)],8,le),e("button",{onClick:r[0]||(r[0]=t=>s(f).open("bulkAssignGroupModal")),disabled:n.value.length===0,class:"btn btn-primary"},[o(s(S),{icon:"bx:group"}),h(" "+l(a.trans("Bulk Assign Group")),1)],8,re)])]),e("div",ae,[e("table",ne,[e("thead",null,[e("tr",null,[e("th",null,[e("input",{type:"checkbox",onChange:N,checked:A.value},null,40,ie)]),e("th",de,l(a.trans("Name")),1),e("th",null,l(a.trans("Phone")),1),e("th",ue,l(a.trans("Groups")),1),e("th",ce,l(a.trans("Action")),1)])]),c.customers.data.length?(u(),m("tbody",pe,[(u(!0),m(P,null,H(c.customers.data,(t,G)=>(u(),m("tr",{key:G},[e("td",null,[J(e("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":r[1]||(r[1]=y=>n.value=y)},null,8,me),[[K,n.value]])]),e("td",null,[e("div",_e,[e("img",{src:t.picture??"https://ui-avatars.com/api/?name="+t.name,class:"h-8 w-8 rounded-full"},null,8,be),e("span",null,l(t.name),1)])]),e("td",null,l(t.uuid),1),e("td",he,l(t.groups.map(y=>y.name).join(", ")||"N/A"),1),e("td",null,[e("div",ge,[e("div",ve,[e("div",fe,[o(s(S),{class:"h-5 text-3xl text-slate-400",icon:"bx:dots-vertical-rounded"})]),e("div",ke,[e("ul",we,[e("li",Se,[o(R,{href:a.route("user.whatsapp-web.customers.edit",t),class:"dropdown-link"},{default:g(()=>[o(s(S),{icon:"bx:edit"}),h(" "+l(a.trans("Edit")),1)]),_:2},1032,["href"])]),e("li",ye,[e("button",{class:"dropdown-link delete-confirm",href:"#",onClick:y=>s(B)(a.route("user.whatsapp-web.customers.destroy",t.id))},[o(s(S),{icon:"bx:trash"}),h(" "+l(a.trans("Delete")),1)],8,Ve)])])])])])])]))),128))])):(u(),$(X,{key:1,forTable:!0}))]),e("div",Ce,[c.customers.data.length?(u(),$(W,{key:0,links:c.customers.links},null,8,["links"])):_("",!0)])]),o(C,{state:"importFromDeviceModal","header-state":!0,"header-title":"Import from device"},{default:g(()=>[e("form",{onSubmit:V(U,["prevent"])},[e("div",Fe,[o(v,{label:"Import from",placeholder:"Select Devices",modelValue:s(i).platform_ids,"onUpdate:modelValue":r[2]||(r[2]=t=>s(i).platform_ids=t),options:c.platforms},null,8,["modelValue","options"]),s(i).errors.platform_ids?(u(),m("small",xe,l(s(i).errors.platform_ids),1)):_("",!0)]),e("div",De,[o(v,{label:"Import to",placeholder:"Select Groups",modelValue:s(i).group_ids,"onUpdate:modelValue":r[3]||(r[3]=t=>s(i).group_ids=t),options:c.groups},null,8,["modelValue","options"]),s(i).errors.group_ids?(u(),m("small",Ge,l(s(i).errors.group_ids),1)):_("",!0)]),e("div",Me,[o(F,{classes:"btn btn-primary w-full","btn-text":"Import Contacts",processing:s(i).processing},null,8,["processing"])])],32)]),_:1}),o(C,{state:"importModal","header-state":!0,"header-title":"Import customers"},{default:g(()=>[e("form",{onSubmit:V(L,["prevent"])},[e("div",Ae,[e("label",Ie,[h(l(a.trans("Select CSV"))+" ",1),e("a",$e,l(a.trans("(Download Sample)")),1)]),e("input",{type:"file",accept:".csv",onChange:r[4]||(r[4]=t=>s(p).csv_file=t.target.files[0]),class:"input"},null,32),s(p).errors.csv_file?(u(),m("small",Pe,l(s(p).errors.csv_file),1)):_("",!0)]),e("div",Be,[o(v,{label:"Groups",placeholder:"Select Groups",modelValue:s(p).group_ids,"onUpdate:modelValue":r[5]||(r[5]=t=>s(p).group_ids=t),options:c.groups,"input-label":"label",valueProp:"value"},null,8,["modelValue","options"]),s(p).errors.group_ids?(u(),m("small",Ne,l(s(p).errors.group_ids),1)):_("",!0)]),e("div",Ue,[o(F,{classes:"btn btn-primary w-full",processing:s(p).processing},null,8,["processing"])])],32)]),_:1}),o(C,{state:"importFromScrapeDataModal","header-state":!0,"header-title":"Import contacts"},{default:g(()=>[e("form",{onSubmit:V(j,["prevent"])},[e("div",je,[o(v,{label:"Import from",placeholder:"Select Scraped Records",modelValue:s(d).scraped_record_ids,"onUpdate:modelValue":r[6]||(r[6]=t=>s(d).scraped_record_ids=t),options:c.scraped_record,"input-label":"label",valueProp:"value"},null,8,["modelValue","options"]),s(d).errors.scraped_record_ids?(u(),m("small",Le,l(s(i).errors.scraped_record_ids),1)):_("",!0)]),e("div",Oe,[o(v,{label:"Import to",placeholder:"Select Groups",modelValue:s(d).group_ids,"onUpdate:modelValue":r[7]||(r[7]=t=>s(d).group_ids=t),options:c.groups,"input-label":"label",valueProp:"value"},null,8,["modelValue","options"]),s(d).errors.group_ids?(u(),m("small",Te,l(s(d).errors.group_ids),1)):_("",!0)]),e("div",Ee,[o(F,{classes:"btn btn-primary w-full","btn-text":"Import Contacts",disabled:!s(d).group_ids.length||!s(d).scraped_record_ids.length,processing:s(d).processing},null,8,["disabled","processing"])])],32)]),_:1}),o(C,{state:"bulkAssignGroupModal","header-state":!0,"header-title":"Bulk Assign Groups"},{default:g(()=>{var t;return[e("form",{onSubmit:V(T,["prevent"])},[e("div",Re,[o(v,{label:"Groups",valueProp:"value","input-label":"label",options:c.groups,modelValue:k.value,"onUpdate:modelValue":r[8]||(r[8]=G=>k.value=G),placeholder:"Select groups",validationMessage:(t=s(b).errors)==null?void 0:t.group_ids},null,8,["options","modelValue","validationMessage"])]),e("div",qe,[o(F,{classes:"btn btn-primary w-full",processing:s(b).processing},{default:g(()=>[h(l(a.trans("Assign Groups")),1)]),_:1},8,["processing"])])],32)]}),_:1})],64)}}});export{as as default};
