import{c as i,f as m,o as n,b as e,t as s,B as l,k,l as G,m as Y,V as U,U as J,a as d,u as a,F as B,g as K,i as q,O as u,z as X,j as T,w as L,W as M,p as D}from"./app-BPxwetsb.js";import{H as A}from"./IntersectionObserver-D-rwMhVF.js";import{_ as Z}from"./UserLayout-CXO-83Mq.js";import{u as ee}from"./modalStore-CB1x_O57.js";import{t as te}from"./toastComposable-BZSSJ7BC.js";import{_ as ae}from"./Modal-BIKyjMag.js";import{m as se}from"./sharedComposable-TMw4c8uc.js";import"./AssetModal-Dh0jwXcc.js";import"./assetStore-W3D4A6Yl.js";const oe={key:0,class:"mb-3 mt-8 flex flex-col items-center justify-center"},le=["src"],re={class:"font-semibold text-gray-500 dark:text-gray-300"},W={__name:"ErrorWarning",props:{errorCode:{type:Number,default:null}},setup(v){const c={500:{message:"Server Error",image:"/assets/images/server-warning.png"}};return(h,R)=>{var g,x;return v.errorCode&&c[v.errorCode]?(n(),i("div",oe,[e("img",{src:(g=c[v.errorCode])==null?void 0:g.image,class:"mb-1 h-20",alt:""},null,8,le),e("p",re,s((x=c[v.errorCode])==null?void 0:x.message),1)])):m("",!0)}}},ne={key:0},de={colspan:"10"},ie={class:"flex flex-col items-center justify-center mt-5 mb-8"},ce={class:"text-gray-500"},ue={key:1,class:"flex flex-col items-center justify-center mt-5 mb-8"},me={class:"text-gray-500"},he={__name:"NoDataFound",props:{forTable:{type:[Boolean,String],default:!1}},setup(v){return(c,h)=>v.forTable?(n(),i("tbody",ne,[e("tr",null,[e("td",de,[e("div",ie,[h[0]||(h[0]=e("img",{src:"/assets/images/no-data.svg",class:"h-16 my-3",alt:""},null,-1)),e("p",ce,s(c.trans("No data found")),1)])])])])):(n(),i("div",ue,[h[1]||(h[1]=e("img",{src:"/assets/images/no-data.svg",class:"h-16 my-3",alt:""},null,-1)),e("p",me,s(c.trans("No data found")),1)]))}},ge={class:"grid grid-cols-1 place-items-start gap-6 lg:grid-cols-12"},pe={class:"card card-body shadow-lg transition-all hover:shadow-xl lg:col-span-4"},fe={class:"mb-4 text-xl font-bold text-primary-600"},ve={class:"relative"},xe={class:"relative z-10 flex flex-col"},ye={class:"mr-4 shrink-0"},be={class:"flex h-12 w-12 items-center justify-center rounded-full bg-gradient-to-br from-primary-600 to-primary-500 text-white shadow-md transition-all hover:shadow-lg"},_e={class:"pt-2"},we={class:"mb-1 text-xs font-bold text-primary-500"},Ce={class:"text-sm font-medium"},ke={class:"card card-body shadow-lg transition-all hover:shadow-xl lg:col-span-8"},qe={class:"mb-6 text-center text-xl font-bold text-primary-600"},Te={key:0,class:"flex flex-col items-center justify-center"},Le={key:1,class:"relative my-8 h-[200px] w-[200px] overflow-hidden rounded-lg shadow-lg transition-all hover:shadow-xl"},Se=["src"],Ie={class:"absolute left-1/2 top-1/2 flex h-16 w-16 -translate-x-1/2 -translate-y-1/2 items-center justify-center rounded-full bg-white shadow-lg"},$e={key:1,class:"mx-auto w-4/5 max-w-xs p-1 shadow-inner"},je={class:"mt-2 text-center text-xs font-medium text-gray-500 dark:text-gray-400"},Me={class:"mt-8 flex flex-col items-center justify-center gap-2 pb-6"},De={key:0,class:"my-4 text-sm text-gray-500"},Qe={class:"flex flex-wrap items-center justify-center gap-3"},Ne={key:3,class:"mt-6 flex flex-col items-center"},Be={class:"mb-4 flex justify-center"},Re={class:"rounded-lg border border-primary-500 bg-white px-8 py-2 shadow-lg dark:bg-gray-800"},Ee={class:"text-center text-2xl font-bold tracking-widest"},Pe={class:"mt-2 max-w-sm rounded-lg bg-yellow-50 p-4 text-center dark:bg-yellow-900/30"},Ae={class:"text-sm font-medium text-yellow-800 dark:text-yellow-200"},We={class:"mt-1 text-xs text-yellow-700 dark:text-yellow-300"},Oe={key:1,class:"flex flex-col items-center"},Ve={class:"relative my-6"},He=["src"],ze={class:"mb-4 text-2xl font-bold text-green-600 dark:text-green-400"},Fe={class:"mb-8 text-center text-gray-600 dark:text-gray-300"},Ge={class:"grid w-full grid-cols-2 gap-4"},Ye={class:"flex flex-col items-center p-6 text-center"},Ue={class:"mb-4 rounded-full bg-yellow-100 p-4 dark:bg-yellow-900/30"},Je={class:"mb-2 text-2xl font-bold text-gray-800 dark:text-gray-100"},Ke={class:"mb-6 text-gray-600 dark:text-gray-300"},Xe={class:"flex gap-3"},O=12e4,Ze=1e4,it=Object.assign({layout:Z},{__name:"Connection",props:["platform"],setup(v){const c=ee(),h=v,R=[{icon:"bx:bxl-whatsapp",text:l("Open WhatsApp on your phone"),image:"/assets/images/scan-demo.gif"},{icon:"bx:cog",text:l("Tap Menu or Settings and select Linked Devices"),image:"/assets/images/scan-demo.gif"},{icon:"bx:like",text:l("Tap on Link a Device"),image:"/assets/images/scan-demo.gif"},{icon:"material-symbols-light:qr-code-2-rounded",text:l("Point your phone to this screen to capture the code"),image:"/assets/images/scan-demo.gif"}],g=k(!1),x=k(0),p=k(null),_=k(!1),t=k({qrCode:null,code:null,authType:"qr_code",qrCodeLoader:!0,codeLoader:!1});let S=null,I=null,y=null;const $=()=>{t.value.qrCodeLoader=!0,p.value=null,D.get(route("user.whatsapp-web.api.platforms.connection",{uuid:h.platform.uuid})).then(o=>{var r,f;t.value.qrCodeLoader=!1,t.value.qrCode=(f=(r=o.data)==null?void 0:r.data)==null?void 0:f.qrcode,Q()}).catch(o=>{t.value.qrCodeLoader=!1,p.value=o.status,console.log(o)})},E=()=>{b(),t.value.authType="code",t.value.codeLoader=!0,p.value=null,D.get(route("user.whatsapp-web.api.platforms.code",{uuid:h.platform.uuid})).then(o=>{var r,f;t.value.codeLoader=!1,t.value.code=(f=(r=o.data)==null?void 0:r.data)==null?void 0:f.code,Q()}).catch(o=>{t.value.codeLoader=!1,t.value.code=null,p.value=o.status})},Q=()=>{y&&clearInterval(y),y=setInterval(()=>{_.value||g.value||D.get(route("user.whatsapp-web.api.platforms.check-status"),{params:{uuid:h.platform.uuid}}).then(o=>{var r;["authenticated"].includes((r=o.data.data)==null?void 0:r.status)?(g.value=!0,_.value=!0,t.value.qrCodeLoader=!1,clearInterval(y),b()):(g.value=!1,!t.value.qrCodeLoader&&!t.value.qrCode&&!_.value&&t.value.authType==="qr_code"&&($(),C()))}).catch(o=>{t.value.qrCodeLoader=!1,p.value=o.status,o.status===500&&clearInterval(y)})},Ze)},w=()=>{S&&(clearInterval(S),S=null)},C=()=>{b(),x.value=0;const o=Date.now();S=setInterval(()=>{const f=Date.now()-o;x.value=Math.max(100-f/O*100,0),x.value<=0&&w()},200),I=setTimeout(()=>{b(),!c.getState("qrCodeModal")&&t.value.authType==="qr_code"&&!g.value&&(c.open("qrCodeModal"),t.value.qrCodeLoader=!1,t.value.qrCode=null,w())},O)},V=G(()=>`${x.value}%`),b=()=>{I&&(clearTimeout(I),I=null)};Y(()=>{var o;((o=h.platform)==null?void 0:o.status)==="authenticated"?Q():$(),C()}),U(()=>{b(),clearInterval(y),w()}),J(()=>c.getState("qrCodeModal"),o=>{o?(_.value=!0,b()):C()});const H=()=>{se.initCallback(()=>{D.delete(route("user.whatsapp-web.api.platforms.destroy",h.platform.uuid)).then(o=>{var r;((r=o.data)==null?void 0:r.status)===!0&&(te.success("Session revoked successfully"),g.value=!1,_.value=!1,w(),$(),C())})})},N=()=>{g.value=!1,_.value=!0,w(),clearInterval(y),$(),b(),C(),c.close()},z=()=>{t.value.authType=t.value.authType==="qr_code"?"code":"qr_code",t.value.authType==="qr_code"&&(w(),t.value.code=null,N()),t.value.authType==="code"&&(t.value.qrCode=null,E())},F=()=>localStorage.getItem("theme")==="dark"||!("theme"in localStorage)&&window.matchMedia("(prefers-color-scheme: dark)").matches;return(o,r)=>{var f;return n(),i(B,null,[e("div",ge,[e("div",pe,[e("h2",fe,s(a(l)("How to Scan QR Code")),1),r[2]||(r[2]=e("div",{class:"relative mb-6 overflow-hidden rounded-lg"},[e("img",{src:"/assets/images/scan-demo.gif",alt:"scan-demo.gif",class:"w-full rounded-lg shadow-md transition-transform hover:scale-[1.02]"})],-1)),e("div",ve,[r[1]||(r[1]=e("div",{class:"absolute left-6 top-6 hidden h-[calc(100%-12px)] w-0.5 bg-gradient-to-b from-primary-500 to-primary-400 shadow-md md:block"},null,-1)),e("div",xe,[(n(),i(B,null,K(R,(j,P)=>e("div",{key:P,class:"relative flex h-24 items-start p-1 transition-all hover:bg-gray-50 dark:hover:bg-gray-800/30"},[e("div",ye,[e("div",be,[d(a(u),{icon:j.icon,class:"text-xl"},null,8,["icon"])])]),e("div",_e,[e("p",we,s(a(l)("STEP"))+" "+s(P+1),1),e("span",Ce,s(j.text),1)])])),64))])])]),e("div",ke,[g.value?(n(),i("div",Oe,[e("div",Ve,[e("img",{class:"w-60",src:`/assets/images/${F()?"":"dark-"}confetti.gif`,alt:"confetti"},null,8,He)]),e("h2",ze,s(a(l)("Connected Successfully")),1),e("p",Fe,s(a(l)("Your WhatsApp account is now linked. You can start using the services.")),1),e("div",Ge,[d(a(M),{class:"btn flex items-center justify-center gap-2 bg-gradient-to-r from-blue-600 to-blue-500 text-white shadow-md transition-all hover:-translate-y-0.5 hover:shadow-lg",href:o.route("user.whatsapp-web.platforms.index")},{default:L(()=>[d(a(u),{icon:"bx:list-ul",class:"text-lg"}),e("span",null,s(a(l)("Chat List")),1)]),_:1},8,["href"]),d(a(M),{class:"btn flex items-center justify-center gap-2 bg-gradient-to-r from-green-600 to-green-500 text-white shadow-md transition-all hover:-translate-y-0.5 hover:shadow-lg",href:o.route("user.whatsapp-web.groups.index")},{default:L(()=>[d(a(u),{icon:"bx:group",class:"text-lg"}),e("span",null,s(a(l)("Group List")),1)]),_:1},8,["href"]),d(a(M),{class:"btn flex items-center justify-center gap-2 bg-gradient-to-r from-purple-600 to-purple-500 text-white shadow-md transition-all hover:-translate-y-0.5 hover:shadow-lg",href:o.route("user.whatsapp-web.send-message.create")},{default:L(()=>[d(a(u),{icon:"bx:send",class:"text-lg"}),e("span",null,s(a(l)("Send Message")),1)]),_:1},8,["href"]),d(a(M),{class:"btn flex items-center justify-center gap-2 bg-gradient-to-r from-amber-600 to-amber-500 text-white shadow-md transition-all hover:-translate-y-0.5 hover:shadow-lg",href:o.route("user.whatsapp-web.send-bulk-message.index")},{default:L(()=>[d(a(u),{icon:"bx:rocket",class:"text-lg"}),e("span",null,s(a(l)("Bulk Message")),1)]),_:1},8,["href"])]),e("button",{class:"btn mt-6 flex w-full items-center justify-center gap-2 bg-gradient-to-r from-red-600 to-red-500 text-white shadow-md transition-all hover:shadow-lg",onClick:H},[d(a(u),{icon:"bx:log-out",class:"text-lg"}),e("span",null,s(a(l)("Disconnect Device")),1)])])):(n(),i(B,{key:0},[e("h2",qe,s(a(l)(`${t.value.authType==="qr_code"?"Scan QR Code":"Enter Code"} On Your WhatsApp Mobile App`)),1),t.value.authType==="qr_code"?(n(),i("div",Te,[t.value.qrCodeLoader?(n(),q(A,{key:0,class:"mt-8 scale-150"})):m("",!0),!t.value.qrCodeLoader&&t.value.qrCode?(n(),i("div",Le,[e("img",{src:(f=t.value)==null?void 0:f.qrCode,alt:"qr-code",class:"h-full w-full"},null,8,Se),e("div",Ie,[d(a(u),{icon:"bx:bxl-whatsapp",class:"text-3xl text-green-500"})])])):!t.value.qrCodeLoader&&!t.value.qrCode&&!p.value?(n(),q(he,{key:2})):m("",!0),p.value?(n(),q(W,{key:3,"error-code":p.value},null,8,["error-code"])):m("",!0)])):m("",!0),!t.value.qrCodeLoader&&t.value.qrCode&&t.value.authType==="qr_code"?(n(),i("div",$e,[e("div",{class:"h-2 rounded-full bg-gradient-to-r from-primary-600 to-primary-400 transition-all duration-300",style:X({width:V.value})},null,4),e("p",je,s(a(l)("QR Code expires in"))+" "+s(Math.ceil(x.value*1.2))+" "+s(a(l)("seconds")),1)])):m("",!0),e("div",Me,[t.value.authType==="qr_code"?(n(),i("p",De,s(a(l)("Having trouble scanning?")),1)):m("",!0),e("div",Qe,[e("button",{class:"btn flex items-center gap-2 bg-gradient-to-r from-primary-600 to-primary-500 text-white shadow-md transition-all hover:shadow-lg",type:"button",onClick:z},[d(a(u),{icon:t.value.authType==="qr_code"?"bx:mobile":"material-symbols-light:qr-code-2-rounded",class:"text-lg"},null,8,["icon"]),T(" "+s(a(l)(`Connect with ${t.value.authType==="qr_code"?"phone number":"QR code"} instead`)),1)]),t.value.authType==="qr_code"?(n(),i("button",{key:0,class:"btn flex items-center gap-2 bg-blue-500 text-white shadow-md transition-all hover:shadow-lg",onClick:N,type:"button"},[d(a(u),{icon:"bx:refresh",class:"text-lg"}),T(" "+s(a(l)("Refresh QR Code")),1)])):m("",!0),t.value.authType==="code"?(n(),i("button",{key:1,class:"btn flex items-center gap-2 bg-blue-500 text-white shadow-md transition-all hover:shadow-lg",onClick:E,type:"button"},[d(a(u),{icon:"bx:refresh",class:"text-lg"}),T(" "+s(a(l)("Generate New Code")),1)])):m("",!0)]),t.value.codeLoader?(n(),q(A,{key:1,class:"mt-6 scale-150"})):m("",!0),p.value&&t.value.authType==="code"&&!t.value.qrCodeLoader&&!t.value.codeLoader?(n(),q(W,{key:2,"error-code":p.value},null,8,["error-code"])):m("",!0),t.value.code&&!t.value.codeLoader?(n(),i("div",Ne,[e("div",Be,[e("div",Re,[e("p",Ee,s(t.value.code),1)])]),e("div",Pe,[e("p",Ae,s(a(l)("Enter this code on your WhatsApp")),1),e("p",We,s(a(l)("Never enter a code if you didn't request it.")),1)])])):m("",!0)])],64))])]),d(ae,{state:"qrCodeModal"},{default:L(()=>[e("div",Ye,[e("div",Ue,[d(a(u),{icon:"bi:info-circle",class:"h-16 w-16 text-yellow-500"})]),e("h2",Je,s(a(l)("QR Code Expired")),1),e("p",Ke,s(a(l)("The QR code has expired. Please refresh to generate a new one.")),1),e("div",Xe,[e("button",{class:"btn flex items-center gap-2 bg-primary-600 text-white shadow-md transition-all hover:bg-primary-700",type:"button",onClick:N},[d(a(u),{icon:"bx:refresh",class:"text-lg"}),T(" "+s(a(l)("Generate New QR")),1)]),e("button",{class:"btn flex items-center gap-2 bg-gray-500 text-white shadow-md transition-all hover:bg-gray-600",onClick:r[0]||(r[0]=(...j)=>a(c).close&&a(c).close(...j))},[d(a(u),{icon:"bx:x",class:"text-lg"}),T(" "+s(a(l)("Close")),1)])])])]),_:1})],64)}}});export{it as default};
