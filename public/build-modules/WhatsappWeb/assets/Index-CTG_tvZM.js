import{_ as Z}from"./NotificationRing-B2MsBP3t.js";import{_ as ee}from"./FilterDropdown-vJQ_5eqF.js";import{_ as te}from"./Paginate-Da51AWMI.js";import{_ as se}from"./NoDataFound-B_cqdyiG.js";import{T as ae,U as R,l as le,i as N,o as d,w as V,b as e,d as oe,C as H,c as i,f as b,e as g,t as o,u as l,h as k,v,F as w,g as C,a as c,k as re,r as G,n as x,j as ne,B as u,a1 as de}from"./app-BPxwetsb.js";import{_ as ie}from"./Modal-BIKyjMag.js";import{_ as ue}from"./SpinnerBtn-CfgwDcW3.js";import{u as K}from"./modalStore-CB1x_O57.js";import{s as ce}from"./sharedComposable-TMw4c8uc.js";import{t as J}from"./toastComposable-BZSSJ7BC.js";import{_ as me}from"./UserLayout-CXO-83Mq.js";import"./echoServiceComposable-DU9yHR3K.js";import"./IntersectionObserver-D-rwMhVF.js";import"./AssetModal-Dh0jwXcc.js";import"./assetStore-W3D4A6Yl.js";const _e={class:"mb-2"},pe={for:"name",class:"label"},ge={key:0,class:"mb-2"},be={for:"access_token",class:"label"},ye={class:"mb-2"},he={value:!0},xe={value:!1},fe={key:1,class:"mb-2"},ke=["value"],ve={key:2,class:"mb-2"},we=["value"],$e={class:"mb-2"},Se={value:!0},Re={value:!1},Ne={key:0,class:"mt-2"},Ve={class:"mb-2"},Ce={for:"webhook_callback_url",class:"label"},Me={class:"text-gray-600 dark:text-gray-400"},Ue={class:"mt-2 text-end"},je={__name:"PlatformSettingModal",props:{platform:{type:Object,required:!0},autoReplyServices:{type:Array,default:[]},hideFields:{type:Array,default:[]}},setup(_){const $=K(),m=_,t=ae({module:m.platform.module,name:"",access_token:"",send_auto_reply:!1,auto_reply_method:"",auto_reply_method_name:"",auto_reply_dataset:"",auto_reply_dataset_name:"",send_welcome_message:!1,welcome_message_template:"",webhook_callback_url:""});R(()=>m.platform.id,()=>{var s;if((s=m.platform)!=null&&s.uuid){let n=m.platform.meta??{};t.name=m.platform.name,t.access_token=m.platform.access_token,t.send_auto_reply=n.send_auto_reply,t.auto_reply_method=n.auto_reply_method,t.auto_reply_method_name=n.auto_reply_method_name,t.auto_reply_dataset=n.auto_reply_dataset,t.auto_reply_dataset_name=n.auto_reply_dataset_name,t.send_welcome_message=n.send_welcome_message,t.welcome_message_template=n.welcome_message_template,t.webhook_callback_url=n.webhook_callback_url||""}}),R(()=>t.auto_reply_dataset,()=>{var n;let s=(n=y.value.datasets)==null?void 0:n.find(a=>a.id===t.auto_reply_dataset);t.auto_reply_dataset_name=(s==null?void 0:s.title)??(s==null?void 0:s.name)??"NA"}),R(()=>t.auto_reply_method,()=>{t.auto_reply_method_name=y.value.title||"NA",y.value.module==="default"&&(t.auto_reply_dataset="")});const f=()=>{t.put(route(`user.${m.platform.module}.platforms.update`,m.platform.uuid),{onSuccess:()=>{$.close("platformSettingModal")}})},y=le(()=>m.autoReplyServices.find(s=>s.module===t.auto_reply_method)||{});return(s,n)=>(d(),N(ie,{"header-state":!0,"header-title":"Platform Setting",state:"platformSettingModal"},{default:V(()=>[e("form",{onSubmit:oe(f,["prevent"])},[H(s.$slots,"top"),e("div",_e,[e("label",pe,o(s.trans("Platform Name")),1),g(e("input",{type:"text",class:"input","onUpdate:modelValue":n[0]||(n[0]=a=>l(t).name=a)},null,512),[[k,l(t).name]])]),_.hideFields.includes("access_token")?b("",!0):(d(),i("div",ge,[e("label",be,o(s.trans("Access Token")),1),g(e("input",{type:"text",class:"input","onUpdate:modelValue":n[1]||(n[1]=a=>l(t).access_token=a)},null,512),[[k,l(t).access_token]])])),e("div",ye,[e("label",null,o(s.trans("Send auto reply")),1),g(e("select",{class:"select","onUpdate:modelValue":n[2]||(n[2]=a=>l(t).send_auto_reply=a)},[e("option",he,o(s.trans("Yes")),1),e("option",xe,o(s.trans("No")),1)],512),[[v,l(t).send_auto_reply]]),e("small",null,o(s.trans("Enable or disable auto reply")),1)]),l(t).send_auto_reply==!0?(d(),i("div",fe,[e("label",null,o(s.trans("Auto Reply Service")),1),g(e("select",{class:"select","onUpdate:modelValue":n[3]||(n[3]=a=>l(t).auto_reply_method=a)},[(d(!0),i(w,null,C(_.autoReplyServices,a=>(d(),i("option",{value:a.module,key:a.module},o(a.title),9,ke))),128))],512),[[v,l(t).auto_reply_method]]),e("small",null,o(s.trans("How message will be replied")),1)])):b("",!0),y.value.has_datasets?(d(),i("div",ve,[e("label",null,o(s.trans("Auto Reply Using")),1),g(e("select",{class:"select","onUpdate:modelValue":n[4]||(n[4]=a=>l(t).auto_reply_dataset=a)},[(d(!0),i(w,null,C(y.value.datasets??[],a=>(d(),i("option",{value:a.id,key:a.id},o(a.title),9,we))),128))],512),[[v,l(t).auto_reply_dataset]]),e("small",null,o(s.trans("The auto reply dataset will be used")),1)])):b("",!0),e("div",$e,[e("label",null,o(s.trans("Send Welcome message")),1),g(e("select",{class:"select","onUpdate:modelValue":n[5]||(n[5]=a=>l(t).send_welcome_message=a)},[e("option",Se,o(s.trans("Yes")),1),e("option",Re,o(s.trans("No")),1)],512),[[v,l(t).send_welcome_message]]),l(t).send_welcome_message===!0?(d(),i("div",Ne,[g(e("textarea",{"onUpdate:modelValue":n[6]||(n[6]=a=>l(t).welcome_message_template=a),class:"input",rows:"5"},null,512),[[k,l(t).welcome_message_template]]),e("small",null,o(s.trans("This message will be sent to new users")),1)])):b("",!0)]),e("div",Ve,[e("label",Ce,o(s.trans("External Webhook URL")),1),g(e("input",{type:"url",class:"input","onUpdate:modelValue":n[7]||(n[7]=a=>l(t).webhook_callback_url=a),placeholder:"https://your-domain.com/webhook"},null,512),[[k,l(t).webhook_callback_url]]),e("small",Me,o(s.trans("Forward incoming messages to this external webhook URL (optional)")),1)]),H(s.$slots,"default"),e("div",Ue,[c(ue,{classes:"btn btn-primary",processing:l(t).processing,"btn-text":s.trans("Submit")},null,8,["processing","btn-text"])])],32)]),_:3}))}},Ae={class:"mt-4 flex w-full flex-col gap-4"},Ee={key:0,class:"grid grid-cols-1 gap-4 xl:grid-cols-2 2xl:grid-cols-3"},Fe={class:"flex flex-col items-start justify-between gap-2 sm:flex-row sm:items-center"},Le={class:"flex items-center gap-4"},Pe={class:"flex flex-col"},Te={class:"font-bold capitalize text-gray-900 dark:text-gray-100"},We={class:"text-xs"},Be={class:"mt-4 flex items-center justify-around gap-2"},De=["onClick"],Ie=["onClick"],Oe=["onClick"],qe={class:"mt-4 grid grid-cols-2 gap-2 md:grid-cols-3"},ze={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},Ye={class:"text-xs font-medium text-gray-500"},He={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},Ge={class:"text-xs font-medium text-gray-500"},Je={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},Ke={class:"text-xs font-medium text-gray-500"},Qe={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},Xe={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},Ze={class:"text-xs font-medium text-gray-500"},et={key:0,class:"mt-2 rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},tt={class:"flex items-start gap-2"},st={class:"flex flex-col flex-1 min-w-0"},at={class:"text-xs font-medium text-blue-700 dark:text-blue-400"},lt=["title"],ot={key:1,class:"mt-2 rounded-lg bg-purple-50 p-3 dark:bg-purple-900/20"},rt={class:"flex items-start gap-2"},nt={class:"flex flex-col"},dt={class:"text-xs font-medium text-purple-700 dark:text-purple-400"},it={class:"text-sm text-purple-900 dark:text-purple-100"},ut={class:"w-full"},Rt=Object.assign({layout:me},{__name:"Index",props:["platforms","autoReplyServices"],setup(_){const $=K(),{deleteRow:m,textExcerpt:t}=ce(),f=re({}),y=a=>{f.value=a,$.open("platformSettingModal")},s=[{label:"Name",value:"name"},{label:"Status",value:"status"}],n=a=>{axios.get(route("user.whatsapp-web.api.platforms.check-verification",a)).then(S=>{J.success(u("Number is verified successfully")),de.reload()}).catch(S=>{var p,h;J.danger(((h=(p=S.response)==null?void 0:p.data)==null?void 0:h.message)??u("Something went wrong"))})};return(a,S)=>{var M,U,j;const p=G("Icon"),h=G("Link");return d(),i(w,null,[c(Z,{module:"whatsapp-web"}),c(ee,{options:s}),e("div",Ae,[_.platforms&&((M=_.platforms)!=null&&M.data.length)?(d(),i("div",Ee,[(d(!0),i(w,null,C(_.platforms.data,(r,Q)=>{var A,E,F,L,P,T,W,B,D,I,O,q,z,Y;return d(),i("div",{key:Q,class:"card card-body group flex flex-col gap-3 rounded-2xl border border-gray-100 bg-white p-6 shadow-sm transition-all duration-200 hover:shadow-md dark:border-gray-800 dark:bg-gray-900"},[e("div",Fe,[e("div",Le,[e("div",Pe,[e("p",Te,o(l(t)(r.name,20)),1),e("span",We,o((A=r.meta)==null?void 0:A.phone_number),1),e("span",{class:x(["mt-1 inline-flex w-fit items-center rounded-full px-2 py-px text-xs lowercase",{"bg-emerald-100 text-emerald-700":r.status==="authenticated"||r.status==="verified"||r.status==="authenticated","bg-red-100 text-red-700":["disconnected","inactive","unverified"].includes(r.status),"bg-yellow-100 text-yellow-700":r.status==="wait_for","bg-blue-100 text-blue-700":r.status==="pulling_wa_data"}])},[e("span",{class:x(["mr-1 mt-0.5 h-2 w-2 rounded-full",{"bg-emerald-500":r.status==="authenticated"||r.status==="verified","bg-red-500":["disconnected","inactive","unverified"].includes(r.status),"bg-yellow-500":r.status==="wait_for","bg-blue-500":r.status==="pulling_wa_data"}])},null,2),ne(" "+o(r.status),1)],2)])]),e("div",Be,[c(h,{class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-blue-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-blue-400",href:a.route("user.whatsapp-web.platforms.conversations.index",r.uuid),title:"View Messages"},{default:V(()=>[c(p,{icon:"bx:message-square-dots",class:"text-xl"})]),_:2},1032,["href"]),c(h,{title:"Reconnect",class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-indigo-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-indigo-400",href:a.route("user.whatsapp-web.platforms.connection",r.uuid)},{default:V(()=>[c(p,{icon:"bx:refresh",class:"text-xl"})]),_:2},1032,["href"]),(E=r.meta)!=null&&E.verified?b("",!0):(d(),i("button",{key:0,title:"Verify Number",type:"button",class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-emerald-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-emerald-400",onClick:X=>n(r.uuid)},[c(p,{icon:"bx:check-shield",class:"text-xl"})],8,De)),e("button",{class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-gray-100 hover:text-emerald-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-emerald-400",onClick:()=>y(r),title:"Settings"},[c(p,{icon:"bx:cog",class:"text-xl"})],8,Ie),e("button",{title:"Delete Platform",type:"button",onClick:X=>l(m)(a.route("user.whatsapp-web.platforms.destroy",r)),class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2.5 text-gray-700 transition-colors hover:bg-red-50 hover:text-red-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-red-900/20 dark:hover:text-red-400"},[c(p,{icon:"bx:trash",class:"text-xl"})],8,Oe)])]),e("div",qe,[e("div",ze,[e("span",Ye,o(l(u)("Welcome Message")),1),e("span",{class:x(["text-sm font-semibold",(F=r.meta)!=null&&F.send_welcome_message?"text-emerald-600":"text-red-600"])},o((L=r.meta)!=null&&L.send_welcome_message?l(u)("Enabled"):l(u)("Disabled")),3)]),e("div",He,[e("span",Ge,o(l(u)("Auto Reply")),1),e("span",{class:x(["text-sm font-semibold",(P=r.meta)!=null&&P.send_auto_reply?"text-emerald-600":"text-red-600"])},o((T=r.meta)!=null&&T.send_auto_reply?l(u)("Enabled"):l(u)("Disabled")),3)]),e("div",Je,[e("span",Ke,o(l(u)("Auto Reply Method")),1),e("span",Qe,o((W=r.meta)==null?void 0:W.auto_reply_method),1)]),e("div",Xe,[e("span",Ze,o(l(u)("External Webhook")),1),e("span",{class:x(["text-sm font-semibold",(B=r.meta)!=null&&B.webhook_callback_url?"text-emerald-600":"text-gray-400"])},o((D=r.meta)!=null&&D.webhook_callback_url?l(u)("Configured"):l(u)("Not Set")),3)])]),(I=r.meta)!=null&&I.webhook_callback_url?(d(),i("div",et,[e("div",tt,[c(p,{icon:"bx:cloud-upload",class:"mt-0.5 text-lg text-blue-500"}),e("div",st,[e("span",at,o(l(u)("Webhook URL")),1),e("span",{class:"text-xs text-blue-900 dark:text-blue-100 truncate",title:(O=r.meta)==null?void 0:O.webhook_callback_url},o((q=r.meta)==null?void 0:q.webhook_callback_url),9,lt)])])])):b("",!0),(z=r.meta)!=null&&z.send_welcome_message?(d(),i("div",ot,[e("div",rt,[c(p,{icon:"bx:message-rounded-dots",class:"mt-0.5 text-lg text-purple-500"}),e("div",nt,[e("span",dt,o(l(u)("Welcome Message")),1),e("span",it,o((Y=r.meta)==null?void 0:Y.welcome_message_template),1)])])])):b("",!0)])}),128))])):(d(),N(se,{key:1})),e("div",ut,[(j=(U=_.platforms)==null?void 0:U.data)!=null&&j.length?(d(),N(te,{key:0,links:_.platforms.links},null,8,["links"])):b("",!0)])]),c(je,{platform:f.value,autoReplyServices:_.autoReplyServices,hideFields:["access_token"]},null,8,["platform","autoReplyServices"])],64)}}});export{Rt as default};
