import{u as E,s as O,T as C,r as M,p as J,a as K,c as d,o as i,d as s,b as r,k as p,h as o,I as f,t as e,l as V,F as S,i as $,f as x,y as R,w as v,g,e as P,v as q,_ as B,J as A,K as z}from"./app-BYM_31EU.js";import{_ as H}from"./MultiSelect-DLW6ou6k.js";import{_ as Q}from"./FilterDropdown-BCKZL43N.js";import{_ as W}from"./Paginate-Cpv8cjFG.js";import{_ as D}from"./SpinnerBtn-AUjirXqh.js";import{_ as X}from"./NoDataFound-BMo6R2xy.js";import{_ as Y}from"./UserLayout-Br6IHeZb.js";import"./ValidationErrors-MJY6JPWK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ToastrContainer-Bkk7kk5A.js";import"./AssetModal-CWaGrucV.js";import"./assetStore-CRTuDG_T.js";const Z={class:"flex justify-between items-center mb-4"},ss={class:"flex gap-2"},es=["disabled"],ts=["disabled"],os={class:"table-responsive mt-4 w-full"},ls={class:"table"},as=["checked"],ns={class:"!text-right"},rs={key:0,class:"tbody"},is=["value"],us={class:"flex items-center gap-2"},ds=["src"],cs={class:"flex justify-end"},ps={class:"dropdown","data-placement":"bottom-start"},ms={class:"dropdown-toggle"},_s={class:"dropdown-content w-56"},hs={class:"dropdown-list"},fs={class:"dropdown-list-item"},vs={class:"dropdown-list-item"},bs=["onClick"],gs={class:"w-full"},ks={class:"w-full"},ws={class:"label mb-1"},ys={href:"/assets/whatsapp-customers-sample.csv",download:""},Cs={key:0,class:"text-red-600"},Ss={class:"w-full"},As={class:"label mb-1"},Gs={value:""},Ms=["value"],Vs={key:0,class:"text-red-600"},$s={key:1,class:"text-red-600"},xs={class:"mt-4"},Ps={class:"w-full"},Bs={class:"mt-4"},Rs=Object.assign({layout:Y},{__name:"Index",props:["groups","dialCodes","customers","platforms"],setup(c){const k=E(),w=c,{deleteRow:N}=O(),n=C({csv_file:null,group_ids:[],platform_id:""}),a=M([]),_=M([]),G=J(()=>w.customers.data.length>0&&a.value.length===w.customers.data.length),F=()=>{G.value?a.value=[]:a.value=w.customers.data.map(l=>l.id)},m=C({customer_ids:[],group_ids:[]}),y=C({customer_ids:[]}),I=()=>{n.post(route("user.whatsapp.customers.bulk-import"),{onSuccess:()=>{k.close("importModal"),n.reset()}})},j=()=>{if(a.value.length===0){A.error("Please select at least one customer to delete.");return}z.initCallback(()=>{y.customer_ids=a.value,y.post(route("user.whatsapp.customers.bulk-delete"),{onSuccess:()=>{a.value=[],y.reset()}})})},L=()=>{if(a.value.length===0){A.error("Please select at least one customer to assign groups.");return}if(_.value.length===0){A.error("Please select at least one group to assign.");return}m.customer_ids=a.value,m.group_ids=_.value,m.post(route("user.whatsapp.customers.bulk-assign-group"),{onSuccess:()=>{k.close("bulkAssignGroupModal"),a.value=[],_.value=[],m.reset()}})},T=[{label:"Name",value:"name"},{label:"Phone",value:"uuid"}];return(l,u)=>{const U=K("Link");return i(),d(S,null,[s("div",Z,[r(Q,{options:T}),s("div",ss,[s("button",{onClick:j,disabled:a.value.length===0,class:"btn btn-danger"},[r(o(f),{icon:"bx:trash"}),p(" "+e(l.trans("Bulk Delete")),1)],8,es),s("button",{onClick:u[0]||(u[0]=t=>o(k).open("bulkAssignGroupModal")),disabled:a.value.length===0,class:"btn btn-primary"},[r(o(f),{icon:"bx:group"}),p(" "+e(l.trans("Bulk Assign Group")),1)],8,ts)])]),s("div",os,[s("table",ls,[s("thead",null,[s("tr",null,[s("th",null,[s("input",{type:"checkbox",onChange:F,checked:G.value},null,40,as)]),s("th",null,e(l.trans("Name")),1),s("th",null,e(l.trans("Phone")),1),s("th",null,e(l.trans("Groups")),1),s("th",ns,e(l.trans("Action")),1)])]),c.customers.data.length?(i(),d("tbody",rs,[(i(!0),d(S,null,$(c.customers.data,(t,h)=>(i(),d("tr",{key:h},[s("td",null,[x(s("input",{type:"checkbox",value:t.id,"onUpdate:modelValue":u[1]||(u[1]=b=>a.value=b)},null,8,is),[[R,a.value]])]),s("td",null,[s("div",us,[s("img",{src:t.picture??"https://ui-avatars.com/api/?name="+t.name,class:"h-8 w-8 rounded-full"},null,8,ds),s("span",null,e(t.name),1)])]),s("td",null,e(t.uuid),1),s("td",null,e(t.groups.map(b=>b.name).join(", ")||"N/A"),1),s("td",null,[s("div",cs,[s("div",ps,[s("div",ms,[r(o(f),{class:"h-5 text-3xl text-slate-400",icon:"bx:dots-vertical-rounded"})]),s("div",_s,[s("ul",hs,[s("li",fs,[r(U,{href:l.route("user.whatsapp.customers.edit",t),class:"dropdown-link"},{default:v(()=>[r(o(f),{icon:"bx:edit"}),p(" "+e(l.trans("Edit")),1)]),_:2},1032,["href"])]),s("li",vs,[s("button",{class:"dropdown-link delete-confirm",onClick:b=>o(N)(l.route("user.whatsapp.customers.destroy",t.id))},[r(o(f),{icon:"bx:trash"}),p(" "+e(l.trans("Delete")),1)],8,bs)])])])])])])]))),128))])):(i(),V(X,{key:1,forTable:!0}))]),s("div",gs,[c.customers.data.length?(i(),V(W,{key:0,links:c.customers.links},null,8,["links"])):g("",!0)])]),r(B,{state:"importModal","header-state":!0,"header-title":"Import customers"},{default:v(()=>[s("form",{onSubmit:P(I,["prevent"])},[s("div",ks,[s("label",ws,[p(e(l.trans("Select CSV"))+" ",1),s("a",ys,e(l.trans("(Download Sample)")),1)]),s("input",{type:"file",accept:".csv",onChange:u[2]||(u[2]=t=>o(n).csv_file=t.target.files[0]),class:"input"},null,32),o(n).errors.csv_file?(i(),d("small",Cs,e(o(n).errors.csv_file),1)):g("",!0)]),s("div",Ss,[s("label",As,e(l.trans("Platforms")),1),x(s("select",{"onUpdate:modelValue":u[3]||(u[3]=t=>o(n).platform_id=t),class:"select"},[s("option",Gs,e(l.trans("Select Platform")),1),(i(!0),d(S,null,$(c.platforms,(t,h)=>(i(),d("option",{key:h,value:t.id},e(t.name),9,Ms))),128))],512),[[q,o(n).platform_id]]),o(n).errors.platform_id?(i(),d("small",Vs,e(o(n).errors.platform_id),1)):g("",!0),o(n).errors.group_id?(i(),d("small",$s,e(o(n).errors.group_id),1)):g("",!0)]),s("div",xs,[r(D,{classes:"btn btn-primary w-full",processing:o(n).processing},{default:v(()=>[p(e(l.trans("Import")),1)]),_:1},8,["processing"])])],32)]),_:1}),r(B,{state:"bulkAssignGroupModal","header-state":!0,"header-title":"Bulk Assign Groups"},{default:v(()=>{var t;return[s("form",{onSubmit:P(L,["prevent"])},[s("div",Ps,[r(H,{label:"Groups",valueProp:"id","input-label":"name",options:c.groups,modelValue:_.value,"onUpdate:modelValue":u[4]||(u[4]=h=>_.value=h),placeholder:"Select groups",validationMessage:(t=o(m).errors)==null?void 0:t.group_ids},null,8,["options","modelValue","validationMessage"])]),s("div",Bs,[r(D,{classes:"btn btn-primary w-full",processing:o(m).processing},{default:v(()=>[p(e(l.trans("Assign Groups")),1)]),_:1},8,["processing"])])],32)]}),_:1})],64)}}});export{Rs as default};
