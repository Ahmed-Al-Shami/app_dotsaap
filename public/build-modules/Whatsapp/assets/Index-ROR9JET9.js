import{_ as se}from"./NotificationRing-DE0KXlbh.js";import{_ as ae}from"./FilterDropdown-BCKZL43N.js";import{_ as oe}from"./Paginate-Cpv8cjFG.js";import{_ as le}from"./NoDataFound-BMo6R2xy.js";import{u as te,T as re,q as R,p as ne,l as v,o as d,w as x,d as e,e as de,Z as X,c,g as y,f as g,t as a,h as n,j as f,v as k,F as w,i as C,b as i,_ as ie,s as ce,r as ue,a as ee,n as h,k as me}from"./app-BYM_31EU.js";import{_ as _e}from"./SpinnerBtn-AUjirXqh.js";import{_ as ge}from"./UserLayout-Br6IHeZb.js";import"./echoServiceComposable-Bzp0fI07.js";import"./ValidationErrors-MJY6JPWK.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ToastrContainer-Bkk7kk5A.js";import"./AssetModal-CWaGrucV.js";import"./assetStore-CRTuDG_T.js";const pe={class:"mb-2"},be={for:"name",class:"label"},ye={key:0,class:"mb-2"},he={for:"access_token",class:"label"},xe={class:"mb-2"},fe={value:!0},ke={value:!1},ve={key:1,class:"mb-2"},we=["value"],$e={key:2,class:"mb-2"},Se=["value"],Re={class:"mb-2"},Ce={value:!0},Me={value:!1},Ve={key:0,class:"mt-2"},Ue={class:"mb-2"},Ne={for:"webhook_callback_url",class:"label"},je={class:"text-gray-600 dark:text-gray-400"},Ae={class:"mt-2 text-end"},De={__name:"PlatformSettingModal",props:{platform:{type:Object,required:!0},autoReplyServices:{type:Array,default:[]},hideFields:{type:Array,default:[]}},setup(m){const $=te(),u=m,s=re({module:u.platform.module,name:"",access_token:"",send_auto_reply:!1,auto_reply_method:"",auto_reply_method_name:"",auto_reply_dataset:"",auto_reply_dataset_name:"",send_welcome_message:!1,welcome_message_template:"",webhook_callback_url:""});R(()=>u.platform.id,()=>{var o;if((o=u.platform)!=null&&o.uuid){let t=u.platform.meta??{};s.name=u.platform.name,s.access_token=u.platform.access_token,s.send_auto_reply=t.send_auto_reply,s.auto_reply_method=t.auto_reply_method,s.auto_reply_method_name=t.auto_reply_method_name,s.auto_reply_dataset=t.auto_reply_dataset,s.auto_reply_dataset_name=t.auto_reply_dataset_name,s.send_welcome_message=t.send_welcome_message,s.welcome_message_template=t.welcome_message_template,s.webhook_callback_url=t.webhook_callback_url||""}}),R(()=>s.auto_reply_dataset,()=>{var t;let o=(t=b.value.datasets)==null?void 0:t.find(r=>r.id===s.auto_reply_dataset);s.auto_reply_dataset_name=(o==null?void 0:o.title)??(o==null?void 0:o.name)??"NA"}),R(()=>s.auto_reply_method,()=>{s.auto_reply_method_name=b.value.title||"NA",b.value.module==="default"&&(s.auto_reply_dataset="")});const p=()=>{s.put(route(`user.${u.platform.module}.platforms.update`,u.platform.uuid),{onSuccess:()=>{$.close("platformSettingModal")}})},b=ne(()=>u.autoReplyServices.find(o=>o.module===s.auto_reply_method)||{});return(o,t)=>(d(),v(ie,{"header-state":!0,"header-title":"Platform Setting",state:"platformSettingModal"},{default:x(()=>[e("form",{onSubmit:de(p,["prevent"])},[X(o.$slots,"top"),e("div",pe,[e("label",be,a(o.trans("Platform Name")),1),g(e("input",{type:"text",class:"input","onUpdate:modelValue":t[0]||(t[0]=r=>n(s).name=r)},null,512),[[f,n(s).name]])]),m.hideFields.includes("access_token")?y("",!0):(d(),c("div",ye,[e("label",he,a(o.trans("Access Token")),1),g(e("input",{type:"text",class:"input","onUpdate:modelValue":t[1]||(t[1]=r=>n(s).access_token=r)},null,512),[[f,n(s).access_token]])])),e("div",xe,[e("label",null,a(o.trans("Send auto reply")),1),g(e("select",{class:"select","onUpdate:modelValue":t[2]||(t[2]=r=>n(s).send_auto_reply=r)},[e("option",fe,a(o.trans("Yes")),1),e("option",ke,a(o.trans("No")),1)],512),[[k,n(s).send_auto_reply]]),e("small",null,a(o.trans("Enable or disable auto reply")),1)]),n(s).send_auto_reply==!0?(d(),c("div",ve,[e("label",null,a(o.trans("Auto Reply Service")),1),g(e("select",{class:"select","onUpdate:modelValue":t[3]||(t[3]=r=>n(s).auto_reply_method=r)},[(d(!0),c(w,null,C(m.autoReplyServices,r=>(d(),c("option",{value:r.module,key:r.module},a(r.title),9,we))),128))],512),[[k,n(s).auto_reply_method]]),e("small",null,a(o.trans("How message will be replied")),1)])):y("",!0),b.value.has_datasets?(d(),c("div",$e,[e("label",null,a(o.trans("Auto Reply Using")),1),g(e("select",{class:"select","onUpdate:modelValue":t[4]||(t[4]=r=>n(s).auto_reply_dataset=r)},[(d(!0),c(w,null,C(b.value.datasets??[],r=>(d(),c("option",{value:r.id,key:r.id},a(r.title),9,Se))),128))],512),[[k,n(s).auto_reply_dataset]]),e("small",null,a(o.trans("The auto reply dataset will be used")),1)])):y("",!0),e("div",Re,[e("label",null,a(o.trans("Send Welcome message")),1),g(e("select",{class:"select","onUpdate:modelValue":t[5]||(t[5]=r=>n(s).send_welcome_message=r)},[e("option",Ce,a(o.trans("Yes")),1),e("option",Me,a(o.trans("No")),1)],512),[[k,n(s).send_welcome_message]]),n(s).send_welcome_message===!0?(d(),c("div",Ve,[g(e("textarea",{"onUpdate:modelValue":t[6]||(t[6]=r=>n(s).welcome_message_template=r),class:"input",rows:"5"},null,512),[[f,n(s).welcome_message_template]]),e("small",null,a(o.trans("This message will be sent to new users")),1)])):y("",!0)]),e("div",Ue,[e("label",Ne,a(o.trans("External Webhook URL")),1),g(e("input",{type:"url",class:"input","onUpdate:modelValue":t[7]||(t[7]=r=>n(s).webhook_callback_url=r),placeholder:"https://your-domain.com/webhook"},null,512),[[f,n(s).webhook_callback_url]]),e("small",je,a(o.trans("Forward incoming messages to this external webhook URL (optional)")),1)]),X(o.$slots,"default"),e("div",Ae,[i(_e,{classes:"btn btn-primary",processing:n(s).processing,"btn-text":o.trans("Submit")},null,8,["processing","btn-text"])])],32)]),_:3}))}},Le={class:"mt-4 flex w-full flex-col gap-4"},Te={key:0,class:"grid grid-cols-1 gap-4 xl:grid-cols-2 2xl:grid-cols-3"},Ee={class:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between"},Pe={class:"flex items-center gap-3 sm:gap-4"},We={class:"relative flex h-12 w-12 shrink-0 items-center justify-center overflow-hidden rounded-xl bg-gradient-to-br from-green-600 to-green-500 shadow-sm transition-transform duration-200 group-hover:scale-105 sm:h-16 sm:w-16"},qe=["src"],Be={class:"flex min-w-0 flex-col"},Fe={class:"truncate text-base font-semibold capitalize text-gray-900 dark:text-gray-100 sm:text-lg"},Ie={class:"flex flex-wrap gap-2 text-gray-500 dark:text-gray-400"},Oe=["onClick"],ze=["onClick"],Ye={class:"mt-4 grid grid-cols-2 gap-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-3"},He={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},Qe={class:"mb-1 text-xs font-medium text-gray-500"},Ze={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},Ge={class:"mb-1 text-xs font-medium text-gray-500"},Je={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},Ke={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},Xe={class:"mb-1 text-xs font-medium text-gray-500"},et={class:"truncate text-sm font-semibold text-gray-900 dark:text-gray-100"},tt={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},st={class:"mb-1 text-xs font-medium text-gray-500"},at={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},ot={class:"mb-1 text-xs font-medium text-gray-500"},lt={class:"truncate text-xs font-semibold text-gray-900 dark:text-gray-100"},rt={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},nt={class:"mb-1 text-xs font-medium text-gray-500"},dt={class:"truncate text-xs font-semibold text-gray-900 dark:text-gray-100"},it={class:"flex flex-col rounded-lg bg-gray-50 p-3 dark:bg-gray-800/50"},ct={class:"mb-1 text-xs font-medium text-gray-500"},ut={key:0,class:"mt-2 rounded-lg bg-blue-50 p-3 dark:bg-blue-900/20"},mt={class:"flex items-start gap-2"},_t={class:"flex flex-col flex-1 min-w-0"},gt={class:"text-xs font-medium text-blue-700 dark:text-blue-400"},pt=["title"],bt={key:1,class:"mt-2 rounded-lg bg-purple-50 p-3 dark:bg-purple-900/20"},yt={class:"flex items-start gap-2"},ht={class:"flex flex-col"},xt={class:"text-xs font-medium text-purple-700 dark:text-purple-400"},ft={class:"text-sm text-purple-900 dark:text-purple-100"},kt={class:"w-full"},vt={class:"mb-2"},wt={for:"webhook",class:"label"},$t={class:"flex gap-1"},St=["value"],Rt={class:"mb-2"},Ct={for:"verify_token",class:"label"},Mt=["value"],It=Object.assign({layout:ge},{__name:"Index",props:["platforms","autoReplyServices"],setup(m){const $=te(),{deleteRow:u,textExcerpt:s}=ce(),p=ue({}),b=t=>{p.value=t,$.open("platformSettingModal")},o=[{label:"Name",value:"name"},{label:"Status",value:"status"}];return(t,r)=>{var M,V,U;const _=ee("Icon"),S=ee("Link");return d(),c(w,null,[i(se),i(ae,{options:o}),e("div",Le,[m.platforms&&((M=m.platforms)!=null&&M.data.length)?(d(),c("div",Te,[(d(!0),c(w,null,C(m.platforms.data,(l,N)=>{var j,A,D,L,T,E,P,W,q,B,F,I,O,z,Y,H,Q,Z,G,J,K;return d(),c("div",{key:N,class:"card card-body group flex flex-col gap-3 rounded-2xl border border-gray-100 bg-white p-4 shadow-sm transition-all duration-200 hover:shadow-md dark:border-gray-800 dark:bg-gray-900"},[e("div",Ee,[e("div",Pe,[e("div",We,[l.picture?(d(),c("img",{key:0,src:l.picture,alt:"",class:"h-full w-full object-cover"},null,8,qe)):(d(),v(_,{key:1,icon:"bxl:whatsapp",class:"text-3xl text-white sm:text-4xl"}))]),e("div",Be,[e("h4",Fe,a(((j=l.meta)==null?void 0:j.name)||n(s)(l.name,20)),1),e("span",{class:h(["mt-1 inline-flex w-fit items-center rounded-full px-2 py-px text-xs lowercase",{"bg-emerald-100 text-emerald-700":(A=l.meta)==null?void 0:A.webhook_connected,"bg-red-100 text-red-700":!((D=l.meta)!=null&&D.webhook_connected)}])},[e("span",{class:h(["mr-1 mt-0.5 h-2 w-2 rounded-full",{"bg-emerald-500":(L=l.meta)==null?void 0:L.webhook_connected,"bg-red-500":!((T=l.meta)!=null&&T.webhook_connected)}])},null,2),me(" "+a((E=l.meta)!=null&&E.webhook_connected?"Connected":"Disconnected"),1)],2)])]),e("div",Ie,[i(S,{class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2 text-gray-700 transition-colors hover:bg-gray-100 hover:text-blue-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-blue-400 sm:p-2.5",href:t.route("user.whatsapp.platforms.show",l.uuid),title:"View Messages"},{default:x(()=>[i(_,{icon:"bx:message-square-dots",class:"sm:text-lg"})]),_:2},1032,["href"]),i(S,{title:"QR Codes",class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2 text-gray-700 transition-colors hover:bg-gray-100 hover:text-indigo-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-indigo-400 sm:p-2.5",href:t.route("user.whatsapp.qr-codes.index",l.uuid)},{default:x(()=>[i(_,{icon:"bx:qr",class:"sm:text-lg"})]),_:2},1032,["href"]),i(S,{title:"Message Logs",class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2 text-gray-700 transition-colors hover:bg-gray-100 hover:text-indigo-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-indigo-400 sm:p-2.5",href:t.route("user.whatsapp.platforms.logs",l.uuid)},{default:x(()=>[i(_,{icon:"bx:detail",class:"sm:text-lg"})]),_:2},1032,["href"]),e("button",{class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2 text-gray-700 transition-colors hover:bg-gray-100 hover:text-emerald-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-gray-700 dark:hover:text-emerald-400 sm:p-2.5",onClick:()=>b(l),title:"Settings"},[i(_,{icon:"bx:cog",class:"sm:text-lg"})],8,Oe),e("button",{title:"Delete Platform",type:"button",onClick:Vt=>n(u)(t.route("user.whatsapp.platforms.destroy",l)),class:"inline-flex items-center justify-center rounded-lg bg-gray-50 p-2 text-gray-700 transition-colors hover:bg-red-50 hover:text-red-600 dark:bg-gray-800 dark:text-gray-300 dark:hover:bg-red-900/20 dark:hover:text-red-400 sm:p-2.5"},[i(_,{icon:"bx:trash",class:"sm:text-lg"})],8,ze)])]),e("div",Ye,[e("div",He,[e("span",Qe,a(t.trans("Auto Reply")),1),e("span",{class:h(["text-sm font-semibold",(P=l.meta)!=null&&P.send_auto_reply?"text-emerald-600":"text-red-600"])},a((W=l.meta)!=null&&W.send_auto_reply?"Enabled":"Disabled"),3)]),e("div",Ze,[e("span",Ge,a(t.trans("Reply Method")),1),e("span",Je,a((q=l.meta)==null?void 0:q.auto_reply_method),1)]),e("div",Ke,[e("span",Xe,a(t.trans("Dataset")),1),e("span",et,a(n(s)((B=l.meta)==null?void 0:B.auto_reply_dataset_name,15)),1)]),e("div",tt,[e("span",st,a(t.trans("Welcome Message")),1),e("span",{class:h(["text-sm font-semibold",(F=l.meta)!=null&&F.send_welcome_message?"text-emerald-600":"text-red-600"])},a((I=l.meta)!=null&&I.send_welcome_message?"Enabled":"Disabled"),3)]),e("div",at,[e("span",ot,a(t.trans("Phone Number ID")),1),e("span",lt,a((O=l.meta)==null?void 0:O.phone_number_id),1)]),e("div",rt,[e("span",nt,a(t.trans("WABA ID")),1),e("span",dt,a((z=l.meta)==null?void 0:z.business_account_id),1)]),e("div",it,[e("span",ct,a(t.trans("External Webhook")),1),e("span",{class:h(["text-sm font-semibold",(Y=l.meta)!=null&&Y.webhook_callback_url?"text-emerald-600":"text-gray-400"])},a((H=l.meta)!=null&&H.webhook_callback_url?t.trans("Configured"):t.trans("Not Set")),3)])]),(Q=l.meta)!=null&&Q.webhook_callback_url?(d(),c("div",ut,[e("div",mt,[i(_,{icon:"bx:cloud-upload",class:"mt-0.5 text-lg text-blue-500"}),e("div",_t,[e("span",gt,a(t.trans("Webhook URL")),1),e("span",{class:"text-xs text-blue-900 dark:text-blue-100 truncate",title:(Z=l.meta)==null?void 0:Z.webhook_callback_url},a((G=l.meta)==null?void 0:G.webhook_callback_url),9,pt)])])])):y("",!0),(J=l.meta)!=null&&J.send_welcome_message?(d(),c("div",bt,[e("div",yt,[i(_,{icon:"bx:message-rounded-dots",class:"mt-0.5 text-lg text-purple-500"}),e("div",ht,[e("span",xt,a(t.trans("Welcome Message")),1),e("span",ft,a((K=l.meta)==null?void 0:K.welcome_message_template),1)])])])):y("",!0)])}),128))])):(d(),v(le,{key:1})),e("div",kt,[(U=(V=m.platforms)==null?void 0:V.data)!=null&&U.length?(d(),v(oe,{key:0,links:m.platforms.links},null,8,["links"])):y("",!0)])]),i(De,{platform:p.value,autoReplyServices:m.autoReplyServices},{top:x(()=>{var l;return[e("div",vt,[e("label",wt,a(t.trans("Callback URL (read-only)")),1),e("div",$t,[e("input",{type:"text",class:"input",disabled:"",value:p.value.webhook_url},null,8,St),e("button",{type:"button",class:"btn btn-secondary",onClick:r[0]||(r[0]=N=>t.copyToClipboard(p.value.webhook_url))},[i(_,{icon:"bx:copy",class:"text-xl"})])])]),e("div",Rt,[e("label",Ct,a(t.trans("Verify Token (read-only)")),1),e("input",{type:"text",class:"input",value:(l=p.value.meta)==null?void 0:l.phone_number_id,disabled:""},null,8,Mt)])]}),_:1},8,["platform","autoReplyServices"])],64)}}});export{It as default};
