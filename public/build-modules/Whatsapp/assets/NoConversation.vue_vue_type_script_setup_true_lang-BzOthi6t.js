const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MessagePreview-LrLBvRmp.js","assets/app-BYM_31EU.js","assets/app-D5HAdpT2.css","assets/dynamic-import-helper-BheWnx7M.js"])))=>i.map(i=>d[i]);
import{_ as Vt}from"./UserLayout-Br6IHeZb.js";import{P as wt,u as je,Y as xt,Q as qe,J as Ge,s as at,r as ve,m as st,a as ze,c as R,o as v,d as n,g as G,f as me,v as kt,h as t,t as L,F as he,i as Ee,e as Pe,b as P,j as Te,n as Ae,w as Ne,l as te,$ as qt,Z as Rt,a1 as Nt,a2 as zt,p as et,a3 as Wt,V as Gt,q as Ht,H as Qt,k as He,B as Ct,T as Qe,a4 as ee,A as Yt,W as Kt,M as _t,C as Jt,a5 as Oe,a6 as Xt,N as St,_ as Ze,L as Zt,a7 as er,I as Re,R as tr,a8 as rr}from"./app-BYM_31EU.js";import{H as or,a as Mt,b as We,_ as ir}from"./AssetModal-CWaGrucV.js";import{_ as Tt}from"./dynamic-import-helper-BheWnx7M.js";import{h as nt}from"./moment-BAtM24Ew.js";import{D as Lt}from"./DotLoader-DEyxUd3d.js";import{u as nr}from"./assetStore-CRTuDG_T.js";import{_ as it}from"./SpinnerBtn-AUjirXqh.js";import{_ as ft}from"./MultiSelect-DLW6ou6k.js";import{_ as ar}from"./NoDataFound-BMo6R2xy.js";import{_ as sr}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{e as lr}from"./echoServiceComposable-Bzp0fI07.js";const Ie=wt("chatStore",{state:()=>({features:{voice_message:!0},platform:null,leftSidebar:{isOpen:!0},searchedConversationList:[],conversations:[],chatTemplates:[],quickReplies:[],aiTemplates:[],badges:[],activeConversationId:null,rightSidebar:{isOpen:!1},assetPopup:!1,messageInputFieldRef:null,chatSearchInput:"",chatSearchInputRef:null,chatSearchedItems:[],replying:{},searchForm:{badge_id:null,customer_name:"",assigned_to:null},loading:{sendingMessage:!1,messages:!1,conversations:!1,searching:!1,message_searching:!1},inputMessage:{conversation_id:null,type:"text",message:"",caption:"",attachments:[],template:null,context:null},arrowCounter:0,quickReplySearchInput:"",quickReplySuggestionItemsShow:!1,quickReplyModalIsOpen:!1,quickReplyModalSearchInput:null}),getters:{filteredConversations(){return this.searchForm.customer_name.length>0||this.searchForm.badge_id||this.searchForm.assigned_to?this.searchedConversationList:this.conversations},hasConversations(){return this.conversations.length>0},hasActiveConversation(){return this.activeConversationId!==null},activeConversation(){return this.conversations.find(c=>c.id===this.activeConversationId)??{}},activeConversationMessages(){const c=this.activeConversation.messages??[];return c.length?c.slice().reverse():[]},isReplying(){return this.replying.message_id},getActiveModuleName(){var c,r;return(((c=this.activeConversation)==null?void 0:c.module)??"").charAt(0).toUpperCase()+(((r=this.activeConversation)==null?void 0:r.module)??"").slice(1)},quickReplyFilteredItems(){var d;let c=((d=this.activeConversation)==null?void 0:d.module)??"",r=this.quickReplies;return this.quickReplySearchInput.length>0&&(r=r.filter(g=>g.message_template.toLowerCase().includes(this.quickReplySearchInput.toLowerCase()))),r.filter(g=>g.module===c).map(g=>g.message_template)},quickReplySuggestionItems(){var d,g;let c=((d=this.activeConversation)==null?void 0:d.module)??"",r=[];return((g=this.inputMessage.message)==null?void 0:g.length)>0&&(r=this.quickReplies.filter(l=>{var _;return l.message_template.toLowerCase().includes((_=this.inputMessage.message)==null?void 0:_.toLowerCase())})),r.filter(l=>l.module===c).map(l=>l.message_template)},getActiveModuleTemplates(){return this.chatTemplates.filter(c=>c.module==this.activeConversation.module)}},actions:{downloadAttachment(c,r){qe.post(route("user.messages.download-attachment",c),r).then(d=>{console.log(d)})},getBadge(c){return this.badges.find(r=>r.id===c)??null},async getChatSearchedItems(){var c,r;if(this.chatSearchInput.length===0){this.chatSearchedItems=[];return}try{this.loading.message_searching=!0;const d=await qe.get(route("user.conversations.api","messages"),{params:{module:(c=this.platform)==null?void 0:c.module,conversation_id:this.activeConversationId,search:this.chatSearchInput}});this.chatSearchedItems=((r=d.data)==null?void 0:r.data)??[]}catch(d){console.error(d)}finally{this.loading.message_searching=!1}},setActiveConversation(c){this.activeConversationId=c,this.activeConversation.unread_count=0},toggleRightSidebar(){this.rightSidebar.isOpen=!this.rightSidebar.isOpen},scrollToLastMessage(c="smooth"){setTimeout(()=>{let r=document.querySelector("#scrollContainerRef");r&&r.scrollIntoView({block:"end",behavior:c})},300)},setReplying(c){var r,d;this.replying={message_id:c.uuid,message:((r=c.body)==null?void 0:r.text)??((d=c.body)==null?void 0:d.caption)??c.type??""}},unsetReplying(){this.replying={}},touchConversation(c){c.updated_at=new Date().toISOString()},shortConversations(){this.conversations.sort((c,r)=>new Date(r.updated_at)-new Date(c.updated_at))},loadMoreMessages(c){var r;console.log("loading more messages"),!this.loading.messages&&(this.loading.messages=!0,qe.get(route("user.conversations.api","load_more_messages"),{params:{module:(r=this.platform)==null?void 0:r.module,conversation_id:c??this.activeConversationId,limit:10,last_message_id:c?0:this.activeConversationMessages[0].id}}).then(d=>{let g=!1;if(d.data.length===0){if(g=!0,g){let l=this.conversations.find(_=>_.id==this.activeConversationId);l&&(l.no_more_messages=!0)}return}this.conversations=this.conversations.map(l=>(l.id==this.activeConversationId&&d.data.forEach((_,u)=>{l.messages.push(_)}),l))}).catch(d=>console.error(d)).finally(()=>{this.loading.messages=!1}))},loadMoreConversations(){var c;console.log("load more conversations"),!this.loading.conversations&&(this.loading.conversations=!0,qe.get(route("user.conversations.api","load_more_conversations"),{params:{module:(c=this.platform)==null?void 0:c.module,limit:10,last_conversation_id:this.conversations.length>0?this.conversations[0].id:null}}).then(r=>{if(r.data.length===0){console.log("no more conversations");return}let d=[];r.data.forEach(g=>{d.find(l=>l.id==g.id)||d.push(g)})}).catch(r=>console.error(r)).finally(()=>this.loading.conversations=!1))},async loadBadges(){try{const c=await qe.get(route("user.conversations.api","badges"));this.badges=c.data}catch(c){console.error(c)}},async submitMessage(){var r,d,g,l;let c={conversation_id:this.activeConversationId??null,reply_message_uuid:((r=this.replying)==null?void 0:r.message_id)??null,type:this.inputMessage.type??"text",text:this.inputMessage.message??null,caption:this.inputMessage.caption??null,template:this.inputMessage.template??null,attachments:this.inputMessage.attachments??[]};try{this.loading.sendingMessage=!0;const _=await qe.post(route("user.messages.store"),c,{headers:{"Content-Type":"multipart/form-data"}});this.conversations=this.conversations.map(u=>(u.id==this.activeConversationId&&u.messages.unshift(_.data),u)),this.resetInputMessage(),(d=this.messageInputFieldRef)==null||d.focus(),this.unsetReplying(),this.touchConversation(this.activeConversation),this.shortConversations()}catch(_){Ge.danger(((l=(g=_.response)==null?void 0:g.data)==null?void 0:l.message)||_.message||"Something went wrong!"),console.error(_)}finally{this.closeTemplateModal(),this.loading.sendingMessage=!1,this.assetPopup=!1,this.scrollToLastMessage()}},resetInputMessage(){this.inputMessage={conversation_id:null,type:"text",message:"",caption:"",template:null,attachments:[]}},closeTemplateModal(){je().close("templateModal")},onArrowDown(c){this.quickReplyModalIsOpen&&this.arrowCounter<this.quickReplyFilteredItems.length-1?this.arrowCounter=this.arrowCounter+1:this.arrowCounter<this.quickReplyFilteredItems.length-1&&(this.arrowCounter=this.arrowCounter+1)},onArrowUp(c){this.arrowCounter>0&&(this.arrowCounter=this.arrowCounter-1)},async addQuickReplyToMessageInput(c){const r=document.getElementById("inputMessageField");r.blur(),this.quickReplyModalClose(),this.inputMessage.message=this.replaceTextWithShortCodes(c)+" ",await xt(),r.focus()},replaceTextWithShortCodes(c){var d,g,l,_;let r={name:(d=this.activeConversation.customer)==null?void 0:d.name,phone:(g=this.activeConversation.customer)==null?void 0:g.uuid,username:(_=(l=this.activeConversation.customer)==null?void 0:l.meta)==null?void 0:_.username};return(c==null?void 0:c.replace(/\{([a-z_]+)\}/g,(u,Q)=>r.hasOwnProperty(Q)?r[Q]:u))??c},quickReplyModalOpen(){je().open("quickReplyModal"),this.quickReplyModalIsOpen=!0},quickReplyModalClose(){je().close("quickReplyModal"),this.quickReplyModalIsOpen=!1},selectQuickReply(c){let r="";this.quickReplyModalIsOpen?r=this.quickReplyFilteredItems[this.arrowCounter]:r=this.quickReplyFilteredItems[this.arrowCounter],this.addQuickReplyToMessageInput(r),this.arrowCounter=-1},connectWebSocket(c){var r;(r=lr.connect())==null||r.private(c).subscribed(()=>console.log("Live chat activated successfully")).listen("IncomingNewMessageEvent",this.handleIncomingMessages).listen("IncomingMessageUpdateEvent",this.handleIncomingMessageUpdates).listen("IncomingNewConversationEvent",this.handleIncomingConversations).error(d=>console.error(d))},disconnectWebSocket(){},handleIncomingMessages(c){console.log("new message received",c),this.conversations.forEach(r=>{if(r.id===(c==null?void 0:c.conversation_id)){if(r.messages.find(g=>g.id===c.id))return console.log("message already exists");console.log("pushing new message"),r.messages.unshift(c),this.touchConversation(r),this.shortConversations(),r.unread_count+=1,this.playSound()}else console.log("conversation not found")}),this.scrollToLastMessage()},handleIncomingMessageUpdates(c){console.log("message update"),this.conversations.forEach(r=>{r.id==c.conversation_id&&r.messages.forEach(d=>{d.id==c.id&&(d.status=c.status)})})},handleIncomingConversations(c){var r;console.log("new conversation received"),this.conversations.value=this.conversations.unshift(c),this.loadMoreMessages(c.id),c.unread_count=((r=c.messages)==null?void 0:r.length)??1},playSound(){new Audio("/assets/incoming-message-beep.mp3").play()},toggleLeftSidebar(){this.leftSidebar.isOpen=!this.leftSidebar.isOpen}}}),dr={class:"relative mb-3"},ur={class:"mb-2 flex items-center gap-2 text-nowrap"},cr={value:""},fr=["value"],pr={class:"flex h-full items-center px-3"},mr={class:"styled-scrollbar h-[88%] overflow-y-auto"},hr={class:"avatar avatar-circle shrink-0"},vr=["src"],gr={class:"absolute -right-2 bottom-0 rounded-full bg-white p-1"},br={class:"ml-4 mr-2 flex-grow overflow-x-hidden"},yr={class:"truncate text-xs font-normal text-gray-500"},wr={class:"flex flex-col items-end"},xr={key:0,class:"flex h-5 w-5 items-center justify-center rounded-full bg-danger-500 text-xs font-normal text-white"},kr={key:0},Rr={key:1,class:"text-center text-sm text-slate-400"},Cr={class:"py-1"},_r={__name:"LeftSidebar",props:{conversations:{type:Array,default:[]}},setup(c){const r=je(),{debounce:d,pickBy:g}=at(),l=Ie(),_=ve(null);ve(null),st(()=>{let j=new URLSearchParams(window.location.search);l.searchForm.badge_id=j.get("badge_id")||"",l.searchForm.customer_name=j.get("customer_name")||""});const u=d(()=>{var O;l.loading.searching=!0,l.searchedConversationList=[];let j=g({data:"conversations",module:(O=l.platform)==null?void 0:O.module,...l.searchForm});axios.get(route("user.conversations.api",j)).then(y=>{l.searchedConversationList=y.data??[]}).finally(()=>l.loading.searching=!1)},300),Q=j=>{let O=String(qt().props.activeModule).toLowerCase();return O&&!["user","admin","livechat"].includes(O)?`/user/${O}/platforms/${l.platform.uuid}/conversations/${j.id}`:`/user/livechat/conversations/${j.id}`};return(j,O)=>{const y=ze("Icon"),B=ze("Link");return v(),R(he,null,[n("div",{class:Ae(["absolute z-30 h-[calc(100vh-11rem)] w-3/4 rounded-md bg-white p-3 transition-all duration-300 dark:bg-dark-800 sm:w-72 xl:relative xl:w-3/12",[t(l).leftSidebar.isOpen?"translate-x-0":"translate-x-[-110%]","xl:translate-x-0"]])},[n("div",dr,[n("div",ur,[me(n("select",{class:"select","onUpdate:modelValue":O[0]||(O[0]=x=>t(l).searchForm.badge_id=x),onChange:O[1]||(O[1]=(...x)=>t(u)&&t(u)(...x))},[n("option",cr,L(j.trans("Filter by badge")),1),(v(!0),R(he,null,Ee(t(l).badges,x=>(v(),R("option",{value:x.id,key:x.id},L(x.text),9,fr))),128))],544),[[kt,t(l).searchForm.badge_id]]),n("button",{class:"btn btn-primary",onClick:O[2]||(O[2]=x=>t(r).open("badgeModal"))},"+")]),n("form",{onSubmit:O[5]||(O[5]=Pe((...x)=>t(u)&&t(u)(...x),["prevent"])),class:"group flex h-10 w-full items-center overflow-hidden rounded-primary border border-transparent bg-slate-100 shadow-sm focus-within:border-primary-500 focus-within:ring-1 focus-within:ring-primary-500 dark:border-transparent dark:bg-dark-900 dark:focus-within:border-primary-500"},[O[8]||(O[8]=n("div",{class:"mb-2"},null,-1)),n("div",pr,[P(y,{icon:"fe:search",class:"text-lg text-slate-400 group-focus-within:text-primary-500"})]),me(n("input",{class:"h-full w-full border-transparent bg-transparent px-0 text-sm placeholder-slate-400 placeholder:text-sm focus:border-transparent focus:outline-none focus:ring-0",type:"text","onUpdate:modelValue":O[3]||(O[3]=x=>t(l).searchForm.customer_name=x),onKeyup:O[4]||(O[4]=(...x)=>t(u)&&t(u)(...x)),placeholder:"Search"},null,544),[[Te,t(l).searchForm.customer_name]])],32),t(l).leftSidebar.isOpen?(v(),R("button",{key:0,id:"chat-btn-hide-sidebar",type:"button",onClick:O[6]||(O[6]=(...x)=>t(l).toggleLeftSidebar&&t(l).toggleLeftSidebar(...x)),class:"absolute left-full top-1 z-20 inline-flex h-8 w-8 translate-x-4 items-center justify-center rounded-full bg-black/60 text-white dark:text-slate-300 xl:hidden"},[P(y,{icon:"fe:close"})])):G("",!0)]),n("div",mr,[n("ul",{id:"chat-list",ref_key:"scrollContainerRef",ref:_},[(v(!0),R(he,null,Ee(t(l).filteredConversations,x=>(v(),R("li",{class:Ae(["group",{active:t(l).activeConversationId==x.id}]),key:x.id},[P(B,{href:Q(x),class:"inline-flex w-full items-start justify-between rounded-md bg-transparent px-3 py-3 transition-colors duration-150 hover:bg-slate-100 group-[.active]:bg-slate-100 dark:hover:bg-slate-900/80 group-[.active]:dark:bg-dark-900"},{default:Ne(()=>{var H,W,A,U,N,ie,Z,X;return[n("div",hr,[(H=x.customer)!=null&&H.picture?(v(),R("img",{key:0,class:"avatar-img relative",src:(W=x.customer)==null?void 0:W.picture},null,8,vr)):G("",!0),n("div",gr,[P(y,{icon:`ri:${x.module}-fill`,class:Ae({"text-blue-700":x.module=="messenger","text-green-500":x.module=="whatsapp","text-blue-600":x.module=="telegram"})},null,8,["icon","class"])])]),n("div",br,[n("p",{class:Ae(["whitespace-nowrap text-sm text-slate-800 dark:text-slate-100",[x.unread_count>0?"font-bold":"font-medium"]])},L((A=x.customer)==null?void 0:A.name),3),n("span",yr,L(((ie=(N=(U=x.messages)==null?void 0:U[0])==null?void 0:N.body)==null?void 0:ie.text)??((X=(Z=x.messages)==null?void 0:Z[0])==null?void 0:X.type)??"no messages yet"),1)]),n("div",wr,[x.unread_count>0?(v(),R("span",xr,L(x.unread_count??""),1)):G("",!0)])]}),_:2},1032,["href"])],2))),128)),t(l).filteredConversations||t(l).searchForm.customer_name.length>0||t(l).searchForm.badge_id>0?(v(),R("li",kr,[t(l).loading.searching?(v(),te(or,{key:0,class:"mx-auto"})):t(l).filteredConversations.length==0?(v(),R("div",Rr,L(j.trans("No results found")),1)):G("",!0)])):G("",!0),n("li",Cr,[P(Mt,{afterIntersection:()=>t(l).loadMoreConversations(),loader:t(l).loading.conversations},null,8,["afterIntersection","loader"])])],512)])],2),t(l).leftSidebar.isOpen?(v(),R("div",{key:0,onClick:O[7]||(O[7]=(...x)=>t(l).toggleLeftSidebar&&t(l).toggleLeftSidebar(...x)),class:"absolute bottom-0 left-0 right-0 top-0 z-10 h-full w-full bg-black/20 transition-colors duration-300 ease-in-out xl:hidden"})):G("",!0)],64)}}},Sr={class:"relative flex h-[calc(100vh-110px)] w-full gap-x-3 overflow-hidden"},jn=Object.assign({layout:Vt},{__name:"ChatLayout",setup(c){return(r,d)=>(v(),R("div",Sr,[P(_r),Rt(r.$slots,"default")]))}});function Mr(c){return Nt()?(zt(c),!0):!1}function mt(c){return typeof c=="function"?c():t(c)}const Tr=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;function Lr(c,r){var d;if(typeof c=="number")return c+r;const g=((d=c.match(/^-?\d+\.?\d*/))==null?void 0:d[0])||"",l=c.slice(g.length),_=Number.parseFloat(g)+r;return Number.isNaN(_)?c:_+l}const $t=Tr?window:void 0;function $r(){const c=ve(!1),r=Gt();return r&&st(()=>{c.value=!0},r),c}function Ar(c){const r=$r();return et(()=>(r.value,!!c()))}function Xe(c,r={}){const{window:d=$t}=r,g=Ar(()=>d&&"matchMedia"in d&&typeof d.matchMedia=="function");let l;const _=ve(!1),u=O=>{_.value=O.matches},Q=()=>{l&&("removeEventListener"in l?l.removeEventListener("change",u):l.removeListener(u))},j=Wt(()=>{g.value&&(Q(),l=d.matchMedia(mt(c)),"addEventListener"in l?l.addEventListener("change",u):l.addListener(u),_.value=l.matches)});return Mr(()=>{j(),Q(),l=void 0}),_}const Ir={sm:640,md:768,lg:1024,xl:1280,"2xl":1536};function Dr(c,r={}){function d(y,B){let x=mt(c[mt(y)]);return B!=null&&(x=Lr(x,B)),typeof x=="number"&&(x=`${x}px`),x}const{window:g=$t,strategy:l="min-width"}=r;function _(y){return g?g.matchMedia(y).matches:!1}const u=y=>Xe(()=>`(min-width: ${d(y)})`,r),Q=y=>Xe(()=>`(max-width: ${d(y)})`,r),j=Object.keys(c).reduce((y,B)=>(Object.defineProperty(y,B,{get:()=>l==="min-width"?u(B):Q(B),enumerable:!0,configurable:!0}),y),{});function O(){const y=Object.keys(c).map(B=>[B,u(B)]);return et(()=>y.filter(([,B])=>B.value).map(([B])=>B))}return Object.assign(j,{greaterOrEqual:u,smallerOrEqual:Q,greater(y){return Xe(()=>`(min-width: ${d(y,.1)})`,r)},smaller(y){return Xe(()=>`(max-width: ${d(y,-.1)})`,r)},between(y,B){return Xe(()=>`(min-width: ${d(y)}) and (max-width: ${d(B,-.1)})`,r)},isGreater(y){return _(`(min-width: ${d(y,.1)})`)},isGreaterOrEqual(y){return _(`(min-width: ${d(y)})`)},isSmaller(y){return _(`(max-width: ${d(y,-.1)})`)},isSmallerOrEqual(y){return _(`(max-width: ${d(y)})`)},isInBetween(y,B){return _(`(min-width: ${d(y)}) and (max-width: ${d(B,-.1)})`)},current:O,active(){const y=O();return et(()=>y.value.length===0?"":y.value.at(-1))}})}const Br={class:"relative w-full"},Ur=["contenteditable","innerHTML"],Fr={key:0,class:"pointer-events-none absolute left-3 top-1/2 -translate-y-1/2 text-sm text-gray-400"},Or=Object.assign({inheritAttrs:!1},{__name:"CustomTextarea",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"Type your text here..."},disabled:{type:Boolean,default:!1},autofocus:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(c,{emit:r}){const d=c;st(()=>{d.autofocus&&l.value.focus()});const g=r,l=ve(null),_=ve(!1),u=ve(null),Q=et(()=>d.modelValue),j=()=>{const x=window.getSelection();if(!x.rangeCount)return null;const H=x.getRangeAt(0),W=H.cloneRange();return W.selectNodeContents(l.value),W.setEnd(H.endContainer,H.endOffset),W.toString().length},O=x=>{const H=window.getSelection(),W=document.createRange();let A=0,U=!1;function N(ie){if(!U)if(ie.nodeType===Node.TEXT_NODE){const Z=ie.textContent.length;if(A+Z>=x){W.setStart(ie,x-A),W.setEnd(ie,x-A),U=!0;return}A+=Z}else for(const Z of ie.childNodes)N(Z)}N(l.value),U&&(H.removeAllRanges(),H.addRange(W))},y=()=>{if(_.value)return;u.value=j();const x=l.value.innerText;g("update:modelValue",x)},B=x=>{if(x.key==="Backspace"){const H=j();u.value=H-1}else x.key==="Delete"&&(u.value=j())};return Ht(()=>d.modelValue,async()=>{l.value&&!_.value&&(_.value=!0,l.value.innerHTML=Q.value,await xt(),u.value!==null&&O(u.value),_.value=!1)}),(x,H)=>(v(),R("div",Br,[n("div",Qt({ref_key:"editableDiv",ref:l,contenteditable:!c.disabled,class:["input-content styled-scrollbar max-h-24 min-h-16 overflow-y-auto rounded p-3 focus:border-purple-500 focus:outline-none dark:text-dark-300",{"cursor-not-allowed ":c.disabled}],onInput:y,onKeydown:B,innerHTML:Q.value},x.$attrs),null,16,Ur),d.modelValue?G("",!0):(v(),R("div",Fr,L(c.placeholder),1))]))}}),Er={};function Pr(c,r){return L(c.trans("something_went_wrong"))}const At=sr(Er,[["render",Pr]]),jr={class:"flex items-center justify-between border-b border-b-slate-200 p-3 dark:border-b-dark-900"},Vr={class:"flex items-center justify-start gap-x-1 md:gap-x-3"},qr=["src"],Nr={class:"absolute -right-0 bottom-0 rounded-full bg-white p-0.5"},zr={class:"whitespace-nowrap text-xs font-medium text-slate-700 dark:text-slate-100 md:text-sm"},Wr={class:"truncate text-xs font-normal text-slate-500 dark:text-slate-400 md:text-sm"},Gr={class:"flex flex-wrap items-center gap-1"},Hr={for:"toggle-unchecked-input",class:"toggle"},Qr=["checked"],Yr={class:"label"},Kr={__name:"Header",setup(c){const r=Ie(),d=()=>{Qe({update_type:"auto_reply",module:r.activeConversation.module}).put(`/user/conversations/${r.activeConversationId}`)};return(g,l)=>{var u,Q,j,O,y,B;const _=ze("Icon");return v(),R("div",jr,[n("div",Vr,[n("button",{onClick:l[0]||(l[0]=(...x)=>t(r).toggleLeftSidebar&&t(r).toggleLeftSidebar(...x)),type:"button",class:"text-slate-500 hover:text-slate-700 focus:text-slate-700 dark:text-slate-400 dark:hover:text-slate-300 dark:focus:text-slate-300 xl:hidden"},[P(_,{icon:"bx:menu",class:"size-6"})]),n("button",{type:"button",class:"avatar avatar-circle",onClick:l[1]||(l[1]=(...x)=>t(r).toggleRightSidebar&&t(r).toggleRightSidebar(...x))},[(u=t(r).activeConversation.customer)!=null&&u.picture?(v(),R("img",{key:0,class:"avatar-img relative size-8",src:(Q=t(r).activeConversation.customer)==null?void 0:Q.picture},null,8,qr)):G("",!0),n("div",Nr,[t(r).activeConversation.module=="whatsapp"?(v(),te(_,{key:0,icon:"ri:whatsapp-fill",class:"size-4 text-green-600"})):G("",!0),t(r).activeConversation.module=="messenger"?(v(),te(_,{key:1,icon:"uil:facebook-messenger",class:"size-4 text-blue-700"})):G("",!0),t(r).activeConversation.module=="telegram"?(v(),te(_,{key:2,icon:"ri:telegram-fill",class:"size-4 text-blue-600"})):G("",!0),t(r).activeConversation.module=="instagram"?(v(),te(_,{key:3,icon:"ri:instagram-fill",class:"size-4 text-pink-600"})):G("",!0)])]),n("div",null,[n("h6",zr,[He(L((j=t(r).activeConversation.customer)==null?void 0:j.name)+" ",1),t(r).activeConversation.badge_id?(v(),R("span",{key:0,class:"rounded p-0 px-2 text-sm text-white",style:Ct({background:(O=t(r).getBadge(t(r).activeConversation.badge_id))==null?void 0:O.color})},L((y=t(r).getBadge(t(r).activeConversation.badge_id))==null?void 0:y.text),5)):G("",!0)]),n("p",Wr,L((B=t(r).activeConversation.customer)==null?void 0:B.uuid),1)])]),n("div",Gr,[n("label",Hr,[n("input",{onChange:d,class:"toggle-input peer sr-only",id:"toggle-unchecked-input",type:"checkbox",checked:t(r).activeConversation.auto_reply_enabled},null,40,Qr),l[3]||(l[3]=n("div",{class:"toggle-body"},null,-1)),n("span",Yr,L(g.trans("Auto Reply")),1)]),n("button",{class:"btn px-1 md:px-2",type:"button",onClick:l[2]||(l[2]=(...x)=>t(r).toggleRightSidebar&&t(r).toggleRightSidebar(...x))},[P(_,{icon:"bx:bxs-info-circle",class:"size-6 text-primary-500"})])])])}}},It={__name:"LoadingMessagePreview",props:["message"],setup(c){return(r,d)=>L(r.trans("Loading..."))}},Jr={class:"absolute -top-24 left-1 rounded-lg bg-white p-2 drop-shadow dark:bg-dark-900"},Xr=["onClick"],Zr={__name:"QuickReplyPreview",setup(c){const r=Ie();return(d,g)=>(v(),R("div",Jr,[(v(!0),R(he,null,Ee(t(r).quickReplySuggestionItems,(l,_)=>(v(),R("div",{key:_},[n("div",{class:Ae(["my-1 cursor-pointer rounded px-1.5 py-1 text-sm shadow-sm hover:bg-primary-100 dark:bg-dark-700 dark:hover:bg-opacity-80",{"bg-primary-200 dark:bg-primary-500":t(r).arrowCounter==_}]),onClick:u=>t(r).addQuickReplyToMessageInput(l)},L(l),11,Xr)]))),128))]))}},eo={class:"absolute -top-full mb-1 ms-1 w-4/5 rounded border bg-gray-50 p-2 dark:border-gray-500 dark:bg-dark-900"},to={class:"flex items-center justify-between"},ro={class:"text-sm text-gray-500"},oo={class:"text-sm font-semibold"},io={__name:"ReplyPreview",setup(c){const r=Ie();return(d,g)=>(v(),R("div",eo,[n("div",to,[n("div",null,[n("i",ro,L(d.trans("Replying"))+"...",1),n("p",oo,L(t(r).replying.message),1)]),n("button",{onClick:g[0]||(g[0]=(...l)=>t(r).unsetReplying&&t(r).unsetReplying(...l)),class:"rounded-lg border bg-white p-2 py-1 hover:bg-slate-400 dark:border-gray-500 dark:bg-dark-800 dark:hover:bg-dark-600"}," X ")])]))}};var pt={exports:{}},yt;function no(){return yt||(yt=1,function(c){/**
 * {@link https://github.com/muaz-khan/RecordRTC|RecordRTC} is a WebRTC JavaScript library for audio/video as well as screen activity recording. It supports Chrome, Firefox, Opera, Android, and Microsoft Edge. Platforms: Linux, Mac and Windows. 
 * @summary Record audio, video or screen inside the browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTC
 * @class
 * @example
 * var recorder = RecordRTC(mediaStream or [arrayOfMediaStream], {
 *     type: 'video', // audio or video or gif or canvas
 *     recorderType: MediaStreamRecorder || CanvasRecorder || StereoAudioRecorder || Etc
 * });
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, desiredSampRate: 16000, video: HTMLVideoElement, etc.}
 */function r(i,e){if(!i)throw"First parameter is required.";e=e||{type:"video"},e=new d(i,e);var o=this;function p(f){return e.disableLogs||console.log("RecordRTC version: ",o.version),f&&(e=new d(i,f)),e.disableLogs||console.log("started recording "+e.type+" stream."),C?(C.clearRecordedData(),C.record(),I("recording"),o.recordingDuration&&k(),o):(h(function(){o.recordingDuration&&k()}),o)}function h(f){f&&(e.initCallback=function(){f(),f=e.initCallback=null});var $=new g(i,e);C=new $(i,e),C.record(),I("recording"),e.disableLogs||console.log("Initialized recorderType:",C.constructor.name,"for output-type:",e.type)}function m(f){if(f=f||function(){},!C){T();return}if(o.state==="paused"){o.resumeRecording(),setTimeout(function(){m(f)},1);return}o.state!=="recording"&&!e.disableLogs&&console.warn('Recording state should be: "recording", however current state is: ',o.state),e.disableLogs||console.log("Stopped recording "+e.type+" stream."),e.type!=="gif"?C.stop($):(C.stop(),$()),I("stopped");function $(q){if(!C){typeof f.call=="function"?f.call(o,""):f("");return}Object.keys(C).forEach(function(F){typeof C[F]!="function"&&(o[F]=C[F])});var s=C.blob;if(!s)if(q)C.blob=s=q;else throw"Recording failed.";if(s&&!e.disableLogs&&console.log(s.type,"->",N(s.size)),f){var b;try{b=y.createObjectURL(s)}catch{}typeof f.call=="function"?f.call(o,b):f(b)}e.autoWriteToDisk&&D(function(F){var E={};E[e.type+"Blob"]=F,be.Store(E)})}}function w(){if(!C){T();return}if(o.state!=="recording"){e.disableLogs||console.warn("Unable to pause the recording. Recording state: ",o.state);return}I("paused"),C.pause(),e.disableLogs||console.log("Paused recording.")}function a(){if(!C){T();return}if(o.state!=="paused"){e.disableLogs||console.warn("Unable to resume the recording. Recording state: ",o.state);return}I("recording"),C.resume(),e.disableLogs||console.log("Resumed recording.")}function S(f){postMessage(new FileReaderSync().readAsDataURL(f))}function D(f,$){if(!f)throw"Pass a callback function over getDataURL.";var q=$?$.blob:(C||{}).blob;if(!q){e.disableLogs||console.warn("Blob encoder did not finish its job yet."),setTimeout(function(){D(f,$)},1e3);return}if(typeof Worker<"u"&&!navigator.mozGetUserMedia){var s=F(S);s.onmessage=function(E){f(E.data)},s.postMessage(q)}else{var b=new FileReader;b.readAsDataURL(q),b.onload=function(E){f(E.target.result)}}function F(E){try{var J=y.createObjectURL(new Blob([E.toString(),"this.onmessage =  function (eee) {"+E.name+"(eee.data);}"],{type:"application/javascript"})),Y=new Worker(J);return y.revokeObjectURL(J),Y}catch{}}}function k(f){if(f=f||0,o.state==="paused"){setTimeout(function(){k(f)},1e3);return}if(o.state!=="stopped"){if(f>=o.recordingDuration){m(o.onRecordingStopped);return}f+=1e3,setTimeout(function(){k(f)},1e3)}}function I(f){o&&(o.state=f,typeof o.onStateChanged.call=="function"?o.onStateChanged.call(o,f):o.onStateChanged(f))}var M='It seems that recorder is destroyed or "startRecording" is not invoked for '+e.type+" recorder.";function T(){e.disableLogs!==!0&&console.warn(M)}var C,z={startRecording:p,stopRecording:m,pauseRecording:w,resumeRecording:a,initRecorder:h,setRecordingDuration:function(f,$){if(typeof f>"u")throw"recordingDuration is required.";if(typeof f!="number")throw"recordingDuration must be a number.";return o.recordingDuration=f,o.onRecordingStopped=$||function(){},{onRecordingStopped:function(q){o.onRecordingStopped=q}}},clearRecordedData:function(){if(!C){T();return}C.clearRecordedData(),e.disableLogs||console.log("Cleared old recorded data.")},getBlob:function(){if(!C){T();return}return C.blob},getDataURL:D,toURL:function(){if(!C){T();return}return y.createObjectURL(C.blob)},getInternalRecorder:function(){return C},save:function(f){if(!C){T();return}ie(C.blob,f)},getFromDisk:function(f){if(!C){T();return}r.getFromDisk(e.type,f)},setAdvertisementArray:function(f){e.advertisement=[];for(var $=f.length,q=0;q<$;q++)e.advertisement.push({duration:q,image:f[q]})},blob:null,bufferSize:0,sampleRate:0,buffer:null,reset:function(){o.state==="recording"&&!e.disableLogs&&console.warn("Stop an active recorder."),C&&typeof C.clearRecordedData=="function"&&C.clearRecordedData(),C=null,I("inactive"),o.blob=null},onStateChanged:function(f){e.disableLogs||console.log("Recorder state changed:",f)},state:"inactive",getState:function(){return o.state},destroy:function(){var f=e.disableLogs;e={disableLogs:!0},o.reset(),I("destroyed"),z=o=null,fe.AudioContextConstructor&&(fe.AudioContextConstructor.close(),fe.AudioContextConstructor=null),e.disableLogs=f,e.disableLogs||console.log("RecordRTC is destroyed.")},version:"5.6.2"};if(!this)return o=z,z;for(var K in z)this[K]=z[K];return o=this,z}r.version="5.6.2",c.exports=r,r.getFromDisk=function(i,e){if(!e)throw"callback is mandatory.";console.log("Getting recorded "+(i==="all"?"blobs":i+" blob ")+" from disk!"),be.Fetch(function(o,p){i!=="all"&&p===i+"Blob"&&e&&e(o),i==="all"&&e&&e(o,p.replace("Blob",""))})},r.writeToDisk=function(i){console.log("Writing recorded blob(s) to disk!"),i=i||{},i.audio&&i.video&&i.gif?i.audio.getDataURL(function(e){i.video.getDataURL(function(o){i.gif.getDataURL(function(p){be.Store({audioBlob:e,videoBlob:o,gifBlob:p})})})}):i.audio&&i.video?i.audio.getDataURL(function(e){i.video.getDataURL(function(o){be.Store({audioBlob:e,videoBlob:o})})}):i.audio&&i.gif?i.audio.getDataURL(function(e){i.gif.getDataURL(function(o){be.Store({audioBlob:e,gifBlob:o})})}):i.video&&i.gif?i.video.getDataURL(function(e){i.gif.getDataURL(function(o){be.Store({videoBlob:e,gifBlob:o})})}):i.audio?i.audio.getDataURL(function(e){be.Store({audioBlob:e})}):i.video?i.video.getDataURL(function(e){be.Store({videoBlob:e})}):i.gif&&i.gif.getDataURL(function(e){be.Store({gifBlob:e})})};/**
 * {@link RecordRTCConfiguration} is an inner/private helper for {@link RecordRTC}.
 * @summary It configures the 2nd parameter passed over {@link RecordRTC} and returns a valid "config" object.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCConfiguration
 * @class
 * @example
 * var options = RecordRTCConfiguration(mediaStream, options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, getNativeBlob:true, etc.}
 */function d(i,e){return!e.recorderType&&!e.type&&(e.audio&&e.video?e.type="video":e.audio&&!e.video&&(e.type="audio")),e.recorderType&&!e.type&&(e.recorderType===ae||e.recorderType===V||typeof Ye<"u"&&e.recorderType===Ye?e.type="video":e.recorderType===se?e.type="gif":e.recorderType===ge?e.type="audio":e.recorderType===re&&(X(i,"audio").length&&X(i,"video").length||!X(i,"audio").length&&X(i,"video").length?e.type="video":X(i,"audio").length&&!X(i,"video").length&&(e.type="audio"))),typeof re<"u"&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(e.mimeType||(e.mimeType="video/webm"),e.type||(e.type=e.mimeType.split("/")[0]),e.bitsPerSecond),e.type||(e.mimeType&&(e.type=e.mimeType.split("/")[0]),e.type||(e.type="audio")),e}/**
 * {@link GetRecorderType} is an inner/private helper for {@link RecordRTC}.
 * @summary It returns best recorder-type available for your browser.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GetRecorderType
 * @class
 * @example
 * var RecorderType = GetRecorderType(options);
 * var recorder = new RecorderType(options);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {type:"video", disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 */function g(i,e){var o;return(W||B||x)&&(o=ge),typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&!W&&(o=re),e.type==="video"&&(W||x)&&(o=ae,typeof Ye<"u"&&typeof ReadableStream<"u"&&(o=Ye)),e.type==="gif"&&(o=se),e.type==="canvas"&&(o=V),de()&&o!==V&&o!==se&&typeof MediaRecorder<"u"&&"requestData"in MediaRecorder.prototype&&(X(i,"video").length||X(i,"audio").length)&&(e.type==="audio"?typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("audio/webm")&&(o=re):typeof MediaRecorder.isTypeSupported=="function"&&MediaRecorder.isTypeSupported("video/webm")&&(o=re)),i instanceof Array&&i.length&&(o=vt),e.recorderType&&(o=e.recorderType),!e.disableLogs&&o&&o.name&&console.log("Using recorderType:",o.name||o.constructor.name),!o&&A&&(o=re),o}/**
 * MRecordRTC runs on top of {@link RecordRTC} to bring multiple recordings in a single place, by providing simple API.
 * @summary MRecordRTC stands for "Multiple-RecordRTC".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MRecordRTC
 * @class
 * @example
 * var recorder = new MRecordRTC();
 * recorder.addStream(MediaStream);
 * recorder.mediaType = {
 *     audio: true, // or StereoAudioRecorder or MediaStreamRecorder
 *     video: true, // or WhammyRecorder or MediaStreamRecorder or WebAssemblyRecorder or CanvasRecorder
 *     gif: true    // or GifRecorder
 * };
 * // mimeType is optional and should be set only in advance cases.
 * recorder.mimeType = {
 *     audio: 'audio/wav',
 *     video: 'video/webm',
 *     gif:   'image/gif'
 * };
 * recorder.startRecording();
 * @see For further information:
 * @see {@link https://github.com/muaz-khan/RecordRTC/tree/master/MRecordRTC|MRecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @requires {@link RecordRTC}
 */function l(i){this.addStream=function(e){e&&(i=e)},this.mediaType={audio:!0,video:!0},this.startRecording=function(){var e=this.mediaType,o,p=this.mimeType||{audio:null,video:null,gif:null};if(typeof e.audio!="function"&&de()&&!X(i,"audio").length&&(e.audio=!1),typeof e.video!="function"&&de()&&!X(i,"video").length&&(e.video=!1),typeof e.gif!="function"&&de()&&!X(i,"video").length&&(e.gif=!1),!e.audio&&!e.video&&!e.gif)throw"MediaStream must have either audio or video tracks.";if(e.audio&&(o=null,typeof e.audio=="function"&&(o=e.audio),this.audioRecorder=new r(i,{type:"audio",bufferSize:this.bufferSize,sampleRate:this.sampleRate,numberOfAudioChannels:this.numberOfAudioChannels||2,disableLogs:this.disableLogs,recorderType:o,mimeType:p.audio,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp}),e.video||this.audioRecorder.startRecording()),e.video){o=null,typeof e.video=="function"&&(o=e.video);var h=i;if(de()&&e.audio&&typeof e.audio=="function"){var m=X(i,"video")[0];H?(h=new U,h.addTrack(m),o&&o===ae&&(o=re)):(h=new U,h.addTrack(m))}this.videoRecorder=new r(h,{type:"video",video:this.video,canvas:this.canvas,frameInterval:this.frameInterval||10,disableLogs:this.disableLogs,recorderType:o,mimeType:p.video,timeSlice:this.timeSlice,onTimeStamp:this.onTimeStamp,workerPath:this.workerPath,webAssemblyPath:this.webAssemblyPath,frameRate:this.frameRate,bitrate:this.bitrate}),e.audio||this.videoRecorder.startRecording()}if(e.audio&&e.video){var w=this,a=de()===!0;(e.audio instanceof ge&&e.video||e.audio!==!0&&e.video!==!0&&e.audio!==e.video)&&(a=!1),a===!0?(w.audioRecorder=null,w.videoRecorder.startRecording()):w.videoRecorder.initRecorder(function(){w.audioRecorder.initRecorder(function(){w.videoRecorder.startRecording(),w.audioRecorder.startRecording()})})}e.gif&&(o=null,typeof e.gif=="function"&&(o=e.gif),this.gifRecorder=new r(i,{type:"gif",frameRate:this.frameRate||200,quality:this.quality||10,disableLogs:this.disableLogs,recorderType:o,mimeType:p.gif}),this.gifRecorder.startRecording())},this.stopRecording=function(e){e=e||function(){},this.audioRecorder&&this.audioRecorder.stopRecording(function(o){e(o,"audio")}),this.videoRecorder&&this.videoRecorder.stopRecording(function(o){e(o,"video")}),this.gifRecorder&&this.gifRecorder.stopRecording(function(o){e(o,"gif")})},this.pauseRecording=function(){this.audioRecorder&&this.audioRecorder.pauseRecording(),this.videoRecorder&&this.videoRecorder.pauseRecording(),this.gifRecorder&&this.gifRecorder.pauseRecording()},this.resumeRecording=function(){this.audioRecorder&&this.audioRecorder.resumeRecording(),this.videoRecorder&&this.videoRecorder.resumeRecording(),this.gifRecorder&&this.gifRecorder.resumeRecording()},this.getBlob=function(e){var o={};return this.audioRecorder&&(o.audio=this.audioRecorder.getBlob()),this.videoRecorder&&(o.video=this.videoRecorder.getBlob()),this.gifRecorder&&(o.gif=this.gifRecorder.getBlob()),e&&e(o),o},this.destroy=function(){this.audioRecorder&&(this.audioRecorder.destroy(),this.audioRecorder=null),this.videoRecorder&&(this.videoRecorder.destroy(),this.videoRecorder=null),this.gifRecorder&&(this.gifRecorder.destroy(),this.gifRecorder=null)},this.getDataURL=function(e){this.getBlob(function(h){h.audio&&h.video?o(h.audio,function(m){o(h.video,function(w){e({audio:m,video:w})})}):h.audio?o(h.audio,function(m){e({audio:m})}):h.video&&o(h.video,function(m){e({video:m})})});function o(h,m){if(typeof Worker<"u"){var w=p(function(D){postMessage(new FileReaderSync().readAsDataURL(D))});w.onmessage=function(S){m(S.data)},w.postMessage(h)}else{var a=new FileReader;a.readAsDataURL(h),a.onload=function(S){m(S.target.result)}}}function p(h){var m=y.createObjectURL(new Blob([h.toString(),"this.onmessage =  function (eee) {"+h.name+"(eee.data);}"],{type:"application/javascript"})),w=new Worker(m),a;if(typeof y<"u")a=y;else if(typeof webkitURL<"u")a=webkitURL;else throw"Neither URL nor webkitURL detected.";return a.revokeObjectURL(m),w}},this.writeToDisk=function(){r.writeToDisk({audio:this.audioRecorder,video:this.videoRecorder,gif:this.gifRecorder})},this.save=function(e){e=e||{audio:!0,video:!0,gif:!0},e.audio&&this.audioRecorder&&this.audioRecorder.save(typeof e.audio=="string"?e.audio:""),e.video&&this.videoRecorder&&this.videoRecorder.save(typeof e.video=="string"?e.video:""),e.gif&&this.gifRecorder&&this.gifRecorder.save(typeof e.gif=="string"?e.gif:"")}}l.getFromDisk=r.getFromDisk,l.writeToDisk=r.writeToDisk,typeof r<"u"&&(r.MRecordRTC=l);var _="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(i){i&&(typeof window<"u"||typeof ee>"u"||(ee.navigator={userAgent:_,getUserMedia:function(){}},ee.console||(ee.console={}),(typeof ee.console.log>"u"||typeof ee.console.error>"u")&&(ee.console.error=ee.console.log=ee.console.log||function(){console.log(arguments)}),typeof document>"u"&&(i.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var e={getContext:function(){return e},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return e},i.HTMLVideoElement=function(){}),typeof location>"u"&&(i.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(i.screen={width:0,height:0}),typeof y>"u"&&(i.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),i.window=ee))})(typeof ee<"u"?ee:null);var u=window.requestAnimationFrame;if(typeof u>"u"){if(typeof webkitRequestAnimationFrame<"u")u=webkitRequestAnimationFrame;else if(typeof mozRequestAnimationFrame<"u")u=mozRequestAnimationFrame;else if(typeof msRequestAnimationFrame<"u")u=msRequestAnimationFrame;else if(typeof u>"u"){var Q=0;u=function(i,e){var o=new Date().getTime(),p=Math.max(0,16-(o-Q)),h=setTimeout(function(){i(o+p)},p);return Q=o+p,h}}}var j=window.cancelAnimationFrame;typeof j>"u"&&(typeof webkitCancelAnimationFrame<"u"?j=webkitCancelAnimationFrame:typeof mozCancelAnimationFrame<"u"?j=mozCancelAnimationFrame:typeof msCancelAnimationFrame<"u"?j=msCancelAnimationFrame:typeof j>"u"&&(j=function(i){clearTimeout(i)}));var O=window.AudioContext;typeof O>"u"&&(typeof webkitAudioContext<"u"&&(O=webkitAudioContext),typeof mozAudioContext<"u"&&(O=mozAudioContext));var y=window.URL;typeof y>"u"&&typeof webkitURL<"u"&&(y=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var B=navigator.userAgent.indexOf("Edge")!==-1&&(!!navigator.msSaveBlob||!!navigator.msSaveOrOpenBlob),x=!!window.opera||navigator.userAgent.indexOf("OPR/")!==-1,H=navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&"netscape"in window&&/ rv:/.test(navigator.userAgent),W=!x&&!B&&!!navigator.webkitGetUserMedia||Z()||navigator.userAgent.toLowerCase().indexOf("chrome/")!==-1,A=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);A&&!W&&navigator.userAgent.indexOf("CriOS")!==-1&&(A=!1,W=!0);var U=window.MediaStream;typeof U>"u"&&typeof webkitMediaStream<"u"&&(U=webkitMediaStream),typeof U<"u"&&typeof U.prototype.stop>"u"&&(U.prototype.stop=function(){this.getTracks().forEach(function(i){i.stop()})});function N(i){var e=1e3,o=["Bytes","KB","MB","GB","TB"];if(i===0)return"0 Bytes";var p=parseInt(Math.floor(Math.log(i)/Math.log(e)),10);return(i/Math.pow(e,p)).toPrecision(3)+" "+o[p]}function ie(i,e){if(!i)throw"Blob object is required.";if(!i.type)try{i.type="video/webm"}catch{}var o=(i.type||"video/webm").split("/")[1];if(o.indexOf(";")!==-1&&(o=o.split(";")[0]),e&&e.indexOf(".")!==-1){var p=e.split(".");e=p[0],o=p[1]}var h=(e||Math.round(Math.random()*9999999999)+888888888)+"."+o;if(typeof navigator.msSaveOrOpenBlob<"u")return navigator.msSaveOrOpenBlob(i,h);if(typeof navigator.msSaveBlob<"u")return navigator.msSaveBlob(i,h);var m=document.createElement("a");m.href=y.createObjectURL(i),m.download=h,m.style="display:none;opacity:0;color:transparent;",(document.body||document.documentElement).appendChild(m),typeof m.click=="function"?m.click():(m.target="_blank",m.dispatchEvent(new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0}))),y.revokeObjectURL(m.href)}function Z(){return!!(typeof window<"u"&&typeof window.process=="object"&&window.process.type==="renderer"||typeof process<"u"&&typeof process.versions=="object"&&process.versions.electron||typeof navigator=="object"&&typeof navigator.userAgent=="string"&&navigator.userAgent.indexOf("Electron")>=0)}function X(i,e){return!i||!i.getTracks?[]:i.getTracks().filter(function(o){return o.kind===(e||"audio")})}function Ce(i,e){"srcObject"in e?e.srcObject=i:"mozSrcObject"in e?e.mozSrcObject=i:e.srcObject=i}function Le(i,e){if(typeof EBML>"u")throw new Error("Please link: https://www.webrtc-experiment.com/EBML.js");var o=new EBML.Reader,p=new EBML.Decoder,h=EBML.tools,m=new FileReader;m.onload=function(w){var a=p.decode(this.result);a.forEach(function(I){o.read(I)}),o.stop();var S=h.makeMetadataSeekable(o.metadatas,o.duration,o.cues),D=this.result.slice(o.metadataSize),k=new Blob([S,D],{type:"video/webm"});e(k)},m.readAsArrayBuffer(i)}typeof r<"u"&&(r.invokeSaveAsDialog=ie,r.getTracks=X,r.getSeekableBlob=Le,r.bytesToSize=N,r.isElectron=Z);/**
 * Storage is a standalone object used by {@link RecordRTC} to store reusable objects e.g. "new AudioContext".
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * Storage.AudioContext === webkitAudioContext
 * @property {webkitAudioContext} AudioContext - Keeps a reference to AudioContext object.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var fe={};typeof O<"u"?fe.AudioContext=O:typeof webkitAudioContext<"u"&&(fe.AudioContext=webkitAudioContext),typeof r<"u"&&(r.Storage=fe);function de(){if(H||A||B)return!0;var i=navigator.userAgent,e=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10),p,h;return(W||x)&&(p=i.indexOf("Chrome"),e=i.substring(p+7)),(h=e.indexOf(";"))!==-1&&(e=e.substring(0,h)),(h=e.indexOf(" "))!==-1&&(e=e.substring(0,h)),o=parseInt(""+e,10),isNaN(o)&&(e=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10)),o>=49}/**
 * MediaStreamRecorder is an abstraction layer for {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}. It is used by {@link RecordRTC} to record MediaStream(s) in both Chrome and Firefox.
 * @summary Runs top over {@link https://w3c.github.io/mediacapture-record/MediaRecorder.html|MediaRecorder API}.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://github.com/muaz-khan|Muaz Khan}
 * @typedef MediaStreamRecorder
 * @class
 * @example
 * var config = {
 *     mimeType: 'video/webm', // vp8, vp9, h264, mkv, opus/vorbis
 *     audioBitsPerSecond : 256 * 8 * 1024,
 *     videoBitsPerSecond : 256 * 8 * 1024,
 *     bitsPerSecond: 256 * 8 * 1024,  // if this is provided, skip above two
 *     checkForInactiveTracks: true,
 *     timeSlice: 1000, // concatenate intervals based blobs
 *     ondataavailable: function() {} // get intervals based blobs
 * }
 * var recorder = new MediaStreamRecorder(mediaStream, config);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs:true, initCallback: function, mimeType: "video/webm", timeSlice: 1000}
 * @throws Will throw an error if first argument "MediaStream" is missing. Also throws error if "MediaRecorder API" are not supported by the browser.
 */function re(i,e){var k=this;if(typeof i>"u")throw'First argument "MediaStream" is required.';if(typeof MediaRecorder>"u")throw"Your browser does not support the Media Recorder API. Please try other modules e.g. WhammyRecorder or StereoAudioRecorder.";if(e=e||{mimeType:"video/webm"},e.type==="audio"){if(X(i,"video").length&&X(i,"audio").length){var o;navigator.mozGetUserMedia?(o=new U,o.addTrack(X(i,"audio")[0])):o=new U(X(i,"audio")),i=o}(!e.mimeType||e.mimeType.toString().toLowerCase().indexOf("audio")===-1)&&(e.mimeType=W?"audio/webm":"audio/ogg"),e.mimeType&&e.mimeType.toString().toLowerCase()!=="audio/ogg"&&navigator.mozGetUserMedia&&(e.mimeType="audio/ogg")}var p=[];this.getArrayOfBlobs=function(){return p},this.record=function(){k.blob=null,k.clearRecordedData(),k.timestamps=[],D=[],p=[];var I=e;e.disableLogs||console.log("Passing following config over MediaRecorder API.",I),a&&(a=null),W&&!de()&&(I="video/vp8"),typeof MediaRecorder.isTypeSupported=="function"&&I.mimeType&&(MediaRecorder.isTypeSupported(I.mimeType)||(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",I.mimeType),I.mimeType=e.type==="audio"?"audio/webm":"video/webm"));try{a=new MediaRecorder(i,I),e.mimeType=I.mimeType}catch{a=new MediaRecorder(i)}I.mimeType&&!MediaRecorder.isTypeSupported&&"canRecordMimeType"in a&&a.canRecordMimeType(I.mimeType)===!1&&(e.disableLogs||console.warn("MediaRecorder API seems unable to record mimeType:",I.mimeType)),a.ondataavailable=function(M){if(M.data&&D.push("ondataavailable: "+N(M.data.size)),typeof e.timeSlice=="number"){if(M.data&&M.data.size&&(p.push(M.data),h(),typeof e.ondataavailable=="function")){var T=e.getNativeBlob?M.data:new Blob([M.data],{type:m(I)});e.ondataavailable(T)}return}if(!M.data||!M.data.size||M.data.size<100||k.blob){k.recordingCallback&&(k.recordingCallback(new Blob([],{type:m(I)})),k.recordingCallback=null);return}k.blob=e.getNativeBlob?M.data:new Blob([M.data],{type:m(I)}),k.recordingCallback&&(k.recordingCallback(k.blob),k.recordingCallback=null)},a.onstart=function(){D.push("started")},a.onpause=function(){D.push("paused")},a.onresume=function(){D.push("resumed")},a.onstop=function(){D.push("stopped")},a.onerror=function(M){M&&(M.name||(M.name="UnknownError"),D.push("error: "+M),e.disableLogs||(M.name.toString().toLowerCase().indexOf("invalidstate")!==-1?console.error("The MediaRecorder is not in a state in which the proposed operation is allowed to be executed.",M):M.name.toString().toLowerCase().indexOf("notsupported")!==-1?console.error("MIME type (",I.mimeType,") is not supported.",M):M.name.toString().toLowerCase().indexOf("security")!==-1?console.error("MediaRecorder security error",M):M.name==="OutOfMemory"?console.error("The UA has exhaused the available memory. User agents SHOULD provide as much additional information as possible in the message attribute.",M):M.name==="IllegalStreamModification"?console.error("A modification to the stream has occurred that makes it impossible to continue recording. An example would be the addition of a Track while recording is occurring. User agents SHOULD provide as much additional information as possible in the message attribute.",M):M.name==="OtherRecordingError"?console.error("Used for an fatal error other than those listed above. User agents SHOULD provide as much additional information as possible in the message attribute.",M):M.name==="GenericError"?console.error("The UA cannot provide the codec or recording option that has been requested.",M):console.error("MediaRecorder Error",M)),function(T){if(!k.manuallyStopped&&a&&a.state==="inactive"){delete e.timeslice,a.start(600*1e3);return}setTimeout(T,1e3)}(),a.state!=="inactive"&&a.state!=="stopped"&&a.stop())},typeof e.timeSlice=="number"?(h(),a.start(e.timeSlice)):a.start(36e5),e.initCallback&&e.initCallback()},this.timestamps=[];function h(){k.timestamps.push(new Date().getTime()),typeof e.onTimeStamp=="function"&&e.onTimeStamp(k.timestamps[k.timestamps.length-1],k.timestamps)}function m(I){return a&&a.mimeType?a.mimeType:I.mimeType||"video/webm"}this.stop=function(I){I=I||function(){},k.manuallyStopped=!0,a&&(this.recordingCallback=I,a.state==="recording"&&a.stop(),typeof e.timeSlice=="number"&&setTimeout(function(){k.blob=new Blob(p,{type:m(e)}),k.recordingCallback(k.blob)},100))},this.pause=function(){a&&a.state==="recording"&&a.pause()},this.resume=function(){a&&a.state==="paused"&&a.resume()},this.clearRecordedData=function(){a&&a.state==="recording"&&k.stop(w),w()};function w(){p=[],a=null,k.timestamps=[]}var a;this.getInternalRecorder=function(){return a};function S(){if("active"in i){if(!i.active)return!1}else if("ended"in i&&i.ended)return!1;return!0}this.blob=null,this.getState=function(){return a&&a.state||"inactive"};var D=[];this.getAllStates=function(){return D},typeof e.checkForInactiveTracks>"u"&&(e.checkForInactiveTracks=!1);var k=this;(function I(){if(!(!a||e.checkForInactiveTracks===!1)){if(S()===!1){e.disableLogs||console.log("MediaStream seems stopped."),k.stop();return}setTimeout(I,1e3)}})(),this.name="MediaStreamRecorder",this.toString=function(){return this.name}}typeof r<"u"&&(r.MediaStreamRecorder=re);/**
 * StereoAudioRecorder is a standalone class used by {@link RecordRTC} to bring "stereo" audio-recording in chrome.
 * @summary JavaScript standalone object for stereo audio recording.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef StereoAudioRecorder
 * @class
 * @example
 * var recorder = new StereoAudioRecorder(MediaStream, {
 *     sampleRate: 44100,
 *     bufferSize: 4096
 * });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {sampleRate: 44100, bufferSize: 4096, numberOfAudioChannels: 1, etc.}
 */function ge(i,e){if(!X(i,"audio").length)throw"Your stream has no audio tracks.";e=e||{};var o=this,p=[],h=[],m=!1,w=0,a,S=2,D=e.desiredSampRate;e.leftChannel===!0&&(S=1),e.numberOfAudioChannels===1&&(S=1),(!S||S<1)&&(S=2),e.disableLogs||console.log("StereoAudioRecorder is set to record number of channels: "+S),typeof e.checkForInactiveTracks>"u"&&(e.checkForInactiveTracks=!0);function k(){if(e.checkForInactiveTracks===!1)return!0;if("active"in i){if(!i.active)return!1}else if("ended"in i&&i.ended)return!1;return!0}this.record=function(){if(k()===!1)throw"Please make sure MediaStream is active.";q(),b=$=!1,m=!0,typeof e.timeSlice<"u"&&J()};function I(Y,le){function ue(oe,Ke){var Se=oe.numberOfAudioChannels,ye=oe.leftBuffers.slice(0),Be=oe.rightBuffers.slice(0),we=oe.sampleRate,Ue=oe.internalInterleavedLength,Me=oe.desiredSampRate;Se===2&&(ye=lt(ye,Ue),Be=lt(Be,Ue),Me&&(ye=Je(ye,Me,we),Be=Je(Be,Me,we))),Se===1&&(ye=lt(ye,Ue),Me&&(ye=Je(ye,Me,we))),Me&&(we=Me);function Je(ne,$e,xe){var ke=Math.round(ne.length*($e/xe)),pe=[],Fe=Number((ne.length-1)/(ke-1));pe[0]=ne[0];for(var Ve=1;Ve<ke-1;Ve++){var ct=Ve*Fe,bt=Number(Math.floor(ct)).toFixed(),Pt=Number(Math.ceil(ct)).toFixed(),jt=ct-bt;pe[Ve]=Bt(ne[bt],ne[Pt],jt)}return pe[ke-1]=ne[ne.length-1],pe}function Bt(ne,$e,xe){return ne+($e-ne)*xe}function lt(ne,$e){for(var xe=new Float64Array($e),ke=0,pe=ne.length,Fe=0;Fe<pe;Fe++){var Ve=ne[Fe];xe.set(Ve,ke),ke+=Ve.length}return xe}function Ut(ne,$e){for(var xe=ne.length+$e.length,ke=new Float64Array(xe),pe=0,Fe=0;Fe<xe;)ke[Fe++]=ne[pe],ke[Fe++]=$e[pe],pe++;return ke}function tt(ne,$e,xe){for(var ke=xe.length,pe=0;pe<ke;pe++)ne.setUint8($e+pe,xe.charCodeAt(pe))}var rt;Se===2&&(rt=Ut(ye,Be)),Se===1&&(rt=ye);var ot=rt.length,Ft=44+ot*2,dt=new ArrayBuffer(Ft),ce=new DataView(dt);tt(ce,0,"RIFF"),ce.setUint32(4,36+ot*2,!0),tt(ce,8,"WAVE"),tt(ce,12,"fmt "),ce.setUint32(16,16,!0),ce.setUint16(20,1,!0),ce.setUint16(22,Se,!0),ce.setUint32(24,we,!0),ce.setUint32(28,we*Se*2,!0),ce.setUint16(32,Se*2,!0),ce.setUint16(34,16,!0),tt(ce,36,"data"),ce.setUint32(40,ot*2,!0);for(var Ot=ot,gt=44,Et=1,ut=0;ut<Ot;ut++)ce.setInt16(gt,rt[ut]*(32767*Et),!0),gt+=2;if(Ke)return Ke({buffer:dt,view:ce});postMessage({buffer:dt,view:ce})}if(Y.noWorker){ue(Y,function(oe){le(oe.buffer,oe.view)});return}var De=M(ue);De.onmessage=function(oe){le(oe.data.buffer,oe.data.view),y.revokeObjectURL(De.workerURL),De.terminate()},De.postMessage(Y)}function M(Y){var le=y.createObjectURL(new Blob([Y.toString(),";this.onmessage =  function (eee) {"+Y.name+"(eee.data);}"],{type:"application/javascript"})),ue=new Worker(le);return ue.workerURL=le,ue}this.stop=function(Y){Y=Y||function(){},m=!1,I({desiredSampRate:D,sampleRate:f,numberOfAudioChannels:S,internalInterleavedLength:w,leftBuffers:p,rightBuffers:S===1?[]:h,noWorker:e.noWorker},function(le,ue){o.blob=new Blob([ue],{type:"audio/wav"}),o.buffer=new ArrayBuffer(ue.buffer.byteLength),o.view=ue,o.sampleRate=D||f,o.bufferSize=K,o.length=w,b=!1,Y&&Y(o.blob)})},typeof r.Storage>"u"&&(r.Storage={AudioContextConstructor:null,AudioContext:window.AudioContext||window.webkitAudioContext}),(!r.Storage.AudioContextConstructor||r.Storage.AudioContextConstructor.state==="closed")&&(r.Storage.AudioContextConstructor=new r.Storage.AudioContext);var T=r.Storage.AudioContextConstructor,C=T.createMediaStreamSource(i),z=[0,256,512,1024,2048,4096,8192,16384],K=typeof e.bufferSize>"u"?4096:e.bufferSize;if(z.indexOf(K)===-1&&(e.disableLogs||console.log("Legal values for buffer-size are "+JSON.stringify(z,null,"	"))),T.createJavaScriptNode)a=T.createJavaScriptNode(K,S,S);else if(T.createScriptProcessor)a=T.createScriptProcessor(K,S,S);else throw"WebAudio API has no support on this browser.";C.connect(a),e.bufferSize||(K=a.bufferSize);var f=typeof e.sampleRate<"u"?e.sampleRate:T.sampleRate||44100;(f<22050||f>96e3)&&(e.disableLogs||console.log("sample-rate must be under range 22050 and 96000.")),e.disableLogs||e.desiredSampRate&&console.log("Desired sample-rate: "+e.desiredSampRate);var $=!1;this.pause=function(){$=!0},this.resume=function(){if(k()===!1)throw"Please make sure MediaStream is active.";if(!m){e.disableLogs||console.log("Seems recording has been restarted."),this.record();return}$=!1},this.clearRecordedData=function(){e.checkForInactiveTracks=!1,m&&this.stop(s),s()};function q(){p=[],h=[],w=0,b=!1,m=!1,$=!1,T=null,o.leftchannel=p,o.rightchannel=h,o.numberOfAudioChannels=S,o.desiredSampRate=D,o.sampleRate=f,o.recordingLength=w,E={left:[],right:[],recordingLength:0}}function s(){a&&(a.onaudioprocess=null,a.disconnect(),a=null),C&&(C.disconnect(),C=null),q()}this.name="StereoAudioRecorder",this.toString=function(){return this.name};var b=!1;function F(Y){if(!$){if(k()===!1&&(e.disableLogs||console.log("MediaStream seems stopped."),a.disconnect(),m=!1),!m){C&&(C.disconnect(),C=null);return}b||(b=!0,e.onAudioProcessStarted&&e.onAudioProcessStarted(),e.initCallback&&e.initCallback());var le=Y.inputBuffer.getChannelData(0),ue=new Float32Array(le);if(p.push(ue),S===2){var De=Y.inputBuffer.getChannelData(1),oe=new Float32Array(De);h.push(oe)}w+=K,o.recordingLength=w,typeof e.timeSlice<"u"&&(E.recordingLength+=K,E.left.push(ue),S===2&&E.right.push(oe))}}a.onaudioprocess=F,T.createMediaStreamDestination?a.connect(T.createMediaStreamDestination()):a.connect(T.destination),this.leftchannel=p,this.rightchannel=h,this.numberOfAudioChannels=S,this.desiredSampRate=D,this.sampleRate=f,o.recordingLength=w;var E={left:[],right:[],recordingLength:0};function J(){!m||typeof e.ondataavailable!="function"||typeof e.timeSlice>"u"||(E.left.length?(I({desiredSampRate:D,sampleRate:f,numberOfAudioChannels:S,internalInterleavedLength:E.recordingLength,leftBuffers:E.left,rightBuffers:S===1?[]:E.right},function(Y,le){var ue=new Blob([le],{type:"audio/wav"});e.ondataavailable(ue),setTimeout(J,e.timeSlice)}),E={left:[],right:[],recordingLength:0}):setTimeout(J,e.timeSlice))}}typeof r<"u"&&(r.StereoAudioRecorder=ge);/**
 * CanvasRecorder is a standalone class used by {@link RecordRTC} to bring HTML5-Canvas recording into video WebM. It uses HTML2Canvas library and runs top over {@link Whammy}.
 * @summary HTML2Canvas recording into video WebM.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef CanvasRecorder
 * @class
 * @example
 * var recorder = new CanvasRecorder(htmlElement, { disableLogs: true, useWhammyRecorder: true });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {HTMLElement} htmlElement - querySelector/getElementById/getElementsByTagName[0]/etc.
 * @param {object} config - {disableLogs:true, initCallback: function}
 */function V(i,e){if(typeof html2canvas>"u")throw"Please link: https://www.webrtc-experiment.com/screenshot.js";e=e||{},e.frameInterval||(e.frameInterval=10);var o=!1;["captureStream","mozCaptureStream","webkitCaptureStream"].forEach(function(z){z in document.createElement("canvas")&&(o=!0)});var p=(!!window.webkitRTCPeerConnection||!!window.webkitGetUserMedia)&&!!window.chrome,h=50,m=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);p&&m&&m[2]&&(h=parseInt(m[2],10)),p&&h<52&&(o=!1),e.useWhammyRecorder&&(o=!1);var w,a;if(o)if(e.disableLogs||console.log("Your browser supports both MediRecorder API and canvas.captureStream!"),i instanceof HTMLCanvasElement)w=i;else if(i instanceof CanvasRenderingContext2D)w=i.canvas;else throw"Please pass either HTMLCanvasElement or CanvasRenderingContext2D.";else navigator.mozGetUserMedia&&(e.disableLogs||console.error("Canvas recording is NOT supported in Firefox."));var S;this.record=function(){if(S=!0,o&&!e.useWhammyRecorder){var z;"captureStream"in w?z=w.captureStream(25):"mozCaptureStream"in w?z=w.mozCaptureStream(25):"webkitCaptureStream"in w&&(z=w.webkitCaptureStream(25));try{var K=new U;K.addTrack(X(z,"video")[0]),z=K}catch{}if(!z)throw"captureStream API are NOT available.";a=new re(z,{mimeType:e.mimeType||"video/webm"}),a.record()}else C.frames=[],T=new Date().getTime(),M();e.initCallback&&e.initCallback()},this.getWebPImages=function(z){if(i.nodeName.toLowerCase()!=="canvas"){z();return}var K=C.frames.length;C.frames.forEach(function(f,$){var q=K-$;e.disableLogs||console.log(q+"/"+K+" frames remaining"),e.onEncodingCallback&&e.onEncodingCallback(q,K);var s=f.image.toDataURL("image/webp",1);C.frames[$].image=s}),e.disableLogs||console.log("Generating WebM"),z()},this.stop=function(z){S=!1;var K=this;if(o&&a){a.stop(z);return}this.getWebPImages(function(){C.compile(function(f){e.disableLogs||console.log("Recording finished!"),K.blob=f,K.blob.forEach&&(K.blob=new Blob([],{type:"video/webm"})),z&&z(K.blob),C.frames=[]})})};var D=!1;this.pause=function(){if(D=!0,a instanceof re){a.pause();return}},this.resume=function(){if(D=!1,a instanceof re){a.resume();return}S||this.record()},this.clearRecordedData=function(){S&&this.stop(k),k()};function k(){C.frames=[],S=!1,D=!1}this.name="CanvasRecorder",this.toString=function(){return this.name};function I(){var z=document.createElement("canvas"),K=z.getContext("2d");return z.width=i.width,z.height=i.height,K.drawImage(i,0,0),z}function M(){if(D)return T=new Date().getTime(),setTimeout(M,500);if(i.nodeName.toLowerCase()==="canvas"){var z=new Date().getTime()-T;T=new Date().getTime(),C.frames.push({image:I(),duration:z}),S&&setTimeout(M,e.frameInterval);return}html2canvas(i,{grabMouse:typeof e.showMousePointer>"u"||e.showMousePointer,onrendered:function(K){var f=new Date().getTime()-T;if(!f)return setTimeout(M,e.frameInterval);T=new Date().getTime(),C.frames.push({image:K.toDataURL("image/webp",1),duration:f}),S&&setTimeout(M,e.frameInterval)}})}var T=new Date().getTime(),C=new _e.Video(100)}typeof r<"u"&&(r.CanvasRecorder=V);/**
 * WhammyRecorder is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It runs top over {@link Whammy}.
 * @summary Video recording feature in Chrome.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WhammyRecorder
 * @class
 * @example
 * var recorder = new WhammyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {disableLogs: true, initCallback: function, video: HTMLVideoElement, etc.}
 */function ae(i,e){e=e||{},e.frameInterval||(e.frameInterval=10),e.disableLogs||console.log("Using frames-interval:",e.frameInterval),this.record=function(){e.width||(e.width=320),e.height||(e.height=240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),S.width=e.canvas.width||320,S.height=e.canvas.height||240,D=S.getContext("2d"),e.video&&e.video instanceof HTMLVideoElement?(k=e.video.cloneNode(),e.initCallback&&e.initCallback()):(k=document.createElement("video"),Ce(i,k),k.onloadedmetadata=function(){e.initCallback&&e.initCallback()},k.width=e.video.width,k.height=e.video.height),k.muted=!0,k.play(),I=new Date().getTime(),M=new _e.Video,e.disableLogs||(console.log("canvas resolutions",S.width,"*",S.height),console.log("video width/height",k.width||S.width,"*",k.height||S.height)),o(e.frameInterval)};function o(T){T=typeof T<"u"?T:10;var C=new Date().getTime()-I;if(!C)return setTimeout(o,T,T);if(w)return I=new Date().getTime(),setTimeout(o,100);I=new Date().getTime(),k.paused&&k.play(),D.drawImage(k,0,0,S.width,S.height),M.frames.push({duration:C,image:S.toDataURL("image/webp")}),m||setTimeout(o,T,T)}function p(T){var C=-1,z=T.length;(function K(){if(C++,C===z){T.callback();return}setTimeout(function(){T.functionToLoop(K,C)},1)})()}function h(T,C,z,K,f){var $=document.createElement("canvas");$.width=S.width,$.height=S.height;var q=$.getContext("2d"),s=[],b=T.length,F={r:0,g:0,b:0},E=Math.sqrt(Math.pow(255,2)+Math.pow(255,2)+Math.pow(255,2)),J=0,Y=0,le=!1;p({length:b,functionToLoop:function(ue,De){var oe,Ke,Se,ye=function(){!le&&Se-oe<=Se*Y||(le=!0,s.push(T[De])),ue()};if(le)ye();else{var Be=new Image;Be.onload=function(){q.drawImage(Be,0,0,S.width,S.height);var we=q.getImageData(0,0,S.width,S.height);oe=0,Ke=we.data.length,Se=we.data.length/4;for(var Ue=0;Ue<Ke;Ue+=4){var Me={r:we.data[Ue],g:we.data[Ue+1],b:we.data[Ue+2]},Je=Math.sqrt(Math.pow(Me.r-F.r,2)+Math.pow(Me.g-F.g,2)+Math.pow(Me.b-F.b,2));Je<=E*J&&oe++}ye()},Be.src=T[De].image}},callback:function(){s=s.concat(T.slice(b)),s.length<=0&&s.push(T[T.length-1]),f(s)}})}var m=!1;this.stop=function(T){T=T||function(){},m=!0;var C=this;setTimeout(function(){h(M.frames,-1,null,null,function(z){M.frames=z,e.advertisement&&e.advertisement.length&&(M.frames=e.advertisement.concat(M.frames)),M.compile(function(K){C.blob=K,C.blob.forEach&&(C.blob=new Blob([],{type:"video/webm"})),T&&T(C.blob)})})},10)};var w=!1;this.pause=function(){w=!0},this.resume=function(){w=!1,m&&this.record()},this.clearRecordedData=function(){m||this.stop(a),a()};function a(){M.frames=[],m=!0,w=!1}this.name="WhammyRecorder",this.toString=function(){return this.name};var S=document.createElement("canvas"),D=S.getContext("2d"),k,I,M}typeof r<"u"&&(r.WhammyRecorder=ae);/**
 * Whammy is a standalone class used by {@link RecordRTC} to bring video recording in Chrome. It is written by {@link https://github.com/antimatter15|antimatter15}
 * @summary A real time javascript webm encoder based on a canvas hack.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef Whammy
 * @class
 * @example
 * var recorder = new Whammy().Video(15);
 * recorder.add(context || canvas || dataURL);
 * var output = recorder.compile();
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var _e=function(){function i(p){this.frames=[],this.duration=p||1,this.quality=.8}i.prototype.add=function(p,h){if("canvas"in p&&(p=p.canvas),"toDataURL"in p&&(p=p.toDataURL("image/webp",this.quality)),!/^data:image\/webp;base64,/ig.test(p))throw"Input must be formatted properly as a base64 encoded DataURI of type image/webp";this.frames.push({image:p,duration:h||this.duration})};function e(p){var h=y.createObjectURL(new Blob([p.toString(),"this.onmessage =  function (eee) {"+p.name+"(eee.data);}"],{type:"application/javascript"})),m=new Worker(h);return y.revokeObjectURL(h),m}function o(p){function h(f){var $=w(f);if(!$)return[];for(var q=3e4,s=[{id:440786851,data:[{data:1,id:17030},{data:1,id:17143},{data:4,id:17138},{data:8,id:17139},{data:"webm",id:17026},{data:2,id:17031},{data:2,id:17029}]},{id:408125543,data:[{id:357149030,data:[{data:1e6,id:2807729},{data:"whammy",id:19840},{data:"whammy",id:22337},{data:z($.duration),id:17545}]},{id:374648427,data:[{id:174,data:[{data:1,id:215},{data:1,id:29637},{data:0,id:156},{data:"und",id:2274716},{data:"V_VP8",id:134},{data:"VP8",id:2459272},{data:1,id:131},{id:224,data:[{data:$.width,id:176},{data:$.height,id:186}]}]}]}]}],b=0,F=0;b<f.length;){var E=[],J=0;do E.push(f[b]),J+=f[b].duration,b++;while(b<f.length&&J<q);var Y=0,le={id:524531317,data:m(F,Y,E)};s[1].data.push(le),F+=J}return k(s)}function m(f,$,q){return[{data:f,id:231}].concat(q.map(function(s){var b=I({frame:s.data.slice(4),trackNum:1,timecode:Math.round($)});return $+=s.duration,{data:b,id:163}}))}function w(f){if(!f[0]){postMessage({error:"Something went wrong. Maybe WebP format is not supported in the current browser."});return}for(var $=f[0].width,q=f[0].height,s=f[0].duration,b=1;b<f.length;b++)s+=f[b].duration;return{duration:s,width:$,height:q}}function a(f){for(var $=[];f>0;)$.push(f&255),f=f>>8;return new Uint8Array($.reverse())}function S(f){return new Uint8Array(f.split("").map(function($){return $.charCodeAt(0)}))}function D(f){var $=[],q=f.length%8?new Array(9-f.length%8).join("0"):"";f=q+f;for(var s=0;s<f.length;s+=8)$.push(parseInt(f.substr(s,8),2));return new Uint8Array($)}function k(f){for(var $=[],q=0;q<f.length;q++){var s=f[q].data;typeof s=="object"&&(s=k(s)),typeof s=="number"&&(s=D(s.toString(2))),typeof s=="string"&&(s=S(s));var b=s.size||s.byteLength||s.length,F=Math.ceil(Math.ceil(Math.log(b)/Math.log(2))/8),E=b.toString(2),J=new Array(F*7+7+1-E.length).join("0")+E,Y=new Array(F).join("0")+"1"+J;$.push(a(f[q].id)),$.push(D(Y)),$.push(s)}return new Blob($,{type:"video/webm"})}function I(f){var $=0;$|=128;var q=[f.trackNum|128,f.timecode>>8,f.timecode&255,$].map(function(s){return String.fromCharCode(s)}).join("")+f.frame;return q}function M(f){for(var $=f.RIFF[0].WEBP[0],q=$.indexOf("*"),s=0,b=[];s<4;s++)b[s]=$.charCodeAt(q+3+s);var F,E,J;return J=b[1]<<8|b[0],F=J&16383,J=b[3]<<8|b[2],E=J&16383,{width:F,height:E,data:$,riff:f}}function T(f,$){return parseInt(f.substr($+4,4).split("").map(function(q){var s=q.charCodeAt(0).toString(2);return new Array(8-s.length+1).join("0")+s}).join(""),2)}function C(f){for(var $=0,q={};$<f.length;){var s=f.substr($,4),b=T(f,$),F=f.substr($+4+4,b);$+=8+b,q[s]=q[s]||[],s==="RIFF"||s==="LIST"?q[s].push(C(F)):q[s].push(F)}return q}function z(f){return[].slice.call(new Uint8Array(new Float64Array([f]).buffer),0).map(function($){return String.fromCharCode($)}).reverse().join("")}var K=new h(p.map(function(f){var $=M(C(atob(f.image.slice(23))));return $.duration=f.duration,$}));postMessage(K)}return i.prototype.compile=function(p){var h=e(o);h.onmessage=function(m){if(m.data.error){console.error(m.data.error);return}p(m.data)},h.postMessage(this.frames)},{Video:i}}();typeof r<"u"&&(r.Whammy=_e);/**
 * DiskStorage is a standalone object used by {@link RecordRTC} to store recorded blobs in IndexedDB storage.
 * @summary Writing blobs into IndexedDB.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @example
 * DiskStorage.Store({
 *     audioBlob: yourAudioBlob,
 *     videoBlob: yourVideoBlob,
 *     gifBlob  : yourGifBlob
 * });
 * DiskStorage.Fetch(function(dataURL, type) {
 *     if(type === 'audioBlob') { }
 *     if(type === 'videoBlob') { }
 *     if(type === 'gifBlob')   { }
 * });
 * // DiskStorage.dataStoreName = 'recordRTC';
 * // DiskStorage.onError = function(error) { };
 * @property {function} init - This method must be called once to initialize IndexedDB ObjectStore. Though, it is auto-used internally.
 * @property {function} Fetch - This method fetches stored blobs from IndexedDB.
 * @property {function} Store - This method stores blobs in IndexedDB.
 * @property {function} onError - This function is invoked for any known/unknown error.
 * @property {string} dataStoreName - Name of the ObjectStore created in IndexedDB storage.
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 */var be={init:function(){var i=this;if(typeof indexedDB>"u"||typeof indexedDB.open>"u"){console.error("IndexedDB API are not available in this browser.");return}var e=1,o=this.dbName||location.href.replace(/\/|:|#|%|\.|\[|\]/g,""),p,h=indexedDB.open(o,e);function m(a){a.createObjectStore(i.dataStoreName)}function w(){var a=p.transaction([i.dataStoreName],"readwrite");i.videoBlob&&a.objectStore(i.dataStoreName).put(i.videoBlob,"videoBlob"),i.gifBlob&&a.objectStore(i.dataStoreName).put(i.gifBlob,"gifBlob"),i.audioBlob&&a.objectStore(i.dataStoreName).put(i.audioBlob,"audioBlob");function S(D){a.objectStore(i.dataStoreName).get(D).onsuccess=function(k){i.callback&&i.callback(k.target.result,D)}}S("audioBlob"),S("videoBlob"),S("gifBlob")}h.onerror=i.onError,h.onsuccess=function(){if(p=h.result,p.onerror=i.onError,p.setVersion)if(p.version!==e){var a=p.setVersion(e);a.onsuccess=function(){m(p),w()}}else w();else w()},h.onupgradeneeded=function(a){m(a.target.result)}},Fetch:function(i){return this.callback=i,this.init(),this},Store:function(i){return this.audioBlob=i.audioBlob,this.videoBlob=i.videoBlob,this.gifBlob=i.gifBlob,this.init(),this},onError:function(i){console.error(JSON.stringify(i,null,"	"))},dataStoreName:"recordRTC",dbName:null};typeof r<"u"&&(r.DiskStorage=be);/**
 * GifRecorder is standalone calss used by {@link RecordRTC} to record video or canvas into animated gif.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef GifRecorder
 * @class
 * @example
 * var recorder = new GifRecorder(mediaStream || canvas || context, { onGifPreview: function, onGifRecordingStarted: function, width: 1280, height: 720, frameRate: 200, quality: 10 });
 * recorder.record();
 * recorder.stop(function(blob) {
 *     img.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object or HTMLCanvasElement or CanvasRenderingContext2D.
 * @param {object} config - {disableLogs:true, initCallback: function, width: 320, height: 240, frameRate: 200, quality: 10}
 */function se(i,e){if(typeof GIFEncoder>"u"){var o=document.createElement("script");o.src="https://www.webrtc-experiment.com/gif-recorder.js",(document.body||document.documentElement).appendChild(o)}e=e||{};var p=i instanceof CanvasRenderingContext2D||i instanceof HTMLCanvasElement;this.record=function(){if(typeof GIFEncoder>"u"){setTimeout(T.record,1e3);return}if(!S){setTimeout(T.record,1e3);return}p||(e.width||(e.width=D.offsetWidth||320),e.height||(e.height=D.offsetHeight||240),e.video||(e.video={width:e.width,height:e.height}),e.canvas||(e.canvas={width:e.width,height:e.height}),w.width=e.canvas.width||320,w.height=e.canvas.height||240,D.width=e.video.width||320,D.height=e.video.height||240),M=new GIFEncoder,M.setRepeat(0),M.setDelay(e.frameRate||200),M.setQuality(e.quality||10),M.start(),typeof e.onGifRecordingStarted=="function"&&e.onGifRecordingStarted();function C(z){if(T.clearedRecordedData!==!0){if(h)return setTimeout(function(){C(z)},100);k=u(C),typeof I===void 0&&(I=z),!(z-I<90)&&(!p&&D.paused&&D.play(),p||a.drawImage(D,0,0,w.width,w.height),e.onGifPreview&&e.onGifPreview(w.toDataURL("image/png")),M.addFrame(a),I=z)}}k=u(C),e.initCallback&&e.initCallback()},this.stop=function(C){C=C||function(){},k&&j(k),this.blob=new Blob([new Uint8Array(M.stream().bin)],{type:"image/gif"}),C(this.blob),M.stream().bin=[]};var h=!1;this.pause=function(){h=!0},this.resume=function(){h=!1},this.clearRecordedData=function(){T.clearedRecordedData=!0,m()};function m(){M&&(M.stream().bin=[])}this.name="GifRecorder",this.toString=function(){return this.name};var w=document.createElement("canvas"),a=w.getContext("2d");p&&(i instanceof CanvasRenderingContext2D?(a=i,w=a.canvas):i instanceof HTMLCanvasElement&&(a=i.getContext("2d"),w=i));var S=!0;if(!p){var D=document.createElement("video");D.muted=!0,D.autoplay=!0,D.playsInline=!0,S=!1,D.onloadedmetadata=function(){S=!0},Ce(i,D),D.play()}var k=null,I,M,T=this}typeof r<"u"&&(r.GifRecorder=se);function ht(i,e){var o="Fake/5.0 (FakeOS) AppleWebKit/123 (KHTML, like Gecko) Fake/12.3.4567.89 Fake/123.45";(function(s){typeof r<"u"||s&&(typeof window<"u"||typeof ee>"u"||(ee.navigator={userAgent:o,getUserMedia:function(){}},ee.console||(ee.console={}),(typeof ee.console.log>"u"||typeof ee.console.error>"u")&&(ee.console.error=ee.console.log=ee.console.log||function(){console.log(arguments)}),typeof document>"u"&&(s.document={documentElement:{appendChild:function(){return""}}},document.createElement=document.captureStream=document.mozCaptureStream=function(){var b={getContext:function(){return b},play:function(){},pause:function(){},drawImage:function(){},toDataURL:function(){return""},style:{}};return b},s.HTMLVideoElement=function(){}),typeof location>"u"&&(s.location={protocol:"file:",href:"",hash:""}),typeof screen>"u"&&(s.screen={width:0,height:0}),typeof D>"u"&&(s.URL={createObjectURL:function(){return""},revokeObjectURL:function(){return""}}),s.window=ee))})(typeof ee<"u"?ee:null),e=e||"multi-streams-mixer";var p=[],h=!1,m=document.createElement("canvas"),w=m.getContext("2d");m.style.opacity=0,m.style.position="absolute",m.style.zIndex=-1,m.style.top="-1000em",m.style.left="-1000em",m.className=e,(document.body||document.documentElement).appendChild(m),this.disableLogs=!1,this.frameInterval=10,this.width=360,this.height=240,this.useGainNode=!0;var a=this,S=window.AudioContext;typeof S>"u"&&(typeof webkitAudioContext<"u"&&(S=webkitAudioContext),typeof mozAudioContext<"u"&&(S=mozAudioContext));var D=window.URL;typeof D>"u"&&typeof webkitURL<"u"&&(D=webkitURL),typeof navigator<"u"&&typeof navigator.getUserMedia>"u"&&(typeof navigator.webkitGetUserMedia<"u"&&(navigator.getUserMedia=navigator.webkitGetUserMedia),typeof navigator.mozGetUserMedia<"u"&&(navigator.getUserMedia=navigator.mozGetUserMedia));var k=window.MediaStream;typeof k>"u"&&typeof webkitMediaStream<"u"&&(k=webkitMediaStream),typeof k<"u"&&typeof k.prototype.stop>"u"&&(k.prototype.stop=function(){this.getTracks().forEach(function(s){s.stop()})});var I={};typeof S<"u"?I.AudioContext=S:typeof webkitAudioContext<"u"&&(I.AudioContext=webkitAudioContext);function M(s,b){"srcObject"in b?b.srcObject=s:"mozSrcObject"in b?b.mozSrcObject=s:b.srcObject=s}this.startDrawingFrames=function(){T()};function T(){if(!h){var s=p.length,b=!1,F=[];if(p.forEach(function(J){J.stream||(J.stream={}),J.stream.fullcanvas?b=J:F.push(J)}),b)m.width=b.stream.width,m.height=b.stream.height;else if(F.length){m.width=s>1?F[0].width*2:F[0].width;var E=1;(s===3||s===4)&&(E=2),(s===5||s===6)&&(E=3),(s===7||s===8)&&(E=4),(s===9||s===10)&&(E=5),m.height=F[0].height*E}else m.width=a.width||360,m.height=a.height||240;b&&b instanceof HTMLVideoElement&&C(b),F.forEach(function(J,Y){C(J,Y)}),setTimeout(T,a.frameInterval)}}function C(s,b){if(!h){var F=0,E=0,J=s.width,Y=s.height;b===1&&(F=s.width),b===2&&(E=s.height),b===3&&(F=s.width,E=s.height),b===4&&(E=s.height*2),b===5&&(F=s.width,E=s.height*2),b===6&&(E=s.height*3),b===7&&(F=s.width,E=s.height*3),typeof s.stream.left<"u"&&(F=s.stream.left),typeof s.stream.top<"u"&&(E=s.stream.top),typeof s.stream.width<"u"&&(J=s.stream.width),typeof s.stream.height<"u"&&(Y=s.stream.height),w.drawImage(s,F,E,J,Y),typeof s.stream.onRender=="function"&&s.stream.onRender(w,F,E,J,Y,b)}}function z(){h=!1;var s=K(),b=f();return b&&b.getTracks().filter(function(F){return F.kind==="audio"}).forEach(function(F){s.addTrack(F)}),i.forEach(function(F){F.fullcanvas}),s}function K(){q();var s;"captureStream"in m?s=m.captureStream():"mozCaptureStream"in m?s=m.mozCaptureStream():a.disableLogs||console.error("Upgrade to latest Chrome or otherwise enable this flag: chrome://flags/#enable-experimental-web-platform-features");var b=new k;return s.getTracks().filter(function(F){return F.kind==="video"}).forEach(function(F){b.addTrack(F)}),m.stream=b,b}function f(){I.AudioContextConstructor||(I.AudioContextConstructor=new I.AudioContext),a.audioContext=I.AudioContextConstructor,a.audioSources=[],a.useGainNode===!0&&(a.gainNode=a.audioContext.createGain(),a.gainNode.connect(a.audioContext.destination),a.gainNode.gain.value=0);var s=0;if(i.forEach(function(b){if(b.getTracks().filter(function(E){return E.kind==="audio"}).length){s++;var F=a.audioContext.createMediaStreamSource(b);a.useGainNode===!0&&F.connect(a.gainNode),a.audioSources.push(F)}}),!!s)return a.audioDestination=a.audioContext.createMediaStreamDestination(),a.audioSources.forEach(function(b){b.connect(a.audioDestination)}),a.audioDestination.stream}function $(s){var b=document.createElement("video");return M(s,b),b.className=e,b.muted=!0,b.volume=0,b.width=s.width||a.width||360,b.height=s.height||a.height||240,b.play(),b}this.appendStreams=function(s){if(!s)throw"First parameter is required.";s instanceof Array||(s=[s]),s.forEach(function(b){var F=new k;if(b.getTracks().filter(function(Y){return Y.kind==="video"}).length){var E=$(b);E.stream=b,p.push(E),F.addTrack(b.getTracks().filter(function(Y){return Y.kind==="video"})[0])}if(b.getTracks().filter(function(Y){return Y.kind==="audio"}).length){var J=a.audioContext.createMediaStreamSource(b);a.audioDestination=a.audioContext.createMediaStreamDestination(),J.connect(a.audioDestination),F.addTrack(a.audioDestination.stream.getTracks().filter(function(Y){return Y.kind==="audio"})[0])}i.push(F)})},this.releaseStreams=function(){p=[],h=!0,a.gainNode&&(a.gainNode.disconnect(),a.gainNode=null),a.audioSources.length&&(a.audioSources.forEach(function(s){s.disconnect()}),a.audioSources=[]),a.audioDestination&&(a.audioDestination.disconnect(),a.audioDestination=null),a.audioContext&&a.audioContext.close(),a.audioContext=null,w.clearRect(0,0,m.width,m.height),m.stream&&(m.stream.stop(),m.stream=null)},this.resetVideoStreams=function(s){s&&!(s instanceof Array)&&(s=[s]),q(s)};function q(s){p=[],s=s||i,s.forEach(function(b){if(b.getTracks().filter(function(E){return E.kind==="video"}).length){var F=$(b);F.stream=b,p.push(F)}})}this.name="MultiStreamsMixer",this.toString=function(){return this.name},this.getMixedStream=z}typeof r>"u"&&(c.exports=ht);/**
 * MultiStreamRecorder can record multiple videos in single container.
 * @summary Multi-videos recorder.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef MultiStreamRecorder
 * @class
 * @example
 * var options = {
 *     mimeType: 'video/webm'
 * }
 * var recorder = new MultiStreamRecorder(ArrayOfMediaStreams, options);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 *
 *     // or
 *     var blob = recorder.blob;
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStreams} mediaStreams - Array of MediaStreams.
 * @param {object} config - {disableLogs:true, frameInterval: 1, mimeType: "video/webm"}
 */function vt(i,e){i=i||[];var o=this,p,h;e=e||{elementClass:"multi-streams-mixer",mimeType:"video/webm",video:{width:360,height:240}},e.frameInterval||(e.frameInterval=10),e.video||(e.video={}),e.video.width||(e.video.width=360),e.video.height||(e.video.height=240),this.record=function(){p=new ht(i,e.elementClass||"multi-streams-mixer"),m().length&&(p.frameInterval=e.frameInterval||10,p.width=e.video.width||360,p.height=e.video.height||240,p.startDrawingFrames()),e.previewStream&&typeof e.previewStream=="function"&&e.previewStream(p.getMixedStream()),h=new re(p.getMixedStream(),e),h.record()};function m(){var w=[];return i.forEach(function(a){X(a,"video").forEach(function(S){w.push(S)})}),w}this.stop=function(w){h&&h.stop(function(a){o.blob=a,w(a),o.clearRecordedData()})},this.pause=function(){h&&h.pause()},this.resume=function(){h&&h.resume()},this.clearRecordedData=function(){h&&(h.clearRecordedData(),h=null),p&&(p.releaseStreams(),p=null)},this.addStreams=function(w){if(!w)throw"First parameter is required.";w instanceof Array||(w=[w]),i.concat(w),!(!h||!p)&&(p.appendStreams(w),e.previewStream&&typeof e.previewStream=="function"&&e.previewStream(p.getMixedStream()))},this.resetVideoStreams=function(w){p&&(w&&!(w instanceof Array)&&(w=[w]),p.resetVideoStreams(w))},this.getMixer=function(){return p},this.name="MultiStreamRecorder",this.toString=function(){return this.name}}typeof r<"u"&&(r.MultiStreamRecorder=vt);/**
 * RecordRTCPromisesHandler adds promises support in {@link RecordRTC}. Try a {@link https://github.com/muaz-khan/RecordRTC/blob/master/simple-demos/RecordRTCPromisesHandler.html|demo here}
 * @summary Promises for {@link RecordRTC}
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef RecordRTCPromisesHandler
 * @class
 * @example
 * var recorder = new RecordRTCPromisesHandler(mediaStream, options);
 * recorder.startRecording()
 *         .then(successCB)
 *         .catch(errorCB);
 * // Note: You can access all RecordRTC API using "recorder.recordRTC" e.g. 
 * recorder.recordRTC.onStateChanged = function(state) {};
 * recorder.recordRTC.setRecordingDuration(5000);
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - Single media-stream object, array of media-streams, html-canvas-element, etc.
 * @param {object} config - {type:"video", recorderType: MediaStreamRecorder, disableLogs: true, numberOfAudioChannels: 1, bufferSize: 0, sampleRate: 0, video: HTMLVideoElement, etc.}
 * @throws Will throw an error if "new" keyword is not used to initiate "RecordRTCPromisesHandler". Also throws error if first argument "MediaStream" is missing.
 * @requires {@link RecordRTC}
 */function Dt(i,e){if(!this)throw'Use "new RecordRTCPromisesHandler()"';if(typeof i>"u")throw'First argument "MediaStream" is required.';var o=this;o.recordRTC=new r(i,e),this.startRecording=function(){return new Promise(function(p,h){try{o.recordRTC.startRecording(),p()}catch(m){h(m)}})},this.stopRecording=function(){return new Promise(function(p,h){try{o.recordRTC.stopRecording(function(m){if(o.blob=o.recordRTC.getBlob(),!o.blob||!o.blob.size){h("Empty blob.",o.blob);return}p(m)})}catch(m){h(m)}})},this.pauseRecording=function(){return new Promise(function(p,h){try{o.recordRTC.pauseRecording(),p()}catch(m){h(m)}})},this.resumeRecording=function(){return new Promise(function(p,h){try{o.recordRTC.resumeRecording(),p()}catch(m){h(m)}})},this.getDataURL=function(p){return new Promise(function(h,m){try{o.recordRTC.getDataURL(function(w){h(w)})}catch(w){m(w)}})},this.getBlob=function(){return new Promise(function(p,h){try{p(o.recordRTC.getBlob())}catch(m){h(m)}})},this.getInternalRecorder=function(){return new Promise(function(p,h){try{p(o.recordRTC.getInternalRecorder())}catch(m){h(m)}})},this.reset=function(){return new Promise(function(p,h){try{p(o.recordRTC.reset())}catch(m){h(m)}})},this.destroy=function(){return new Promise(function(p,h){try{p(o.recordRTC.destroy())}catch(m){h(m)}})},this.getState=function(){return new Promise(function(p,h){try{p(o.recordRTC.getState())}catch(m){h(m)}})},this.blob=null,this.version="5.6.2"}typeof r<"u"&&(r.RecordRTCPromisesHandler=Dt);/**
 * WebAssemblyRecorder lets you create webm videos in JavaScript via WebAssembly. The library consumes raw RGBA32 buffers (4 bytes per pixel) and turns them into a webm video with the given framerate and quality. This makes it compatible out-of-the-box with ImageData from a CANVAS. With realtime mode you can also use webm-wasm for streaming webm videos.
 * @summary Video recording feature in Chrome, Firefox and maybe Edge.
 * @license {@link https://github.com/muaz-khan/RecordRTC/blob/master/LICENSE|MIT}
 * @author {@link https://MuazKhan.com|Muaz Khan}
 * @typedef WebAssemblyRecorder
 * @class
 * @example
 * var recorder = new WebAssemblyRecorder(mediaStream);
 * recorder.record();
 * recorder.stop(function(blob) {
 *     video.src = URL.createObjectURL(blob);
 * });
 * @see {@link https://github.com/muaz-khan/RecordRTC|RecordRTC Source Code}
 * @param {MediaStream} mediaStream - MediaStream object fetched using getUserMedia API or generated using captureStreamUntilEnded or WebAudio API.
 * @param {object} config - {webAssemblyPath:'webm-wasm.wasm',workerPath: 'webm-worker.js', frameRate: 30, width: 1920, height: 1080, bitrate: 1024, realtime: true}
 */function Ye(i,e){(typeof ReadableStream>"u"||typeof WritableStream>"u")&&console.error("Following polyfill is strongly recommended: https://unpkg.com/@mattiasbuelens/web-streams-polyfill/dist/polyfill.min.js"),e=e||{},e.width=e.width||640,e.height=e.height||480,e.frameRate=e.frameRate||30,e.bitrate=e.bitrate||1200,e.realtime=e.realtime||!0;var o;function p(){return new ReadableStream({start:function(D){var k=document.createElement("canvas"),I=document.createElement("video"),M=!0;I.srcObject=i,I.muted=!0,I.height=e.height,I.width=e.width,I.volume=0,I.onplaying=function(){k.width=e.width,k.height=e.height;var T=k.getContext("2d"),C=1e3/e.frameRate,z=setInterval(function(){if(o&&(clearInterval(z),D.close()),M&&(M=!1,e.onVideoProcessStarted&&e.onVideoProcessStarted()),T.drawImage(I,0,0),D._controlledReadableStream.state!=="closed")try{D.enqueue(T.getImageData(0,0,e.width,e.height))}catch{}},C)},I.play()}})}var h;function m(D,k){if(!e.workerPath&&!k){o=!1,fetch("https://unpkg.com/webm-wasm@latest/dist/webm-worker.js").then(function(M){M.arrayBuffer().then(function(T){m(D,T)})});return}if(!e.workerPath&&k instanceof ArrayBuffer){var I=new Blob([k],{type:"text/javascript"});e.workerPath=y.createObjectURL(I)}e.workerPath||console.error("workerPath parameter is missing."),h=new Worker(e.workerPath),h.postMessage(e.webAssemblyPath||"https://unpkg.com/webm-wasm@latest/dist/webm-wasm.wasm"),h.addEventListener("message",function(M){M.data==="READY"?(h.postMessage({width:e.width,height:e.height,bitrate:e.bitrate||1200,timebaseDen:e.frameRate||30,realtime:e.realtime}),p().pipeTo(new WritableStream({write:function(T){if(o){console.error("Got image, but recorder is finished!");return}h.postMessage(T.data.buffer,[T.data.buffer])}}))):M.data&&(w||S.push(M.data))})}this.record=function(){S=[],w=!1,this.blob=null,m(i),typeof e.initCallback=="function"&&e.initCallback()};var w;this.pause=function(){w=!0},this.resume=function(){w=!1};function a(D){if(!h){D&&D();return}h.addEventListener("message",function(k){k.data===null&&(h.terminate(),h=null,D&&D())}),h.postMessage(null)}var S=[];this.stop=function(D){o=!0;var k=this;a(function(){k.blob=new Blob(S,{type:"video/webm"}),D(k.blob)})},this.name="WebAssemblyRecorder",this.toString=function(){return this.name},this.clearRecordedData=function(){S=[],w=!1,this.blob=null},this.blob=null}typeof r<"u"&&(r.WebAssemblyRecorder=Ye)}(pt)),pt.exports}var ao=no();const so=Yt(ao),lo={key:0,class:"alert alert-danger flex h-16 items-center justify-between px-6"},uo={class:""},co={key:1,class:"flex h-16 items-center justify-between rounded-md bg-gray-50 px-4 shadow-sm dark:bg-dark-800"},fo={class:"mr-3 flex flex-1 items-center justify-end"},po={key:0,class:"flex items-center gap-2"},mo={class:"flex items-center gap-1"},ho={class:"text-sm font-medium text-red-600 dark:text-red-400"},vo={class:"text-sm font-medium text-gray-600 dark:text-gray-300"},go={class:"rounded-full bg-slate-200 dark:bg-dark-600"},bo=["src"],yo={class:"mr-2 flex items-center gap-3"},wo=["disabled"],xo={__name:"VoiceRecorder",props:{store:{type:Object,required:!0}},setup(c){const r=Ie(),d=ve({blob:null,url:null,file:null,isRecording:!1,duration:0}),g=ve(!0),l=ve(null),_=ve(null),u=et(()=>{const H=Math.floor(d.value.duration/60),W=d.value.duration%60;return`${H.toString().padStart(2,"0")}:${W.toString().padStart(2,"0")}`}),Q=async()=>{try{const H=await navigator.mediaDevices.getUserMedia({audio:!0});l.value=new so(H,{type:"audio"}),l.value.startRecording(),d.value.isRecording=!0,d.value.duration=0,_.value=setInterval(()=>{d.value.duration++},1e3)}catch(H){console.error("Error accessing microphone:",H),g.value=!1,d.value.isRecording=!1}},j=()=>{l.value&&l.value.stopRecording(()=>{d.value.blob=l.value.getBlob(),d.value.url=URL.createObjectURL(d.value.blob),_.value&&clearInterval(_.value);try{const H=l.value.stream;H&&H.getTracks&&H.getTracks().forEach(W=>W.stop())}catch(H){console.warn("Could not stop media tracks:",H)}finally{d.value.isRecording=!1,l.value.destroy(),l.value=null}})},O=()=>{d.value.url&&URL.revokeObjectURL(d.value.url),d.value.url=null,d.value.blob=null,d.value.file=null,d.value.isRecording=!1,d.value.duration=0},y=()=>{j(),O(),r.inputMessage.type="text"},B=()=>{r.inputMessage.type="voice",r.inputMessage.attachments=[d.value.blob],r.submitMessage()},x=()=>{window.location.reload()};return Kt(()=>{_.value&&clearInterval(_.value),l.value&&(l.value.destroy(),l.value=null),d.value.url&&URL.revokeObjectURL(d.value.url)}),(H,W)=>{const A=ze("Icon");return g.value?(v(),R("div",co,[n("button",{type:"button",onClick:y,class:"flex h-8 w-8 items-center justify-center rounded-full transition-colors hover:bg-gray-200 dark:hover:bg-dark-700"},[P(A,{icon:"bx:x",class:"text-gray-600 dark:text-gray-300"})]),n("div",fo,[d.value.isRecording?(v(),R("div",po,[n("div",mo,[W[0]||(W[0]=n("div",{class:"h-3 w-3 animate-pulse rounded-full bg-red-500"},null,-1)),n("span",ho,L(u.value),1)]),n("div",vo,L(H.trans("Recording"))+"... ",1)])):G("",!0),n("div",go,[d.value.url&&!d.value.isRecording?(v(),R("audio",{key:0,src:d.value.url,controls:"",class:"h-10 w-64 opacity-60 dark:opacity-50"},null,8,bo)):G("",!0)])]),n("div",yo,[d.value.url?(v(),R("button",{key:0,type:"button",onClick:O,class:"flex h-8 w-8 items-center justify-center rounded-full transition-colors hover:bg-gray-200 dark:hover:bg-dark-700"},[P(A,{icon:"bx:trash",class:"text-red-500 dark:text-red-400"})])):G("",!0),!d.value.url&&!d.value.isRecording?(v(),R("button",{key:1,type:"button",onClick:Q,class:"flex h-8 w-8 items-center justify-center rounded-full bg-gray-200 transition-colors hover:bg-gray-300 dark:bg-dark-700 dark:hover:bg-dark-600"},[P(A,{icon:"bx:microphone",class:"text-gray-700 dark:text-gray-200"})])):!d.value.url&&d.value.isRecording?(v(),R("button",{key:2,type:"button",onClick:j,class:"flex h-8 w-8 items-center justify-center rounded-full bg-red-100 transition-colors hover:bg-red-200 dark:bg-red-900/30 dark:hover:bg-red-900/50"},[P(A,{icon:"bx:stop",class:"text-xl text-red-600 dark:text-red-400"})])):G("",!0),d.value.url&&!d.value.isRecording?(v(),R("button",{key:3,onClick:B,disabled:t(r).loading.sendingMessage,class:"flex h-8 w-8 items-center justify-center rounded-full bg-green-500 transition-colors hover:bg-green-600"},[t(r).loading.sendingMessage?(v(),te(Lt,{key:0})):(v(),te(A,{key:1,icon:"bx:send",class:"text-white"}))],8,wo)):G("",!0)])])):(v(),R("div",lo,[n("p",uo,L(H.trans("This device does not support voice recording or does not have microphone access.")),1),n("button",{type:"button",class:"btn btn-secondary",onClick:x},L(H.trans("Reload")),1)]))}}},ko={class:"relative flex h-[calc(100vh-11rem)] w-full flex-col overflow-hidden rounded-md bg-white shadow transition-all dark:bg-dark-800"},Ro={key:0,class:"space-y-3",id:"scrollContainerRef"},Co={key:0},_o={class:"mt-4 text-center text-sm font-semibold italic text-gray-300"},So={key:1,class:"text-center"},Mo={class:"flex gap-x-3 group-[.pr]:flex-row-reverse"},To={key:0,class:"avatar avatar-circle avatar-sm shrink-0"},Lo=["src"],$o={class:"flex max-w-sm flex-col items-start group-[.pr]:items-end"},Ao={key:0,class:"rounded-t-lg bg-white bg-opacity-50 p-2 text-sm italic text-gray-500"},Io={class:"flex items-center"},Do=["onClick"],Bo={class:"mb-2 space-x-2"},Uo=["title"],Fo={key:0,class:"text-sm text-red-500"},Oo=["title"],Eo={key:0,class:"bx bx-circle"},Po={key:1,class:"bx bx-check"},jo={key:2,class:"bx bx-check-double"},Vo={key:3,class:"bx bx-check-double text-green-600"},qo={key:4,class:"bx bx-info-circle text-red-600"},No={key:1,class:"h-200 flex items-center justify-center"},zo={class:"text-center italic text-slate-600"},Wo={class:"relative rounded-b-primary border-t bg-white dark:border-dark-700 dark:bg-dark-800"},Go={key:0,class:"alert alert-danger flex justify-between p-2"},Ho={class:"flex items-center gap-x-4 px-4"},Qo={class:"relative"},Yo={key:0,class:"absolute bottom-full right-0 mb-2 space-y-2 rounded-md bg-dark-900 p-3"},Ko={type:"submit"},Jo={key:1,class:"bx bx-send"},Vn={__name:"MessageContainer",setup(c){const d=Dr(Ir).greater("md"),g=_t({loader:async()=>await Tt(Object.assign({"../../../../modules/Whatsapp/resources/js/Components/MessagePreview.vue":()=>St(()=>import("./MessagePreview-LrLBvRmp.js"),__vite__mapDeps([0,1,2,3]))}),`../../../../modules/${u.getActiveModuleName}/resources/js/Components/MessagePreview.vue`,10),loadingComponent:It,errorComponent:At,delay:500,timeout:5e3}),l=()=>{axios.get(route("user.conversations.api",{data:"ai_templates"})).then(y=>{u.$patch({aiTemplates:y.data.data})}).catch(y=>console.error(y))};st(()=>{l()});const _=nr(),u=Ie(),Q=je(),j=y=>{_.openModal({load:y,multiple:!0,caption:["audio","voice"].includes(y)?void 0:"",button:{text:"Send"},onOpen:()=>{u.assetPopup=!1,u.inputMessage.type=y},onSelect:B=>{},onSubmit:(B,x)=>{var H;if(u.inputMessage.attachments=B.map(W=>W.path),u.inputMessage.caption=x.caption,((H=u.inputMessage.attachments)==null?void 0:H.length)===0)return Ge.warning("Please select at least one attachment");u.submitMessage()}})},O=()=>{if(u.inputMessage.type="text",u.inputMessage.message.length===0)return Ge.warning("Please enter a message");u.submitMessage()};return(y,B)=>{var H,W,A,U;const x=ze("Icon");return v(),R("div",ko,[P(Kr),n("div",{class:Ae(["styled-scrollbar whatsapp-chat-body relative h-[90%] overflow-auto px-4 pb-8",`${y.$page.props.activeModule}-chat-body`])},[(H=t(u).activeConversationMessages)!=null&&H.length?(v(),R("ul",Ro,[t(u).activeConversation.no_more_messages?(v(),R("li",Co,[n("p",_o,L(y.trans("No more messages")),1)])):(v(),R("li",So,[P(Mt,{loader:t(u).loading.messages,afterIntersection:()=>t(u).loadMoreMessages()},null,8,["loader","afterIntersection"])])),(v(!0),R(he,null,Ee(t(u).activeConversationMessages,(N,ie)=>{var Z,X,Ce,Le,fe,de,re,ge,V,ae;return v(),R("li",{class:Ae(["group",{pr:N.direction=="out"}]),key:ie},[n("div",Mo,[N.direction=="in"?(v(),R("div",To,[n("img",{src:(X=(Z=t(u).activeConversation)==null?void 0:Z.customer)==null?void 0:X.picture,class:"avatar-img",alt:"profile-img"},null,8,Lo)])):G("",!0),n("div",$o,[(Le=(Ce=N.meta)==null?void 0:Ce.context)!=null&&Le.id?(v(),R("p",Ao,L((de=(fe=N.meta)==null?void 0:fe.context)==null?void 0:de.title),1)):G("",!0),n("div",Io,[P(t(g),{message:N},null,8,["message"]),N.direction=="in"?(v(),R("button",{key:0,onClick:_e=>t(u).setReplying(N),class:"ms-1 rounded-full bg-gray-200 p-1 text-xl text-black hover:bg-gray-500"},[P(x,{icon:"bx:reply"})],8,Do)):G("",!0)]),n("div",Bo,[n("span",{class:"text-xs font-normal text-slate-400",title:t(nt)(N.created_at).local().format("D MMM, YYYY h:mm A")},L(t(nt)(N.created_at).local().format("D MMM, h:mm A")),9,Uo),N.status=="failed"?(v(),R("span",Fo,L(y.trans("message sending failed")),1)):G("",!0),N.direction=="out"?(v(),R("span",{key:1,class:"font-bolder ml-1 text-slate-300",title:N.status=="failed"?(ae=(V=(ge=(re=N.meta)==null?void 0:re.errors)==null?void 0:ge[0])==null?void 0:V.error_data)==null?void 0:ae.details:N.status},[N.status=="pending"?(v(),R("i",Eo)):N.status=="sent"?(v(),R("i",Po)):N.status=="delivered"?(v(),R("i",jo)):N.status=="read"?(v(),R("i",Vo)):N.status=="failed"?(v(),R("i",qo)):G("",!0)],8,Oo)):G("",!0)])])])],2)}),128))])):(v(),R("div",No,[n("p",zo,L(y.trans("No messages")),1)]))],2),n("div",Wo,[((A=(W=t(u).activeConversation)==null?void 0:W.meta)==null?void 0:A.is_24h_passed)==!0?(v(),R("div",Go,[n("p",null,L(y.trans(`This conversation is unavailable, more then 24 hours have passed since the customer
          last replied to this number.`)),1),n("button",{type:"button",class:"btn btn-sm btn-dark",onClick:B[0]||(B[0]=N=>t(u).activeConversation.meta.is_24h_passed=!1)},L(y.trans("Dismiss")),1)])):(v(),R(he,{key:1},[t(u).isReplying?(v(),te(io,{key:0})):G("",!0),t(u).inputMessage.type==="voice"?(v(),te(xo,{key:1,store:t(u)},null,8,["store"])):G("",!0),me(P(Zr,null,null,512),[[Jt,t(u).quickReplySuggestionItems.length>0]]),t(u).inputMessage.type!="voice"?(v(),R("form",{key:2,onSubmit:Pe(O,["prevent"]),class:"flex items-center rounded-primary shadow"},[P(Or,{id:"inputMessageField",modelValue:t(u).inputMessage.message,"onUpdate:modelValue":B[1]||(B[1]=N=>t(u).inputMessage.message=N),placeholder:`Type message...${t(d)?"enter to send, shift+enter to next line":""}`,disabled:t(u).loading.sendingMessage,onKeydown:[Oe(Pe(t(u).selectQuickReply,["prevent"]),["tab"]),Oe(Pe(O,["exact","prevent"]),["enter"])],onKeyup:[Oe(t(u).onArrowDown,["down"]),Oe(t(u).onArrowUp,["up"])],autofocus:""},null,8,["modelValue","placeholder","disabled","onKeydown","onKeyup"]),n("div",Ho,[(U=t(u).features)!=null&&U.voice_message?(v(),R("button",{key:0,type:"button",onClick:B[2]||(B[2]=N=>t(u).inputMessage.type="voice"),title:"Voice",class:"text-slate-500 hover:text-primary-500 focus:text-primary-500 dark:text-slate-400 dark:hover:text-primary-500 dark:focus:text-primary-500"},B[11]||(B[11]=[n("i",{class:"bx bxs-microphone"},null,-1)]))):G("",!0),n("div",Qo,[n("button",{id:"btn-upload-media",onClick:B[3]||(B[3]=N=>t(u).assetPopup=!t(u).assetPopup),type:"button",title:"Media",class:"text-slate-500 hover:text-primary-500 focus:text-primary-500 dark:text-slate-400 dark:hover:text-primary-500 dark:focus:text-primary-500"},[P(x,{icon:"bx:link-alt"})]),t(u).assetPopup?(v(),R("div",{key:0,class:"fixed inset-0 bg-transparent",onClick:B[4]||(B[4]=N=>t(u).assetPopup=!1)})):G("",!0),P(Xt,{name:"fade"},{default:Ne(()=>[t(u).assetPopup?(v(),R("div",Yo,[n("button",{onClick:B[5]||(B[5]=()=>j("document")),type:"button",class:"btn btn-dark btn-xs w-full"},[P(x,{icon:"bx:file"}),n("span",null,L(y.trans("Documents")),1)]),n("button",{onClick:B[6]||(B[6]=N=>j("image")),type:"button",class:"btn btn-dark btn-xs w-full"},[P(x,{icon:"bx:image"}),n("span",null,L(y.trans("Image")),1)]),n("button",{onClick:B[7]||(B[7]=()=>j("video")),type:"button",class:"btn btn-dark btn-xs w-full"},[P(x,{icon:"bx:video"}),n("span",null,L(y.trans("Video")),1)]),n("button",{onClick:B[8]||(B[8]=()=>j("audio")),type:"button",class:"btn btn-dark btn-xs w-full"},[P(x,{icon:"bx:microphone"}),n("span",null,L(y.trans("Audio")),1)])])):G("",!0)]),_:1})]),n("button",{type:"button",onClick:B[9]||(B[9]=(...N)=>t(u).quickReplyModalOpen&&t(u).quickReplyModalOpen(...N)),title:"Quick Reply",class:"text-slate-500 hover:text-primary-500 focus:text-primary-500 dark:text-slate-400 dark:hover:text-primary-500 dark:focus:text-primary-500"},B[12]||(B[12]=[n("i",{class:"bx bxs-layer"},null,-1)])),n("button",{type:"button",onClick:B[10]||(B[10]=N=>t(Q).open("templateModal")),title:"Templates",class:"text-slate-500 hover:text-primary-500 focus:text-primary-500 dark:text-slate-400 dark:hover:text-primary-500 dark:focus:text-primary-500"},B[13]||(B[13]=[n("i",{class:"bx bxs-grid"},null,-1)])),n("button",Ko,[t(u).loading.sendingMessage?(v(),te(Lt,{key:0})):(v(),R("i",Jo))])])],32)):G("",!0)],64))])])}}},{pickBy:Xo}=at(),Zo=wt("aiToolsStore",{state:()=>({props:{},generatedText:"",documentName:"",fieldErrors:{},errors:{},hasError:!1,isProcessing:!1,form:Qe({prompt:"",language:"english",tone:"",max_token:200,qty:1,creativity:"",seconds:0,init_audio:null,model:"",template_id:"",fields:""}),tones:["Professional","Funny","Casual","Excited","Bold","Dramatic"],creativityLevels:[{label:"Optimal",value:.5},{label:"Low",value:.8},{label:"Medium",value:.9},{label:"High",value:1}]}),actions:{setInitialState(c){this.form=c},transformPrompt(){const c=[];this.form.fields.forEach(r=>{if(r.hasOwnProperty("value"))c[r.name]=r.value,this.hasError=!1;else{this.hasError=!0,this.fieldErrors[r.name]=`${r.name} is required`;return}}),this.form.prompt=this.props.template.prompt.replace(/\[(.*?)\]/g,(r,d)=>c[d])},generateText(){qe.post(route("api-ai-generate-text",Xo(this.form))).then(async c=>{for(const r of c.data)r&&(this.generatedText+=" "+r),await new Promise(d=>setTimeout(d,100))}).catch(c=>{this.errors=c.response.data.errors,c.response.status==400&&Ge.danger("You don't have enough credits please purchase some credits"),Ge.danger(c.response.data.message??"Error generating text please try again later")}).finally(()=>{this.isProcessing=!1,this.fieldErrors={}})},submit(){if(this.props.template.credit_charge*this.form.qty>this.props.credits){Ge.danger("You don't have enough credits please purchase some credits");return}this.transformPrompt(),!this.hasError&&(this.isProcessing=!0,this.generateText())},downloadHTMLFile(c,r){const d=new Blob([c],{type:"text/html"}),g=document.createElement("a");g.href=URL.createObjectURL(d),g.download=r?r.replace(" ","-"):"untitled.html",g.click(),URL.revokeObjectURL(g.href)}}}),ei={class:"group mb-2 mt-3 flex items-center rounded-lg"},ti={class:"styled-scrollbar max-h-[560px] space-y-2 overflow-y-auto"},ri={class:"mt-1 h-[22rem]"},oi={class:"flex justify-between text-end text-xs font-normal text-slate-400"},ii={key:0,class:"mt-5 text-center text-lg"},ni={key:1,class:"mt-5 text-center text-lg"},ai={key:2,class:"p-16",src:"/assets/svg/search_vimp.svg",alt:""},si={__name:"FindMessageModal",setup(c){const{debounce:r}=at(),d=Ie(),g=_t({loader:async()=>await Tt(Object.assign({"../../../../modules/Whatsapp/resources/js/Components/MessagePreview.vue":()=>St(()=>import("./MessagePreview-LrLBvRmp.js"),__vite__mapDeps([0,1,2,3]))}),`../../../../modules/${d.getActiveModuleName}/resources/js/Components/MessagePreview.vue`,10),loadingComponent:It,errorComponent:At,timeout:5e3}),l=r(()=>{d.getChatSearchedItems()},500),_=u=>{u&&setTimeout(()=>{u.focus()},300)};return(u,Q)=>(v(),te(Ze,{"header-state":!0,"header-title":"Search Message",state:"findMessageModal"},{default:Ne(()=>[n("div",ei,[me(n("input",{type:"text",class:"input",placeholder:"enter search query","onUpdate:modelValue":Q[0]||(Q[0]=j=>t(d).chatSearchInput=j),onKeyup:Q[1]||(Q[1]=(...j)=>t(l)&&t(l)(...j)),ref:_},null,544),[[Te,t(d).chatSearchInput]])]),n("div",ti,[n("div",ri,[(v(!0),R(he,null,Ee(t(d).chatSearchedItems,(j,O)=>(v(),R("div",{class:"my-1 rounded px-2 py-2 text-sm shadow-sm hover:bg-primary-100 dark:bg-dark-700 dark:hover:bg-opacity-80",key:O},[P(t(g),{message:j},null,8,["message"]),n("div",oi,[n("span",null,L(j.direction=="in"?"Received":"Sent"),1),n("span",null,L(t(nt)(j.created_at).local().format("D MMM, YYYY h:mm A")),1)])]))),128)),!t(d).loading.message_searching&&t(d).chatSearchedItems.length===0&&t(d).chatSearchInput.length>0?(v(),R("p",ii,[He(L(u.trans("No record found for: "))+" ",1),n("strong",null,'"'+L(t(d).chatSearchInput)+'"',1)])):G("",!0),t(d).loading.message_searching?(v(),R("p",ni,L(u.trans("Searching...")),1)):G("",!0),t(d).chatSearchedItems.length===0&&t(d).chatSearchInput.length===0?(v(),R("img",ai)):G("",!0)])])]),_:1}))}},li={class:"group mb-2 mt-3 flex items-center rounded-lg"},di={class:"styled-scrollbar max-h-[560px] space-y-2 overflow-y-auto"},ui={class:"mt-1 h-[22rem]"},ci=["onClick"],fi=["onClick"],pi={key:1,class:"text-center text-gray-700"},mi={__name:"QuickReplyModal",setup(c){const r=Ie();return je(),(d,g)=>(v(),te(Ze,{"header-state":!0,"header-title":"Quick reply",state:"quickReplyModal"},{default:Ne(()=>[n("div",li,[me(n("input",{type:"text",placeholder:"Search quick reply templates","onUpdate:modelValue":g[0]||(g[0]=l=>t(r).quickReplySearchInput=l),onKeydown:[g[1]||(g[1]=Oe((...l)=>t(r).onArrowDown&&t(r).onArrowDown(...l),["down"])),g[2]||(g[2]=Oe((...l)=>t(r).onArrowUp&&t(r).onArrowUp(...l),["up"])),g[3]||(g[3]=Oe(Pe((...l)=>t(r).selectQuickReply&&t(r).selectQuickReply(...l),["prevent"]),["enter"])),g[4]||(g[4]=Oe(Pe((...l)=>t(r).selectQuickReply&&t(r).selectQuickReply(...l),["prevent"]),["tab"]))],onKeyup:g[5]||(g[5]=Oe((...l)=>t(r).quickReplyModalClose&&t(r).quickReplyModalClose(...l),["esc"])),class:"input",ref:t(r).quickReplyModalSearchInput},null,544),[[Te,t(r).quickReplySearchInput]])]),n("div",di,[n("div",ui,[t(r).quickReplyFilteredItems.length>0?(v(!0),R(he,{key:0},Ee(t(r).quickReplyFilteredItems,(l,_)=>(v(),R("div",{onClick:u=>t(r).addQuickReplyToMessageInput(l),key:_},[(v(),R("div",{class:Ae(["my-1 cursor-pointer rounded px-2 py-2 text-sm shadow-sm hover:bg-primary-100 dark:bg-dark-700 dark:hover:bg-opacity-80",{"bg-primary-200 dark:bg-primary-500":t(r).arrowCounter==_}]),key:_,onClick:u=>t(r).addQuickReplyToMessageInput(l)},L(l),11,fi))],8,ci))),128)):(v(),R("div",pi,[He(L(d.trans("No record found"))+" ",1),t(r).quickReplySearchInput?(v(),R(he,{key:0},[He(L(d.trans("for"))+' "',1),n("b",null,L(t(r).quickReplySearchInput),1),g[6]||(g[6]=He('" ',-1))],64)):G("",!0)]))])])]),_:1}))}},hi={class:"mb-3 flex items-center justify-between gap-2"},vi={class:"mb-3 flex items-center justify-between gap-2"},gi=["value"],bi={key:0,class:"mt-4 grid grid-cols-1 gap-4"},yi={class:"flex items-center justify-start gap-4 border-b border-primary-600 pb-4"},wi=["onClick"],xi={alt:"image",class:"h-full w-full rounded-full"},ki=["onClick"],Ri={class:"ml-0 text-xs font-semibold capitalize"},Ci={class:"text-xs capitalize text-gray-500"},_i=["onClick"],Si=["innerHTML"],Mi={key:1,class:"mt-4 px-1"},Ti={class:"flex items-center justify-between"},Li={class:"flex items-center"},$i=["src"],Ai={class:"mx-2"},Ii={class:"text-sm leading-3"},Di={class:"text-xs capitalize text-gray-500"},Bi={class:"grid grid-cols-2 gap-3"},Ui={class:"label mb-1"},Fi={class:"label mb-1"},Oi={class:"label mb-1"},Ei=["onUpdate:modelValue","placeholder"],Pi=["onUpdate:modelValue","placeholder"],ji={class:"flex items-center gap-5"},Vi={class:"flex-1"},qi={class:"label mb-1"},Ni={class:"flex-1"},zi={class:"label mb-1"},Wi={class:"mt-4 flex flex-col gap-y-3"},Gi={class:"flex items-center gap-x-2"},Hi={class:"flex"},Qi={class:"label mb-1"},Yi={key:0,class:"flex justify-end gap-2"},qn={__name:"Modals",setup(c){const{uiAvatar:r,textExcerpt:d,trim:g}=at(),l=Ie(),_=je(),u=Zo(),Q=ve(null),j=A=>{Q.value=A;const U=l.aiTemplates.find(N=>N.id==A.id);u.$patch({props:{template:U},form:{model:A.ai_model,template_id:A.id,fields:A.fields}})},O=(A,U)=>{router.post(route("user.ai-tools.bookmark"),{ai_template_id:A},{onSuccess:()=>{U==1?toast.danger("Bookmarked Removed Successfully"):toast.success("Bookmarked Successfully")}})},y=Qe({badge_id:""}),B=()=>{y.put(route("user.conversations.badge.assign",l.activeConversationId),{onSuccess:()=>{_.close("addBadgeModal"),l.activeConversation.badge_id=y.badge_id,y.reset()}})},x=Qe({text:"",color:""}),H=()=>{x.post(route("user.badges.store"),{onSuccess:A=>{_.close("badgeModal"),x.reset(),l.badges=A.props.badges}})},{inputMessage:W}=Zt(l);return(A,U)=>{const N=ze("Icon"),ie=er("lazy");return v(),R(he,null,[P(si),P(mi),Rt(A.$slots,"dynamic-template-modal"),P(Ze,{"header-state":!0,"header-title":"Add New Badge",state:"badgeModal"},{default:Ne(()=>[n("form",{onSubmit:Pe(H,["prevent"])},[n("div",hi,[me(n("input",{type:"text",placeholder:"Badge Text","onUpdate:modelValue":U[0]||(U[0]=Z=>t(x).text=Z),class:"input"},null,512),[[Te,t(x).text]]),me(n("input",{type:"color","onUpdate:modelValue":U[1]||(U[1]=Z=>t(x).color=Z),class:""},null,512),[[Te,t(x).color]])]),P(it,{processing:t(x).processing,"btn-text":A.trans("Save"),class:"w-full"},null,8,["processing","btn-text"])],32)]),_:1}),P(Ze,{"header-state":!0,"header-title":"Assign Badge",state:"addBadgeModal"},{default:Ne(()=>[n("form",{onSubmit:Pe(B,["prevent"])},[n("div",vi,[me(n("select",{class:"select","onUpdate:modelValue":U[2]||(U[2]=Z=>t(y).badge_id=Z)},[U[15]||(U[15]=n("option",{value:""},"Select Badge",-1)),(v(!0),R(he,null,Ee(t(l).badges,Z=>(v(),R("option",{value:Z.id,key:Z.id},L(Z.text),9,gi))),128))],512),[[kt,t(y).badge_id]]),P(it,{processing:t(y).processing,"btn-text":A.trans("Save")},null,8,["processing","btn-text"])])],32)]),_:1}),P(Ze,{onClose:U[14]||(U[14]=Z=>Q.value=null),"modal-type":"sidebar","modal-size":Q.value?"w-4/12":"w-3/12","header-state":!0,"header-title":"AI Tools",state:"aiModal"},{default:Ne(()=>{var Z,X,Ce,Le,fe,de,re,ge;return[Q.value?(v(),R("div",Mi,[n("form",{onSubmit:U[8]||(U[8]=Pe((...V)=>t(u).submit&&t(u).submit(...V),["prevent"])),class:"space-y-4"},[n("div",Ti,[n("div",Li,[n("img",{src:t(r)(Q.value.title,Q.value.icon),class:"h-10 w-10 rounded-full",alt:"icon"},null,8,$i),n("div",Ai,[n("p",Ii,L(Q.value.title),1),n("small",Di,L(t(g)(Q.value.prompt_type)),1)])]),n("button",{class:"btn btn-outline-danger btn-xs",type:"button",onClick:U[3]||(U[3]=()=>{Q.value=null,t(u).form.reset(),t(u).generatedText=""})},[n("span",null,L(A.trans("Reset")),1),P(N,{icon:"bx:refresh",class:"text-lg"})])]),n("div",Bi,[n("div",null,[n("label",Ui,L(A.trans("Language"))+"*",1),P(ft,{mode:"single",class:"multiselect-dark",modelValue:t(u).form.language,"onUpdate:modelValue":U[4]||(U[4]=V=>t(u).form.language=V),options:t(l).languages,valueProp:"name","input-label":"name",placeholder:"Language"},null,8,["modelValue","options"]),(Z=t(u).errors)!=null&&Z.language?(v(),te(We,{key:0,message:(X=t(u).errors)==null?void 0:X.language[0]},null,8,["message"])):G("",!0)]),n("div",null,[n("label",Fi,L(A.trans("Tone"))+"*",1),P(ft,{mode:"single",class:"multiselect-dark",modelValue:t(u).form.tone,"onUpdate:modelValue":U[5]||(U[5]=V=>t(u).form.tone=V),options:t(u).tones,"value-prop":"",placeholder:"Tone"},null,8,["modelValue","options"]),(Ce=t(u).errors)!=null&&Ce.tone?(v(),te(We,{key:0,message:(Le=t(u).errors)==null?void 0:Le.tone[0]},null,8,["message"])):G("",!0)])]),n("div",null,[(v(!0),R(he,null,Ee(t(u).form.fields,(V,ae)=>(v(),R("div",{key:ae},[n("label",Oi,L(V.name)+"*",1),V.type==="input"?me((v(),R("input",{key:0,required:"","onUpdate:modelValue":_e=>V.value=_e,type:"text",class:"input",placeholder:V.placeholder},null,8,Ei)),[[Te,V.value]]):G("",!0),V.type==="textarea"?me((v(),R("textarea",{key:1,required:"","onUpdate:modelValue":_e=>V.value=_e,class:"textarea",placeholder:V.placeholder},null,8,Pi)),[[Te,V.value]]):G("",!0),t(u).hasError?(v(),te(We,{key:2,message:t(u).fieldErrors[V.name]},null,8,["message"])):G("",!0),!t(u).hasError&&t(u).errors&&t(u).errors["fields."+ae+".value"]?(v(),te(We,{key:3,message:t(u).errors["fields."+ae+".value"][0]},null,8,["message"])):G("",!0)]))),128))]),n("div",ji,[n("div",Vi,[n("label",qi,L(A.trans("Maximum Word Limit")),1),me(n("input",{"onUpdate:modelValue":U[6]||(U[6]=V=>t(u).form.max_token=V),type:"text",class:"input h-10",placeholder:"Maximum Length"},null,512),[[Te,t(u).form.max_token,void 0,{number:!0}]]),(fe=t(u).errors)!=null&&fe.max_token?(v(),te(We,{key:0,message:(de=t(u).errors)==null?void 0:de.max_token[0]},null,8,["message"])):G("",!0)]),n("div",Ni,[n("label",zi,L(A.trans("Creativity Level")),1),P(ft,{mode:"single",class:"multiselect-dark",modelValue:t(u).form.creativity,"onUpdate:modelValue":U[7]||(U[7]=V=>t(u).form.creativity=V),options:t(u).creativityLevels,"value-prop":"value",inputLabel:"label",placeholder:"Creativity Level"},null,8,["modelValue","options"]),(re=t(u).errors)!=null&&re.creativity?(v(),te(We,{key:0,message:t(u).errors.creativity[0]},null,8,["message"])):G("",!0)])]),P(it,{classes:"btn btn-primary w-full py-3",processing:t(u).isProcessing,"btn-text":A.trans("Generate")},null,8,["processing","btn-text"])],32),n("div",Wi,[n("div",Gi,[me(n("input",{"onUpdate:modelValue":U[9]||(U[9]=V=>t(u).documentName=V),type:"text",class:"input",placeholder:"Untitled Document..."},null,512),[[Te,t(u).documentName]]),n("div",Hi,[n("button",{class:"ms-1",onClick:U[10]||(U[10]=V=>t(u).downloadHTMLFile(t(u).generatedText,t(u).documentName))},[P(N,{icon:"bx:download",class:"size-6"})])])]),n("div",null,[n("label",Qi,L(A.trans("Generated Text")),1),me(n("textarea",{class:"textarea","onUpdate:modelValue":U[11]||(U[11]=V=>t(u).generatedText=V)},null,512),[[Te,t(u).generatedText]])]),t(u).generatedText?(v(),R("div",Yi,[n("button",{class:"btn btn-info btn-sm",type:"button",onClick:U[12]||(U[12]=V=>t(W).message=t(u).generatedText)},[P(N,{icon:"bx:pen",class:"size-4"}),n("span",null,L(A.trans("Use")),1)]),n("button",{class:"btn btn-primary btn-sm",type:"button",onClick:U[13]||(U[13]=V=>A.copyToClipboard(t(u).generatedText))},[P(N,{icon:"bx:copy",class:"size-4"}),n("span",null,L(A.trans("Copy")),1)])])):G("",!0)])])):(v(),R("div",bi,[(v(!0),R(he,null,Ee(t(l).aiTemplates,V=>(v(),R("div",{key:V.id,class:"card card-body"},[n("div",yi,[n("button",{type:"button",onClick:ae=>j(V),class:"logo h-10 w-10"},[me(n("img",xi,null,512),[[ie,t(r)(V.title,V.icon)]])],8,wi),n("button",{type:"button",class:"flex flex-col items-start",onClick:ae=>j(V)},[n("p",Ri,L(t(d)(V.title,65)),1),n("small",Ci,L(t(g)(V.prompt_type)),1)],8,ki),n("button",{onClick:ae=>O(V.id,V.isBookmarked),type:"button",class:Ae(["btn ml-auto h-8 w-8 rounded-full",{"btn-primary":V.isBookmarked==1,"btn-outline-primary":V.isBookmarked==0}])},U[16]||(U[16]=[n("i",{class:"bx bx-bookmark-alt-minus text-lg"},null,-1)]),10,_i)]),n("div",{innerHTML:t(d)(V.description,100),class:"pt-3 text-sm"},null,8,Si)]))),128))])),((ge=t(l).aiTemplates)==null?void 0:ge.length)<1?(v(),te(ar,{key:2})):G("",!0)]}),_:1},8,["modal-size"]),P(ir)],64)}}},Ki={class:"mt-3 flex flex-col items-center justify-center"},Ji=["src"],Xi={class:"absolute inset-0 z-50 flex h-full w-full items-center justify-center rounded-full bg-gray-800 bg-opacity-30 opacity-0 transition-opacity group-hover:opacity-100"},Zi={class:"mt-2 flex flex-col items-center text-sm"},en={class:"font-semibold"},tn={class:"text-gray-500"},rn={class:"mt-2"},on={class:"mt-4 space-y-4 p-4"},nn={class:"flex items-center gap-2"},an={class:"text-sm"},sn={class:"flex items-center gap-2"},ln={class:"text-sm"},dn={class:"text-sm font-bold"},un={class:"flex items-center gap-2"},cn={class:"text-sm"},fn={class:"text-sm font-bold"},pn={class:"flex items-center gap-2"},mn={class:"text-sm"},hn={class:"text-sm font-bold capitalize"},vn={class:"flex items-center gap-2"},gn={class:"text-sm"},bn={class:"text-sm font-bold"},yn={class:"flex justify-between"},wn={key:0},xn={key:1},kn={key:0,class:"alert alert-info"},Rn={key:1},Cn={class:"text-center"},_n={class:"small mb-2 italic text-gray-500"},Nn={__name:"RightSidebar",setup(c){var x,H;const r=je(),d=ve(!1),g=Ie(),l=ve(null),_=Qe({picture:"",note:((H=(x=g.activeConversation)==null?void 0:x.meta)==null?void 0:H.note)??"",update_type:null,_method:"put"}),u=W=>{_.picture=W.target.files[0],_.update_type="profile_picture",j()},Q=()=>{_.update_type="note",j()},j=()=>{_.post(route("user.conversations.update",g.activeConversationId),{onSuccess:()=>{d.value=!1,_.update_type==="profile_picture"&&(g.activeConversation.customer.picture=URL.createObjectURL(_.picture))}})},O=Qe({}),y=W=>{O.delete(route("user.conversations.badges.destroy",W),{onSuccess:()=>{g.activeConversation.badge_id=null}})},B=()=>{r.open("findMessageModal"),console.log(g.chatSearchInputRef)};return(W,A)=>{var U,N,ie,Z,X,Ce,Le,fe,de,re,ge,V,ae,_e,be;return v(),R(he,null,[n("div",{class:Ae(["card absolute overflow-y-auto right-0 z-20 ml-2 h-[calc(100vh-11rem)] w-10/12 rounded-md p-1 transition-all duration-300 lg:w-3/12",[t(g).rightSidebar.isOpen?"-translate-x-0":"translate-x-[125%]"]])},[n("button",{type:"button",onClick:A[0]||(A[0]=(...se)=>t(g).toggleRightSidebar&&t(g).toggleRightSidebar(...se)),class:"absolute left-0 top-5 z-20 inline-flex h-8 w-8 -translate-x-10 items-center justify-center rounded-full bg-black/50 text-white dark:text-slate-300"},[P(t(Re),{icon:"fe:close"})]),A[11]||(A[11]=n("h6",{class:"border-b border-gray-100 py-4 pl-3 dark:border-dark-700"},"Details",-1)),n("div",Ki,[n("button",{class:"group relative h-14 w-14",type:"button",onClick:A[1]||(A[1]=se=>l.value.click())},[n("img",{class:"h-full w-full rounded-full border object-contain object-center",src:(N=(U=t(g).activeConversation)==null?void 0:U.customer)==null?void 0:N.picture,alt:"profile-img"},null,8,Ji),n("div",Xi,[P(t(Re),{icon:"bx:camera",class:"text-lg text-gray-300"})]),n("input",{ref_key:"profilePictureRef",ref:l,class:"hidden",type:"file",onChange:u,accept:"image/jpg, image/jpeg, image/png",placeholder:"change"},null,544)]),n("div",Zi,[n("p",en,L((Z=(ie=t(g).activeConversation)==null?void 0:ie.customer)==null?void 0:Z.name),1),n("p",tn,L((Ce=(X=t(g).activeConversation)==null?void 0:X.customer)==null?void 0:Ce.uuid),1)]),n("div",rn,[n("p",{class:"cursor-pointer text-sm font-semibold text-primary-600",onClick:B},L(W.trans("Search Message")),1)])]),n("div",on,[n("div",nn,[P(t(Re),{icon:"bx:badge",class:"mt-1"}),n("span",an,L(W.trans("Badge"))+":",1),(Le=t(g).activeConversation)!=null&&Le.badge_id?(v(),R(he,{key:0},[n("span",{class:"rounded p-0 px-2 text-sm text-white",style:Ct({background:(de=t(g).getBadge((fe=t(g).activeConversation)==null?void 0:fe.badge_id))==null?void 0:de.color})},L((ge=t(g).getBadge((re=t(g).activeConversation)==null?void 0:re.badge_id))==null?void 0:ge.text),5),P(t(Re),{icon:"bx:edit",class:"cursor-pointer",onClick:A[2]||(A[2]=se=>t(r).open("addBadgeModal"))}),P(t(Re),{icon:"bx:trash",onClick:A[3]||(A[3]=se=>y(t(g).activeConversationId)),class:"cursor-pointer text-danger-700"})],64)):(v(),te(t(Re),{key:1,icon:"bx:plus",onClick:A[4]||(A[4]=se=>t(r).open("addBadgeModal")),class:"cursor-pointer"}))]),n("div",sn,[P(t(Re),{icon:"bx:message",class:"mt-1"}),n("span",ln,L(W.trans("Conversation ID")),1),n("span",dn,L(t(g).activeConversationId),1)]),n("div",un,[P(t(Re),{icon:"bx:user",class:"mt-px"}),n("span",cn,L(W.trans("Customer ID")),1),n("span",fn,L((ae=(V=t(g).activeConversation)==null?void 0:V.customer)==null?void 0:ae.uuid),1)]),n("div",pn,[P(t(Re),{icon:"bx:bxs-school",class:"mt-1"}),n("span",mn,L(W.trans("Platform")),1),n("span",hn,L((_e=t(g).activeConversation)==null?void 0:_e.module),1)]),n("div",vn,[P(t(Re),{icon:"bx:calendar",class:"mt-px"}),n("span",gn,L(W.trans("Creation Time")),1),n("span",bn,L(t(nt)((be=t(g).activeConversation)==null?void 0:be.created_at).format("DD/MM/YYYY")),1)]),n("div",null,[n("div",yn,[n("p",null,L(W.trans("Note")),1),d.value?(v(),te(t(Re),{key:0,icon:"bx:x",class:"cursor-pointer text-xl",onClick:A[5]||(A[5]=se=>d.value=!1)})):(v(),te(t(Re),{key:1,icon:"bx:edit",class:"cursor-pointer",onClick:A[6]||(A[6]=se=>d.value=!0)}))]),d.value?(v(),R("div",wn,[me(n("textarea",{class:"textarea",id:"note","onUpdate:modelValue":A[7]||(A[7]=se=>t(_).note=se),placeholder:"Enter note here"},"    ",512),[[Te,t(_).note]]),P(it,{processing:t(_).processing,onClick:Q,"btn-text":W.trans("Save Note"),class:"w-full"},null,8,["processing","btn-text"])])):(v(),R("div",xn,[t(_).note?(v(),R("p",kn,L(t(_).note),1)):(v(),R("div",Rn,[n("div",Cn,[n("p",_n,[n("span",null,L(W.trans("Note not set yet")),1),A[10]||(A[10]=He("  ",-1)),n("span",{class:"text-primary-600 cursor-pointer",onClick:A[8]||(A[8]=se=>d.value=!0)},L(W.trans("Add Note")),1)])])]))]))])])],2),t(g).rightSidebar.isOpen?(v(),R("div",{key:0,onClick:A[9]||(A[9]=(...se)=>t(g).toggleRightSidebar&&t(g).toggleRightSidebar(...se)),class:"absolute inset-0 z-0 h-full w-full bg-black/20 transition-colors duration-300 ease-in-out"})):G("",!0)],64)}}},Sn={class:"card card-body relative flex flex-col items-center justify-center gap-4"},Mn={class:"text-gray-400 dark:text-gray-500"},zn=tr({__name:"NoConversation",emits:["click"],setup(c,{emit:r}){const d=r;return(g,l)=>{const _=ze("Icon");return v(),R("div",Sn,[n("button",{class:"absolute left-1 top-1 inline-flex size-9 items-center justify-center rounded-full bg-black/20 xl:hidden",onClick:l[0]||(l[0]=u=>d("click"))},[P(_,{icon:"bx:menu",class:"size-6"})]),l[1]||(l[1]=n("img",{class:"w-2/3",src:"/assets/svg/chatting.svg",alt:""},null,-1)),n("h4",Mn,L(t(rr)("Start a conversation")),1)])}}});export{jn as _,Vn as a,Nn as b,qn as c,zn as d,Ie as u};
