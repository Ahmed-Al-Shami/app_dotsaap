import{f as N,C as W,c as s,o as l,t as h,n as C,s as q,r as g,p as H,a as L,d as o,g as f,l as B,k as G,e as J,b as y,h as i,B as K,F as V,i as D,q as Q,m as X,u as Y,a7 as Z,w as ee,j as te,_ as le}from"./app-BYM_31EU.js";import{_ as P}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as se}from"./assetStore-CRTuDG_T.js";const oe={__name:"InputFieldError",props:{message:String,classes:String},setup(e){return(t,d)=>{var c;return N((l(),s("span",{class:C(["mt-1 block text-red-500 text-danger",e.classes])},h(e.message),3)),[[W,(c=e.message)==null?void 0:c.length]])}}},ne={class:"relative w-full"},ae=["for"],ie={key:0,class:"scale-110 text-red-500"},re={class:"flex items-center gap-2"},de={key:0,class:"scale-75 text-xs"},ce={class:"mt-2 line-clamp-1 text-sm"},ue=["multiple","accept"],fe={key:0,class:"absolute bottom-2 mx-auto w-11/12"},me={class:"translate-y-[-10.5px] whitespace-nowrap"},pe={class:"text-[10px] text-white"},ve={key:1,class:"mt-1 text-xs dark:text-gray-300"},be={class:"flex w-full justify-between border-b border-primary-300 py-1 dark:border-primary-600"},he=["onClick"],ye=["src"],xe=["src"],ge={key:2,class:"flex h-full w-full items-center justify-center"},ke=["src"],we={key:3,class:"flex h-full items-center justify-center gap-1 rounded bg-white p-2 text-center text-xs text-black"},_e={class:"line-clamp-1"},Se={key:0,class:"flex flex-wrap"},Fe=["href"],$e=["src"],Ce=["href"],Ve=["src"],je={__name:"DropzoneInput",props:{modelValue:{type:[Array,String],default:()=>[]},accept:{type:String,default:"default"},multiple:{type:Boolean,default:!1},maxFiles:{type:Number,default:10},percentage:{type:Number,default:0},instantSubmit:Function,classes:{type:String,default:"min-h-28"},label:{type:String,default:""},subtitle:{type:String,default:null},labelClass:{type:String,default:""},required:{type:[Boolean,String],default:!1},uploadedFiles:{type:Array,default:()=>[]},error:{type:String,default:null},filePreviewPosition:{type:String,default:"top"}},emits:["update:modelValue"],setup(e,{emit:t}){const d=e,{textExcerpt:c}=q(),x=t,v=g(null),m=g(!1),p=g(!1),n=g(!1),k=g("No Files Selected"),j=g(d.error),z={image:"image/*",video:"video/*",audio:"audio/*",document:".pdf,.csv,.doc,.docx,.xls,.xlsx,.ppt,.pptx",documents:".pdf,.csv,.doc,.docx,.xls,.xlsx,.ppt,.pptx",pdf:".pdf",csv:".csv",doc:".doc,.docx",xls:".xls,.xlsx",ppt:".ppt,.pptx",default:"*/*"},E=H(()=>d.accept.split(",").map(u=>z[u]).join(",")),O=()=>{console.log(v.value.files),v.value.files.length&&(p.value=!0,T())},U=u=>{u.length===1?k.value=u[0].name:u.length>1?k.value=`${u.length} files selected`:k.value="No file selected"},T=()=>{const u=Array.from(v.value.files),a=d.multiple?d.maxFiles:1,b=d.modelValue||[],_=d.accept||"default",S=z[_].split(","),F=u.filter(r=>{const w="."+r.name.split(".").pop().toLowerCase();return!(S.includes("*/*")||S.some(I=>I.includes("/*")?r.type.startsWith(I.split("/")[0]):I.toLowerCase()===w))});if(F.length){const r=F.map(w=>w.name).join(", ");j.value=`Invalid files: ${r}. Supported files: ${z[_]}`;return}const $=[...b,...u].slice(-a);x("update:modelValue",$),U($),d.instantSubmit&&d.instantSubmit()},A=u=>URL.createObjectURL(u),R=u=>{const a=[...d.modelValue],b=a.splice(u,1)[0];x("update:modelValue",a),U(a),b&&URL.revokeObjectURL(b),a.length===0&&(v.value.value="",n.value=!1,p.value=!1)};return(u,a)=>{var _,S,F,M,$;const b=L("Icon");return l(),s(V,null,[o("div",ne,[e.label?(l(),s("label",{key:0,for:e.label,class:C(["mb-1 block text-sm capitalize dark:text-dark-200",e.labelClass])},[G(h(e.label)+" ",1),e.required?(l(),s("span",ie,"*")):f("",!0)],10,ae)):f("",!0),o("div",{class:C(["dropzone-area relative flex cursor-pointer flex-col items-center justify-center rounded-xl border border-dashed border-dark-400 p-4 text-center dark:text-primary-50",[{"bg-blue-50 dark:bg-blue-800":m.value},e.classes]])},[o("div",{onDragover:a[0]||(a[0]=J(r=>m.value=!0,["prevent"])),onDragleave:a[1]||(a[1]=r=>m.value=!1),onDragend:a[2]||(a[2]=r=>m.value=!1),class:"flex flex-col items-center justify-center"},[o("div",re,[y(b,{icon:"bx:upload",class:"mb-1 h-5 w-5"}),a[5]||(a[5]=o("p",{class:"text-xs font-semibold"},"Click or drag & drop",-1))]),e.multiple?(l(),s("small",de,"Max ("+h(e.maxFiles)+" files)",1)):f("",!0),o("p",ce,h(((_=e.modelValue)==null?void 0:_.length)>0?i(c)(k.value,20):"No file selected"),1)],32),o("input",{type:"file",multiple:e.multiple,accept:E.value,ref_key:"fileInput",ref:v,onInput:O,"aria-label":"Upload files"},null,40,ue),e.percentage>0?(l(),s("div",fe,[o("div",{style:K({width:`${e.percentage}%`}),class:"h-3 w-1/2 rounded-full border border-dashed border-white bg-primary-500 transition-width"},[o("p",me,[o("span",pe,h(e.percentage)+" %",1)])],4)])):f("",!0),((S=e.modelValue)==null?void 0:S.length)>0&&!n.value&&p.value?(l(),s("button",{key:1,type:"button",class:"absolute right-2 top-1 text-xs underline",onClick:a[3]||(a[3]=r=>n.value=!0)},a[6]||(a[6]=[o("span",null,"Show files",-1)]))):f("",!0)],2),e.subtitle?(l(),s("p",ve,"*"+h(e.subtitle),1)):f("",!0),j.value?(l(),B(oe,{key:2,message:j.value},null,8,["message"])):f("",!0),((F=e.modelValue)==null?void 0:F.length)>0&&n.value?(l(),s("div",{key:3,class:C(["styled-scrollbar card absolute left-0 z-50 mt-2 flex w-full flex-wrap gap-2 rounded-md bg-primary-200 p-2 dark:bg-dark-700/95 dark:text-primary-50",{"h-[25rem] overflow-y-auto":e.modelValue.length>4,"bottom-full":e.filePreviewPosition==="top","top-full":e.filePreviewPosition==="bottom"}])},[o("div",be,[a[8]||(a[8]=o("p",{class:"text-xs font-semibold"},"Uploaded Files",-1)),o("button",{onClick:a[4]||(a[4]=r=>n.value=!1),type:"button",class:"flex items-center justify-center text-red-500 hover:underline"},[y(b,{icon:"bx:x"}),a[7]||(a[7]=o("span",{class:"text-xs"},"Close",-1))])]),(l(!0),s(V,null,D(e.modelValue,(r,w)=>(l(),s("section",{class:"relative h-32 min-w-32 flex-1 rounded-md border border-slate-400 dark:border-slate-500",key:w},[o("button",{onClick:I=>R(w),type:"button",class:"absolute right-1 top-1 z-50 flex h-6 w-6 items-center justify-center rounded-full border border-red-500 text-red-500 hover:bg-red-500/10"},[y(b,{icon:"bx:x"})],8,he),r.type.startsWith("image/")?(l(),s("img",{key:0,src:A(r),class:"h-full w-full rounded object-contain",alt:"img",loading:"lazy"},null,8,ye)):r.type.startsWith("video/")?(l(),s("video",{key:1,class:"h-full w-full rounded object-contain",src:A(r),width:"100%",height:"100%",controls:"",loading:"lazy"},null,8,xe)):r.type.startsWith("audio/")?(l(),s("div",ge,[o("audio",{src:A(r),class:"h-14 w-full",controls:""},null,8,ke)])):(l(),s("div",we,[y(b,{icon:"bx:file",class:"min-w-5 text-lg"}),o("span",_e,h(r.name),1)]))]))),128))],2)):f("",!0)]),((M=e.uploadedFiles)!=null&&M.length||($=Object.keys(e.uploadedFiles??{}))!=null&&$.length)&&!p.value?(l(),s("div",Se,[Array.isArray(e.uploadedFiles)?(l(!0),s(V,{key:0},D(e.uploadedFiles,r=>(l(),s("a",{class:"w-16",href:r.path,target:"_blank",key:r.id},[o("img",{class:"rounded-md",src:r.path,alt:"voucher"},null,8,$e)],8,Fe))),128)):(l(),s("a",{key:1,class:"w-16",href:e.uploadedFiles.path,target:"_blank"},[o("img",{class:"rounded-md",src:e.uploadedFiles.path,alt:"voucher"},null,8,Ve)],8,Ce))])):f("",!0)],64)}}},Ie=P(je,[["__scopeId","data-v-949fc3be"]]),ze={},Ae={class:"hollow-dots-spinner"};function Me(e,t){return l(),s("div",Ae,t[0]||(t[0]=[o("div",{class:"dot"},null,-1),o("div",{class:"dot"},null,-1),o("div",{class:"dot"},null,-1)]))}const Ne=P(ze,[["render",Me]]),De={key:0,class:"mt-5 flex justify-center"},Ue={__name:"IntersectionObserver",props:{observerCondition:{type:Boolean,default:!0},loader:{type:Boolean,default:!1},afterIntersection:{type:Function,default:()=>{}},intersectionStart:{type:Number,default:0}},setup(e){const t=e,d=g(null);let c=null,x=0;const v=p=>{p.forEach(n=>{n.isIntersecting&&t.observerCondition&&(x++,x>t.intersectionStart&&t.afterIntersection())})};Q(()=>t.observerCondition,()=>{t.observerCondition&&m()}),X(()=>{m()});const m=()=>{c=new IntersectionObserver(v,{root:null,rootMargin:"40px",threshold:.1}),c.observe(d.value)};return(p,n)=>(l(),s(V,null,[o("div",{ref_key:"intersectionTargetView",ref:d,class:"h-2"},null,512),e.loader?(l(),s("div",De,[y(Ne)])):f("",!0)],64))}},Le={class:"grid max-h-[60vh] w-full grid-cols-1 gap-2 overflow-y-auto sm:grid-cols-2 md:grid-cols-3 xl:grid-cols-4 2xl:grid-cols-5"},Be={class:"card flex items-center justify-center p-2"},Pe=["onClick"],Ee={key:0,class:"h-full w-full object-contain",alt:"image"},Oe={key:1,controls:"",class:"h-full w-full"},Te=["src"],Re={key:2,controls:"",class:"h-full w-full"},We=["src"],qe=["src"],He={key:3,class:"flex h-full flex-col items-center justify-center"},Ge={class:"text-sm font-semibold capitalize"},Je={key:0,class:"flex justify-end gap-2"},Ye={__name:"AssetModal",setup(e){Y();const t=se();return(d,c)=>{const x=L("Icon"),v=Z("lazy");return l(),B(le,{"header-state":!0,"header-title":"Media Library",state:"assetModal","state-key":"assetModal","modal-size":"w-8/12 2xl:w-6/12"},{default:ee(()=>{var m,p;return[o("div",Le,[o("div",Be,[y(Ie,{classes:"h-32",modelValue:i(t).files,"onUpdate:modelValue":c[0]||(c[0]=n=>i(t).files=n),accept:((m=i(t).events)==null?void 0:m.load)??"image",percentage:i(t).assetUploadProgress,instantSubmit:i(t).assetSubmit,filePreviewPosition:"bottom"},null,8,["modelValue","accept","percentage","instantSubmit"])]),(l(!0),s(V,null,D(i(t).allAssets.data,(n,k)=>(l(),s("div",{key:n.id+k,onClick:j=>i(t).toggleSelect(n),class:C(["h-36 w-full cursor-pointer rounded-md border bg-slate-100 dark:bg-slate-900 dark:hover:bg-slate-800",{"border-2 border-primary-600 dark:border-primary-600":i(t).isSelected(n),"border-1 dark:border-slate-700":!i(t).isSelected(n)}])},[n.mime_type.includes("image")?N((l(),s("img",Ee,null,512)),[[v,n.path]]):n.mime_type.includes("video")?(l(),s("video",Oe,[o("source",{src:n.path,type:"video/mp4"},null,8,Te)])):n.mime_type.includes("audio")?(l(),s("audio",Re,[o("source",{src:n.path,type:"audio/wav"},null,8,We),o("source",{src:n.path,type:"audio/mp3"},null,8,qe)])):(l(),s("div",He,[y(x,{icon:"bx:file-blank",class:"h-12 w-12"}),o("p",Ge,h(n.original_name),1)]))],10,Pe))),128))]),y(Ue,{"observer-condition":i(t).allAssets.loadMore,"after-intersection":()=>i(t).loadMoreAssets(),loader:i(t).allAssets.loading},null,8,["observer-condition","after-intersection","loader"]),i(t).events.multiple&&i(t).selectedAssets.length?(l(),s("div",Je,[i(t).events.caption!==void 0?N((l(),s("input",{key:0,type:"text","onUpdate:modelValue":c[1]||(c[1]=n=>i(t).events.caption=n),placeholder:"caption (optional)",class:"input w-full"},null,512)),[[te,i(t).events.caption]]):f("",!0),i(t).events.button!==void 0||i(t).events.multiple?(l(),s("button",{key:1,onClick:c[2]||(c[2]=(...n)=>i(t).onSubmit&&i(t).onSubmit(...n)),type:"button",class:"btn btn-primary"},h(((p=i(t).events.button)==null?void 0:p.text)??"Attach"),1)):f("",!0)])):f("",!0)]}),_:1})}}};export{Ne as H,Ye as _,Ue as a,oe as b};
